var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{h(n.next(e))}catch(t){o(t)}}function a(e){try{h(n["throw"](e))}catch(t){o(t)}}function h(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,o=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=t.call(e,h)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?n(r):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){var e=new egret.Bitmap;e.texture=RES.getRes("loading_bg_jpg"),e.width=640,e.height=1136,this.addChild(e),this.bg1=new egret.Bitmap,this.bg1.texture=RES.getRes("loading_json.loading_bar1_png"),this.bg1.anchorOffsetX=this.bg1.width/2,this.bg1.anchorOffsetY=this.bg1.height/2,this.bg1.x=320,this.bg1.y=568,this.addChild(this.bg1),this.bg2=new egret.Bitmap,this.bg2.texture=RES.getRes("loading_json.loading_bar2_png"),this.bg2.anchorOffsetX=this.bg2.width/2,this.bg2.anchorOffsetY=this.bg2.height/2,this.bg2.x=320,this.bg2.y=568,this.addChild(this.bg2),this.loadingicon=new egret.Bitmap,this.loadingicon.texture=RES.getRes("loading_json.loading_icon_png"),this.loadingicon.anchorOffsetX=this.loadingicon.width/2,this.loadingicon.anchorOffsetY=this.loadingicon.height/2,this.loadingicon.x=320,this.loadingicon.y=568,this.addChild(this.loadingicon);var t=this.shape=new egret.Shape;this.addChild(t),this.bg2.mask=t,this.bitmapText=new egret.BitmapText,this.bitmapText.font=RES.getRes("num_fnt"),this.bitmapText.width=640,this.bitmapText.height=1136,this.bitmapText.textAlign="center",this.bitmapText.y=548,this.addChild(this.bitmapText)},t.prototype.onProgress=function(e,t){this.changeGraphics(270*(e/t)),this.loadingicon.rotation+=5,this.bitmapText.text=Math.floor(e/t*100).toString()+"%"},t.prototype.changeGraphics=function(e){var t=this.shape;t.graphics.clear(),t.graphics.beginFill(65535,1),t.graphics.moveTo(320,568),t.graphics.lineTo(this.bg2.width/2,0),t.graphics.drawArc(320,568,this.bg1.width/2,-90*Math.PI/180,e*Math.PI/180,!1),t.graphics.lineTo(320,568),t.graphics.endFill()},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("loading")];case 2:return i.sent(),e=new LoadingUI,this.stage.addChild(e),[4,this.loadTheme()];case 3:return i.sent(),[4,RES.loadGroup("preload",0,e)];case 4:return i.sent(),this.stage.removeChild(e),[3,6];case 5:return t=i.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,i){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){SceneMgr.AddUI(this,new page1)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var page1=function(e){function t(){var t=e.call(this)||this;return t.UpComplete=!1,t.IsUp=!1,t.i=0,t.t=1,t.peopleH=0,t.isForeach=!0,t.isForeach1=!0,t.isThree=!0,t.isFour=!0,t.isRandom=!0,t.isPeopleShow=!0,t.isYichu=!0,t}return __extends(t,e),t.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},t.prototype.childrenCreated=function(){var e=this;this.FlyTween(this.btn1_light1,-147,1e3),this.FlyTween(this.btn1_light2,2,1e3),this.x1=this.littleHand.x,this.y1=this.littleHand.y;var t=egret.Tween.get(this.littleHand,{loop:!0});t.to({x:this.x1-5,y:this.y1-5},1e3).call(function(){var t=egret.Tween.get(e.quanquan);t.to({scaleX:2,scaleY:2,alpha:.5},600).to({scaleX:1,scaleY:1,alpha:1})});var i=egret.Tween.get(this.page4_Star,{loop:!0});i.to({alpha:.5},1e3).to({alpha:1},1e3),this.AllTween(this.icon2,this.icon2.y),this.AllTween(this.dna,this.dna.y),this.AllTween(this.page4_icon1,this.page4_icon1.y,this.page4_icon1.x),this.AllTween(this.page4_icon2,this.page4_icon2.y),this.AllTween(this.page4_icon3,this.page4_icon3.y),this.AllTween(this.page4_icon4,this.page4_icon4.y),this.AllTween(this.page4_icon5,this.page4_icon5.y,this.page4_icon5.x),this.AllTween(this.sanjiao1,this.sanjiao1.y),this.AllTween(this.icon1,this.icon1.y,this.icon1.x),this.LightTween();var n=egret.Tween.get(this.light);n.to({alpha:1},1500),this.littleHand.touchEnabled=!0,this.littleHand.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.PlayBgMusic();var t=egret.Tween.get(e.group);t.to({alpha:0},500).call(function(){e.panel1.removeChild(e.group)}),e.IsUp=!0,e.BaoJingTween(e.baojing.x)},this),this.quanquan.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.PlayBgMusic()},this);for(var r=0;r<this.circle.numChildren;r++)this.circle.getChildAt(r).scaleY=.2,this.circle.getChildAt(r).x=100,this.circle.getChildAt(r).y=230,this.circle.getChildAt(r).anchorOffsetX=this.circle.getChildAt(r).width/2,this.circle.getChildAt(r).anchorOffsetY=this.circle.getChildAt(r).height/2;this.people.mask=this.imgMask,this.addEventListener(egret.Event.ENTER_FRAME,this.update,this),this.imgTest.addEventListener(egret.TouchEvent.TOUCH_TAP,this.Test,this)},t.prototype.Test=function(){this.removeChildren(),this.Last()},t.prototype.timerFunc=function(){this.CreateStar()},t.prototype.timerComFunc=function(){},t.prototype.PlayBgMusic=function(){var e=RES.getRes("bgmusic_mp3");e.play()},t.prototype.AllTween=function(e,t,i){if(null==i){var n=egret.Tween.get(e,{loop:!0});n.to({y:t+50},1e3).to({y:t},1e3)}else{var n=egret.Tween.get(e,{loop:!0});n.to({x:i+50,y:t-50},1e3).to({x:i,y:t},1e3)}},t.prototype.update=function(){var e=this;if(this.panel1.y<=1136&&(this.icon2.rotation+=.8,this.dna.rotation-=1,this.sanjiao1.rotation+=1),this.IsUp&&(this.panel1.y+=5,this.light_1.height+=5,this.light.y-=5),this.panel1.y>=1e3&&this.isPeopleShow&&(this.PeopleShow(),this.isPeopleShow=!1),this.panel1.y>=1250&&this.p1.scaleX<1&&(this.p1.scaleX+=.06,this.p1.scaleY+=.06,this.p2.scaleX+=.06,this.p2.scaleY+=.06),this.panel1.y>=1350&&this.p3.scaleX<1&&(this.p3.scaleX+=.06,this.p3.scaleY+=.06,this.p4.scaleX+=.06,this.p4.scaleY+=.06),this.panel1.y>=1400&&this.p5.scaleX<1&&(this.p5.scaleX+=.06,this.p5.scaleY+=.06,this.p6.scaleX+=.06,this.p6.scaleY+=.06),this.isThree&&this.panel1.y>=1700){var t=egret.Tween.get(this.three);t.to({alpha:1},1e3).call(function(){e.light.source="p1_light_2_png"}),this.isThree=!1;var i=egret.Tween.get(this.three);i.to({y:this.three.y-100},500)}if(this.panel1.y>=1900&&this.isForeach1&&(this.TXTShow(),this.isForeach1=!1),this.panel1.y>=2900){if(this.isFour){var t=egret.Tween.get(this.imgTest);t.to({alpha:1},1e3);var i=egret.Tween.get(this.imgTest_);i.to({alpha:1},1e3),this.isFour=!1;var n=egret.Tween.get(this.wendu_81);n.to({x:422},600),this.FlyTween(this.shenzhun,140,700),this.FlyTween(this.yice,133,700),this.ranshao.mask=this.ranshaoMask;var r=egret.Tween.get(this.ranshaoMask,{loop:!0});r.to({x:530},600).wait(2e3).call(function(){e.ranshaoMask.x=235})}this.saomiao.rotation+=5,this.page4_icon4.rotation-=.8}this.panel1.y>=3408&&(this.IsUp=!1,this.imgTest.touchEnabled=!0),this.panel1.y>1136&&this.isYichu?(this.panel1.removeChild(this.icon2),this.isYichu=!1):this.panel1.y>1560&&this.isYichu?(this.panel1.removeChild(this.people),this.isYichu=!1):this.panel1.y>2250&&this.isYichu&&(this.panel1.removeChild(this.baojing),this.isYichu=!1)},t.prototype.LightTween=function(){var e=this,t=egret.Tween.get(this.light_1);t.to({height:530},1e3);var i=egret.Tween.get(this.light);i.to({y:250,alpha:1},1e3).call(function(){var t=egret.Tween.get(e.light,{loop:!0});t.to({alpha:.5},300).to({alpha:1},300)})},t.prototype.BaoJingTween=function(e){var t=egret.Tween.get(this.baojing,{loop:!0});t.to({x:e+1,alpha:.5},200).to({x:e-1,alpha:1},200)},t.prototype.CreateStar=function(){var e=this,t=new egret.Bitmap;t.texture=RES.getRes("p1_star1_png"),this.panel1.addChildAt(t,8),t.y=1136,t.x=610*Math.random();var i=egret.Tween.get(t);i.to({y:-4e3},6e3).call(function(){egret.Tween.removeTweens(t),e.panel1.removeChild(t)})},t.prototype.FlyTween=function(e,t,i,n){var r=egret.Tween.get(e);n?r.to({x:t,y:n},i):r.to({x:t},i)},t.prototype.PeopleShow=function(){this.people.visible=!0;var e=egret.Tween.get(this.imgMask);e.to({height:660},1500)},t.prototype.TXTShow=function(){for(var e=function(e){var i=t.txtGroup1.getChildAt(e-1);setTimeout(function(){i.visible=!0},80*e)},t=this,i=1;i<=this.txtGroup1.numChildren;i++)e(i)},t.prototype.Last=function(){var e=new eui.Image;this.addChild(e);for(var t=function(t){setTimeout(function(){e.source=RES.getRes("chuansuo_"+(t+205).toString()+"_jpg")},50*t)},i=0;15>i;i++)t(i);var n=new egret.Timer(1500,1);n.addEventListener(egret.TimerEvent.TIMER,this.timerFunc1,this),n.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc1,this),n.start()},t.prototype.timerFunc1=function(){console.log("计时")},t.prototype.timerComFunc1=function(){this.removeChildren(),SceneMgr.AddUI(this.parent,new page2),SceneMgr.RemoveUI(this.parent,this)},t.prototype.NewTween=function(){},t}(eui.Component);__reflect(page1.prototype,"page1",["eui.UIComponent","egret.DisplayObject"]);var page2=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);__reflect(page2.prototype,"page2",["eui.UIComponent","egret.DisplayObject"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var SceneMgr=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.AddUI=function(e,t){e.addChild(t)},e.RemoveUI=function(e,t){e.removeChild(t)},e.instance=null,e}();__reflect(SceneMgr.prototype,"SceneMgr");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function r(e){t.call(n,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);