<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>AirLift
    </title>

    <!--http://www.html5rocks.com/en/mobile/mobifying/-->
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1" />

    <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">

    <!-- force webkit on 360 -->
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <!-- force edge on IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="msapplication-tap-highlight" content="no">

    <!-- force full screen on some browser -->
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="360-fullscreen" content="true" />

    <!-- force screen orientation on some browser -->
    <meta name="screen-orientation" content="<%=orientation%>" />
    <meta name="x5-orientation" content="<%=orientation%>">

    <!--fix fireball/issues/3568 -->
    <!--<meta name="browsermode" content="application">-->
    <meta name="x5-page-mode" content="app">

    <!--<link rel="apple-touch-icon" href=".png" />-->
    <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->

    <link rel="stylesheet" type="text/css" href="style-mobile.a1a75.css" />
    <link rel="stylesheet" type="text/css" href="google_ima_style.d24e7.css" />
    <!-- <link rel="icon" href="favicon.8de18.ico" /> -->


    <style>
        #loading {
            background-color: #0c1f49;
            height: 100%;
            width: 100%;
            position: fixed;
            z-index: 1;
            margin-top: 0px;
            top: 0px;
        }
        
        #loading-center {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        #loading-center-absolute {
            position: absolute;
            left: 50%;
            top: 50%;
            height: 60px;
            width: 60px;
            margin-top: -30px;
            margin-left: -30px;
            -webkit-animation: loading-center-absolute 1s infinite;
            animation: loading-center-absolute 1s infinite;
        }
        
        .object {
            width: 20px;
            height: 20px;
            background-color: #FFF;
            float: left;
            -moz-border-radius: 50% 50% 50% 50%;
            -webkit-border-radius: 50% 50% 50% 50%;
            border-radius: 50% 50% 50% 50%;
            margin-right: 20px;
            margin-bottom: 20px;
        }
        
        .object:nth-child(2n+0) {
            margin-right: 0px;
        }
        
        #object_one {
            -webkit-animation: object_one 1s infinite;
            animation: object_one 1s infinite;
        }
        
        #object_two {
            -webkit-animation: object_two 1s infinite;
            animation: object_two 1s infinite;
        }
        
        #object_three {
            -webkit-animation: object_three 1s infinite;
            animation: object_three 1s infinite;
        }
        
        #object_four {
            -webkit-animation: object_four 1s infinite;
            animation: object_four 1s infinite;
        }
        
        @-webkit-keyframes loading-center-absolute {
            100% {
                -ms-transform: rotate(360deg);
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        
        @keyframes loading-center-absolute {
            100% {
                -ms-transform: rotate(360deg);
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        
        @-webkit-keyframes object_one {
            50% {
                -ms-transform: translate(20px, 20px);
                -webkit-transform: translate(20px, 20px);
                transform: translate(20px, 20px);
            }
        }
        
        @keyframes object_one {
            50% {
                -ms-transform: translate(20px, 20px);
                -webkit-transform: translate(20px, 20px);
                transform: translate(20px, 20px);
            }
        }
        
        @-webkit-keyframes object_two {
            50% {
                -ms-transform: translate(-20px, 20px);
                -webkit-transform: translate(-20px, 20px);
                transform: translate(-20px, 20px);
            }
        }
        
        @keyframes object_two {
            50% {
                -ms-transform: translate(-20px, 20px);
                -webkit-transform: translate(-20px, 20px);
                transform: translate(-20px, 20px);
            }
        }
        
        @-webkit-keyframes object_three {
            50% {
                -ms-transform: translate(20px, -20px);
                -webkit-transform: translate(20px, -20px);
                transform: translate(20px, -20px);
            }
        }
        
        @keyframes object_three {
            50% {
                -ms-transform: translate(20px, -20px);
                -webkit-transform: translate(20px, -20px);
                transform: translate(20px, -20px);
            }
        }
        
        @-webkit-keyframes object_four {
            50% {
                -ms-transform: translate(-20px, -20px);
                -webkit-transform: translate(-20px, -20px);
                transform: translate(-20px, -20px);
            }
        }
        
        @keyframes object_four {
            50% {
                -ms-transform: translate(-20px, -20px);
                -webkit-transform: translate(-20px, -20px);
                transform: translate(-20px, -20px);
            }
        }
    </style>


</head>

<body>
    <canvas id="GameCanvas" oncontextmenu="event.preventDefault()" tabindex="0"></canvas>
    <div id="splash">
        <div class="progress-bar stripes">
            <span style="width: 0%"></span>
        </div>
    </div>
    <div id="content">
        <video id="contentElement" playsinline muted>
        </video>
    </div>
    <div id="adContainer"></div>

    <div id="loading">
        <div id="loading-center">
            <div id="loading-center-absolute">
                <div class="object" id="object_one"></div>
                <div class="object" id="object_two"></div>
                <div class="object" id="object_three"></div>
                <div class="object" id="object_four"></div>
            </div>
        </div>
    </div>


    <!-- <script type="text/javascript" src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script> -->
    <script src="https://cdn.bootcss.com/vConsole/3.3.4/vconsole.min.js"></script>

    <!-- <script src="https://telegram.org/js/games.js"></script> -->
    <script>
        (function() {
            var eventHandlers = {};

            // Parse init params from location hash: for Android < 5.0, TDesktop
            var locationHash = '';
            try {
                locationHash = location.hash.toString();
            } catch (e) {}

            var initParams = urlParseHashParams(locationHash);

            var isIframe = false;
            try {
                isIframe = (window.parent != null && window != window.parent);
            } catch (e) {}


            function urlSafeDecode(urlencoded) {
                try {
                    return decodeURIComponent(urlencoded);
                } catch (e) {
                    return urlencoded;
                }
            }

            function urlParseHashParams(locationHash) {
                locationHash = locationHash.replace(/^#/, '');
                var params = {};
                if (!locationHash.length) {
                    return params;
                }
                if (locationHash.indexOf('=') < 0 && locationHash.indexOf('?') < 0) {
                    params._path = urlSafeDecode(locationHash);
                    return params;
                }
                var qIndex = locationHash.indexOf('?');
                if (qIndex >= 0) {
                    var pathParam = locationHash.substr(0, qIndex);
                    params._path = urlSafeDecode(pathParam);
                    locationHash = locationHash.substr(qIndex + 1);
                }
                var locationHashParams = locationHash.split('&');
                var i, param, paramName, paramValue;
                for (i = 0; i < locationHashParams.length; i++) {
                    param = locationHashParams[i].split('=');
                    paramName = urlSafeDecode(param[0]);
                    paramValue = param[1] == null ? null : urlSafeDecode(param[1]);
                    params[paramName] = paramValue;
                }
                return params;
            }

            // Telegram apps will implement this logic to add service params (e.g. tgShareScoreUrl) to game URL
            function urlAppendHashParams(url, addHash) {
                // url looks like 'https://game.com/path?query=1#hash'
                // addHash looks like 'tgShareScoreUrl=' + encodeURIComponent('tgb://share_game_score?hash=very_long_hash123')

                var ind = url.indexOf('#');
                if (ind < 0) {
                    // https://game.com/path -> https://game.com/path#tgShareScoreUrl=etc
                    return url + '#' + addHash;
                }
                var curHash = url.substr(ind + 1);
                if (curHash.indexOf('=') >= 0 || curHash.indexOf('?') >= 0) {
                    // https://game.com/#hash=1 -> https://game.com/#hash=1&tgShareScoreUrl=etc
                    // https://game.com/#path?query -> https://game.com/#path?query&tgShareScoreUrl=etc
                    return url + '&' + addHash;
                }
                // https://game.com/#hash -> https://game.com/#hash?tgShareScoreUrl=etc
                if (curHash.length > 0) {
                    return url + '?' + addHash;
                }
                // https://game.com/# -> https://game.com/#tgShareScoreUrl=etc
                return url + addHash;
            }


            function postEvent(eventType, callback, eventData) {
                if (!callback) {
                    callback = function() {};
                }
                if (eventData === undefined) {
                    eventData = '';
                }

                if (window.TelegramWebviewProxy !== undefined) {
                    TelegramWebviewProxy.postEvent(eventType, JSON.stringify(eventData));
                    callback();
                } else if (window.external && 'notify' in window.external) {
                    window.external.notify(JSON.stringify({
                        eventType: eventType,
                        eventData: eventData
                    }));
                    callback();
                } else if (isIframe) {
                    try {
                        var trustedTarget = 'https://web.telegram.org';
                        // For now we don't restrict target, for testing purposes
                        trustedTarget = '*';
                        window.parent.postMessage(JSON.stringify({
                            eventType: eventType,
                            eventData: eventData
                        }), trustedTarget);
                    } catch (e) {
                        callback(e);
                    }
                } else {
                    callback({
                        notAvailable: true
                    });
                }
            };

            function receiveEvent(eventType, eventData) {
                var curEventHandlers = eventHandlers[eventType];
                if (curEventHandlers === undefined ||
                    !curEventHandlers.length) {
                    return;
                }
                for (var i = 0; i < curEventHandlers.length; i++) {
                    try {
                        curEventHandlers[i](eventType, eventData);
                    } catch (e) {}
                }
            }

            function onEvent(eventType, callback) {
                if (eventHandlers[eventType] === undefined) {
                    eventHandlers[eventType] = [];
                }
                var index = eventHandlers[eventType].indexOf(callback);
                if (index === -1) {
                    eventHandlers[eventType].push(callback);
                }
            };

            function offEvent(eventType, callback) {
                if (eventHandlers[eventType] === undefined) {
                    return;
                }
                var index = eventHandlers[eventType].indexOf(callback);
                if (index === -1) {
                    return;
                }
                eventHandlers[eventType].splice(index, 1);
            };

            function openProtoUrl(url) {
                if (!url.match(/^(web\+)?tgb?:\/\/./)) {
                    return false;
                }
                var useIframe = navigator.userAgent.match(/iOS|iPhone OS|iPhone|iPod|iPad/i) ? true : false;
                if (useIframe) {
                    var iframeContEl = document.getElementById('tgme_frame_cont') || document.body;
                    var iframeEl = document.createElement('iframe');
                    iframeContEl.appendChild(iframeEl);
                    var pageHidden = false;
                    var enableHidden = function() {
                        pageHidden = true;
                    };
                    window.addEventListener('pagehide', enableHidden, false);
                    window.addEventListener('blur', enableHidden, false);
                    if (iframeEl !== null) {
                        iframeEl.src = url;
                    }
                    setTimeout(function() {
                        if (!pageHidden) {
                            window.location = url;
                        }
                        window.removeEventListener('pagehide', enableHidden, false);
                        window.removeEventListener('blur', enableHidden, false);
                    }, 2000);
                } else {
                    window.location = url;
                }
                return true;
            }

            // For Windows Phone app
            window.TelegramGameProxy_receiveEvent = receiveEvent;

            window.TelegramGameProxy = {
                initParams: initParams,
                receiveEvent: receiveEvent,
                onEvent: onEvent,
                shareScore: function(userId) {
                    postEvent('share_score', function(error) {
                        if (error) {
                            var shareScoreUrl = initParams.tgShareScoreUrl;
                            if (shareScoreUrl) {
                                openProtoUrl(shareScoreUrl);
                            }
                        }
                    }, userId);
                },
                paymentFormSubmit: function(formData) {
                    if (!formData ||
                        !formData.credentials ||
                        formData.credentials.type !== 'card' ||
                        !formData.credentials.token ||
                        !formData.credentials.token.match(/^[A-Za-z0-9\/=_\-]{4,512}$/) ||
                        !formData.title) {
                        console.error('[TgProxy] Invalid form data submitted', formData);
                        throw Error('PaymentFormDataInvalid');
                    }
                    postEvent('payment_form_submit', false, formData);
                }
            };

        })();
    </script>

    <script src="src/settings.c91b1.js" charset="utf-8"></script>
    <%=webDebugger%>
        <script src="main.4a3da.js" charset="utf-8"></script>

        <script type="text/javascript">
            (function() {
                // open web debugger console
                if (typeof VConsole !== 'undefined') {
                    window.vConsole = new VConsole();
                }

                var debug = window._CCSettings.debug;
                var splash = document.getElementById('splash');
                splash.style.display = 'block';

                function loadScript(moduleName, cb) {
                    function scriptLoaded() {
                        document.body.removeChild(domScript);
                        domScript.removeEventListener('load', scriptLoaded, false);
                        cb && cb();
                    };
                    var domScript = document.createElement('script');
                    domScript.async = true;
                    domScript.src = moduleName;
                    domScript.addEventListener('load', scriptLoaded, false);
                    document.body.appendChild(domScript);
                }

                loadScript(debug ? 'cocos2d-js.js' : 'cocos2d-js-min.4bff8.js', function() {
                    if (CC_PHYSICS_BUILTIN || CC_PHYSICS_CANNON) {
                        loadScript(debug ? 'physics.js' : 'physics-min.js', window.boot);
                    } else {
                        window.boot();
                    }
                });
            })();
        </script>

</body>

</html>