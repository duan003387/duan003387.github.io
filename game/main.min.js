var __reflect=this&&this.__reflect||function(t,i,s){t.__class__=i,s?s.push(i):s=[i],t.__types__=t.__types__?s.concat(t.__types__):s},__extends=this&&this.__extends||function(t,i){function s(){this.constructor=t}for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)},TableUI=function(t){function i(){var i=t.call(this)||this;return i.ballArr=[],i.bounce=-.7,i.tableX=0,i.tableY=0,i.tableW=0,i.tableH=0,i.curBall=null,i.ganLen=581,i.angleSpeed=0,i.angleNum=0,i.otherX=0,i.otherY=0,i.posArr=[],i.holeR=28,i.centerX=0,i.centerY=0,i.ballImgArr=[],i.downStart=744,i.downOver=820,i._r=0,i.removeBallArr=[],i.firstCollision=0,i.isMove=!1,i.curVx=0,i.curVy=0,i.isBegin=!1,i.huadongAngle=0,i["long"]=0,i.moveTime=0,i.whiteBall=null,i.xIcon=null,i.tipsUI=new TipsUI,i.isBaiqiu=0,i.isOwnGame=!1,i.curActionNum=0,i.myChairId=-1,i.otherChairId=-1,i.isLianxi=0,i.myBrowser="",i.myColor=-1,i.lightArr=[],i.curTimerNum=0,i.isLoading=0,i.isKsBtn=!1,i.isCanClose=!1,i.isLosePrompt=!1,i.isCanMove=!1,i.isTOHit=!1,i.isKsPlay=!1,i.isClickLidu=!1,i.liduTime=0,i.addNum=2,i.skinName="TableUISkin",i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.tableX=this.tableBG.x,this.tableY=this.tableBG.y,this.tableW=this.tableBG.width,this.tableH=this.tableBG.height,this.smallGroup.visible=!1,this.bigGroup.visible=!1,this.leftGroupPos={x:this.smallGroup.x,y:this.smallGroup.y},this.rightGroupPos={x:this.bigGroup.x,y:this.bigGroup.y},this.leftLabel.visible=!1,this.rightLabel.visible=!1,this.leftTurn.visible=!1,this.rightTurn.visible=!1,this.ballImgArr=[this.ball1,this.ball2,this.ball3,this.ball4,this.ball5,this.ball6,this.ball7,null,this.ball9,this.ball10,this.ball11,this.ball12,this.ball13,this.ball14,this.ball15],this.ball8.alpha=.4,this.ball16.alpha=.4;for(var i=0;i<this.ballImgArr.length;i++)this.ballImgArr[i]&&(this.ballImgArr[i].alpha=.4);this.posArr=[{x1:this.tableX+204,y1:this.tableY+80,x2:this.tableX+166,y2:this.tableY+120,hx:this.tableX+172,hy:this.tableY+89},{x1:this.tableX+683,y1:this.tableY+80,x2:this.tableX+746,y2:this.tableY+80,hx:this.tableX+715,hy:this.tableY+70},{x1:this.tableX+1226,y1:this.tableY+80,x2:this.tableX+1264,y2:this.tableY+120,hx:this.tableX+1257,hy:this.tableY+89},{x1:this.tableX+166,y1:this.tableY+596,x2:this.tableX+204,y2:this.tableY+636,hx:this.tableX+172,hy:this.tableY+628},{x1:this.tableX+683,y1:this.tableY+636,x2:this.tableX+746,y2:this.tableY+636,hx:this.tableX+715,hy:this.tableY+647},{x1:this.tableX+1264,y1:this.tableY+596,x2:this.tableX+1226,y2:this.tableY+636,hx:this.tableX+1257,hy:this.tableY+628}];var s=new egret.Rectangle(0,0,this.chatGroup.width,this.chatGroup.height);this.chatGroup.mask=s,this.centerX=this.posArr[0].hx+.5*(this.posArr[2].hx-this.posArr[0].hx),this.centerY=this.posArr[0].hy+(this.posArr[3].hy-this.posArr[0].hy)/2,this.ganImg=new eui.Image("gan"),this.ganImg.anchorOffsetX=12,this.ganImg.anchorOffsetY=5,this.ganImg.visible=!1,this.addChild(this.ganImg),this.lianxiImg=new eui.Image("lianxiBtn1"),this.lianxiImg.anchorOffsetX=48,this.lianxiImg.x=this.centerX,this.lianxiImg.y=this.centerY+170,this.addChild(this.lianxiImg),this.lianxiImg.name="lianxi";var e=RES.getRes("ks3"),r=RES.getRes("ks2"),h=RES.getRes("ks1"),n=new dragonBones.EgretFactory;n.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(e)),n.addTextureAtlas(new dragonBones.EgretTextureAtlas(h,r)),this.ksDragon=n.buildArmature("armatureName"),this.ksDragon.display.name="ks",this.addChild(this.ksDragon.display),this.isKsPlay=!0,this.ksDragon.display.x=this.centerX,this.ksDragon.display.y=this.centerY+80,dragonBones.WorldClock.clock.add(this.ksDragon),this.ksDragon.addEventListener(egret.Event.COMPLETE,function(){this.isKsBtn=!0,this.isKsPlay=!1,this.ksDragon.display.touchEnabled=!0,this.ksDragon.display.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startConnect,this),this.lianxiImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lianxiFunc,this),console.log("11111")}.bind(this),this),this.ksDragon.animation.gotoAndPlay("zq_ks_01a",-1,-1,1);var a=RES.getRes("lianji3"),o=RES.getRes("lianji2"),l=RES.getRes("lianji1"),g=new dragonBones.EgretFactory;g.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(a)),g.addTextureAtlas(new dragonBones.EgretTextureAtlas(l,o)),this.lianjiDragon=g.buildArmature("armatureName"),this.lianjiDragon.display.x=this.centerX+430,this.lianjiDragon.display.y=this.centerY,egret.Ticker.getInstance().register(function(t){return dragonBones.WorldClock.clock.advanceTime(t/1e3),!0},this),document.addEventListener("mousemove",this.mouseMoveGan),this.setTimeNum(0),this.shp1=new egret.Shape,this.addChild(this.shp1),this.shp1.alpha=.6,this.shp2=new egret.Shape,this.addChild(this.shp2),this.shp2.alpha=.6,this.shp3=new egret.Shape,this.addChild(this.shp3),this.shp3.alpha=.6,this.shp4=new egret.Shape,this.addChild(this.shp4),this.shp4.alpha=.6,this["long"]=175.7,this.liduLabel.text="70/100";var s=new egret.Rectangle(251-this["long"],0,this["long"],42);this.lidu.mask=s,this.lidu.touchEnabled=!1,this.promptWord=new PromptWord,this.promptWord.anchorOffsetX=138,this.promptWord.x=this.centerX,this.promptWord.y=this.centerY-230,this.soundganqiu=RES.getRes("ganqiu"),this.soundrudong=RES.getRes("rudong"),this.soundzhuangbian=RES.getRes("zhuangbian"),this.soundzhuangqiu=RES.getRes("zhuangqiu")},i.prototype.SMColor=function(t){var i=0;0==this.myChairId?i=t.chair0Color:1==this.myChairId&&(i=t.chair1Color),this.myColor=i,0==i?(this.smallGroup.x=this.leftGroupPos.x,this.smallGroup.y=this.leftGroupPos.y,this.smallGroup.visible=!0,this.bigGroup.x=this.rightGroupPos.x,this.bigGroup.y=this.rightGroupPos.y,this.bigGroup.visible=!0):1==i&&(this.smallGroup.x=this.rightGroupPos.x,this.smallGroup.y=this.rightGroupPos.y,this.smallGroup.visible=!0,this.bigGroup.x=this.leftGroupPos.x,this.bigGroup.y=this.leftGroupPos.y,this.bigGroup.visible=!0),this.leftLabel.parent&&this.removeChild(this.leftLabel),this.rightLabel.parent&&this.removeChild(this.rightLabel)},i.prototype.SMChat=function(t){this.chatLabel.text=this.chatLabel.text+"\n"+t.info,this.chatLabel.bottom=0},i.prototype.sendFunc=function(){if(1==this.isLianxi){""+GameData.myAccount+": "+this.chatText.text}this.chatText.text=""},i.prototype.downFunc=function(t){return t.stageY<this.downStart?void(this.downIcon.y=this.downStart):t.stageY>this.downOver?void(this.downIcon.y=this.downOver):(this.downIcon.y=t.stageY,void(this.chatLabel.bottom=-(this.downIcon.y-this.downOver)))},i.prototype.lianxiFunc=function(){var t=this.getChildByName("ks");t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startConnect,this),t.parent&&this.removeChild(t),this.isKsBtn=!1;var i=this.getChildByName("lianxi");i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.lianxiFunc,this),i.parent&&this.removeChild(i),this.isLianxi=2,this.isOwnGame=!0,this.ganImg0.visible=!1,this.ganImg1.visible=!0,this.isBaiqiu=1;var s=new eui.Label;s.text="等待游戏开始...",s.width=1440,s.y=this.centerY,s.name="dengdai",s.textAlign=egret.HorizontalAlign.CENTER,this.addChild(s),egret.setTimeout(this.startGame1,this,100)},i.prototype.startConnect=function(){this.isLianxi=1;var t=this.getChildByName("ks");t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.startConnect,this),t.parent&&this.removeChild(t),this.isKsBtn=!1,this.isKsPlay=!1,dragonBones.WorldClock.clock.remove(this.ksDragon);var i=this.getChildByName("lianxi");i.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.lianxiFunc,this),i.parent&&this.removeChild(i);var s=new eui.Label;s.text="等待其他玩家...",s.width=1440,s.y=this.centerY,s.name="dengdai",s.textAlign=egret.HorizontalAlign.CENTER,this.addChild(s)},i.prototype.SMLogin=function(t){GameData.myAccount=t.playerState.account},i.prototype.SMPutBall=function(t){1==this.isBaiqiu?this.countdownFunc(!0,15):this.countdownFunc(!0,25),this.isBaiqiu=0,this.curBall.isJindong=-1,this.curBall.lastX=this.curBall.nextX=Number(t.ball.x),this.curBall.lastY=this.curBall.nextY=Number(t.ball.y),setBaiPos(t.ball.x,t.ball.y),refreshUI()},i.prototype.SMGameEnd=function(t){this.isLosePrompt?this.idTO1=egret.setTimeout(this.SMGameEnd1,this,3e3,t):this.SMGameEnd1(t)},i.prototype.SMGameEnd1=function(t){if(this.isLosePrompt&&(egret.clearTimeout(this.idTO1),this.isLosePrompt=!1),this.countdownFunc(!1),1!=t.code)if(this.isOwnGame=!1,this.isBaiqiu=0,this.ganImg.visible=!1,this.shp1.graphics.clear(),this.shp2.graphics.clear(),this.shp3.graphics.clear(),t.winChair==this.myChairId){var i=new WinUI;i.x=this.centerX-273,i.y=this.centerY-234.5,this.addChild(i),i.playAction()}else{var s=new LoseUI;s.x=this.centerX-273,s.y=this.centerY-234.5,this.addChild(s),s.playAction()}},i.prototype.SMCue=function(t){this.ganImg.visible=!0,this.ganImg.rotation=Number(t.angle),this.ganImg.x=Number(t.point.x),this.ganImg.y=Number(t.point.y)},i.prototype.SMHitPoint=function(t){},i.prototype.SMHitAngle=function(t){},i.prototype.SMTableState=function(t){var i=-1;5==t.code&&(i=t.msg.charAt(t.msg.length-1)),6==t.code&&-1!=t.msg.indexOf("word1 or word2")&&(i=t.msg.charAt(t.msg.length-1)),-1!=i&&(i==this.myChairId?0==this.myColor?this.ball8.alpha=1:1==this.myColor&&(this.ball16.alpha=1):1==this.myColor?this.ball8.alpha=1:0==this.myColor&&(this.ball16.alpha=1)),3==t.code&&(this.isBaiqiu=2,this.countdownFunc(!0,15),this.ganImg.visible=!1),(2==t.code||4==t.code)&&this.countdownFunc(!0,25);var s="";if(this.isTOHit)s="word3",this.isTOHit=!1;else if(-1!=t.msg.indexOf("word1 or word2")){this.isLosePrompt=!0;var e=t.msg.charAt(t.msg.length-1);s=this.myChairId==e?"word2":"word1"}else if("word4 or word5"==t.msg)s=t.nextChair==this.myChairId?"word5":"word4";else if("word6"==t.msg||"word11"==t.msg)s=t.msg;else if("word7 or word8"==t.msg)s=t.nextChair==this.myChairId?"word8":"word7";else if("word9"!=t.msg&&"word10"!=t.msg||t.nextChair!=this.myChairId){if(-1!=t.msg.indexOf("word12")){var e=t.msg.charAt(t.msg.length-1);this.myChairId==e&&(this.isLosePrompt=!0,s="word12")}}else s=t.msg;if(""!=s&&(this.promptWord.setSour(s),this.promptWord.parent||this.addChild(this.promptWord)),this.curActionNum=t.nextChair,t.nextChair==this.myChairId){if(this.isOwnGame=!0,this.ganImg0.visible=!1,this.ganImg1.visible=!0,this.leftTurn.visible=!0,this.rightTurn.visible=!1,0==this.myColor)for(var r=0;r<this.ballArr.length;r++){var h=this.ballArr[r];if(h.idx>=1&&h.idx<=7){var n=RES.getRes("light3"),a=RES.getRes("light2"),o=RES.getRes("light1"),l=new dragonBones.EgretFactory;l.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(n)),l.addTextureAtlas(new dragonBones.EgretTextureAtlas(o,a));var g=l.buildArmature("armatureName");this.addChild(g.display),g.display.x=h.nextX,g.display.y=h.nextY,dragonBones.WorldClock.clock.add(g),g.animation.gotoAndPlay("zq_guang_001a",-1,-1,0),this.lightArr.push(g)}}else if(1==this.myColor)for(var r=0;r<this.ballArr.length;r++){var h=this.ballArr[r];if(h.idx>=9&&h.idx<=15){var n=RES.getRes("light3"),a=RES.getRes("light2"),o=RES.getRes("light1"),l=new dragonBones.EgretFactory;l.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(n)),l.addTextureAtlas(new dragonBones.EgretTextureAtlas(o,a));var g=l.buildArmature("armatureName");this.addChild(g.display),g.display.x=h.nextX,g.display.y=h.nextY,dragonBones.WorldClock.clock.add(g),g.animation.gotoAndPlay("zq_guang_001a",-1,-1,0),this.lightArr.push(g)}}}else this.isOwnGame=!1,this.ganImg0.visible=!0,this.ganImg1.visible=!1,this.leftTurn.visible=!1,this.rightTurn.visible=!0;t.combo>=2&&t.combo<=7&&(this.lianjiDragon.display.parent||this.addChild(this.lianjiDragon.display),dragonBones.WorldClock.clock.add(this.lianjiDragon),this.lianjiDragon.addEventListener(egret.Event.COMPLETE,function(){dragonBones.WorldClock.clock.remove(this.lianjiDragon),this.lianjiDragon.display.parent&&this.removeChild(this.lianjiDragon.display)}.bind(this),this),this.lianjiDragon.animation.gotoAndPlay("zq_00"+t.combo+"a",-1,-1,1))},i.prototype.PlayerEnter=function(t){Number(t.playerState.account)==GameData.myAccount?this.myChairId=t.playerState.chair:this.otherChairId=t.playerState.chair},i.prototype.SMGameStart=function(t){this.curActionNum=t.nextChair,t.nextChair==this.myChairId?(this.isOwnGame=!0,this.isBaiqiu=1,this.ganImg0.visible=!1,this.ganImg1.visible=!0,this.leftTurn.visible=!0,this.rightTurn.visible=!1):(this.isOwnGame=!1,this.isBaiqiu=1,this.ganImg0.visible=!0,this.ganImg1.visible=!1,this.leftTurn.visible=!1,this.rightTurn.visible=!0),this.leftLabel.visible=!0,this.rightLabel.visible=!0,this.startGame1()},i.prototype.startGame1=function(){this.curBall=new NewBall(0),this.curBall.lastX=this.posArr[0].hx+.1*(this.posArr[2].hx-this.posArr[0].hx),this.curBall.lastY=this.posArr[0].hy+(this.posArr[3].hy-this.posArr[0].hy)/2,this.curBall.nextX=this.curBall.lastX,this.curBall.nextY=this.curBall.lastY,this.curBall.name="cur",this.ballArr.push(this.curBall),this.otherX=this.posArr[0].hx+.7*(this.posArr[2].hx-this.posArr[0].hx),this.otherY=this.posArr[0].hy+(this.posArr[3].hy-this.posArr[0].hy)/2;for(var t=0;5>t;t++){var i=new NewBall(this.ballArr.length);i.lastX=this.otherX+(2*i.radius+1)*t*Math.cos(Math.PI/6),i.lastY=this.otherY-(2*i.radius+1)*t*Math.sin(Math.PI/6),i.nextX=i.lastX,i.nextY=i.lastY,this.ballArr.push(i);for(var s=1;t>=s;s++){var e=new NewBall(this.ballArr.length);e.lastX=i.lastX,e.lastY=i.lastY+2*e.radius*s+s,e.nextX=e.lastX,e.nextY=e.lastY,this.ballArr.push(e)}}for(var t=0;t<this.ballArr.length;t++){var i=this.ballArr[t];setBallPos1(i.nextX,i.nextY,t)}refreshUI(),egret.setTimeout(this.startGame2,this,100)},i.prototype.startGame2=function(){this._r=this.ballArr[0].radius,this.countdownTimer=new egret.Timer(1e3,0),this.countdownTimer.addEventListener(egret.TimerEvent.TIMER,this.startCountDown,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.beginFunc,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.moveFunc,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.endFunc,this),this.tipsBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showTips,this),this.tipsBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showTips,this),this.lidudi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.liduFunc,this),this.sendChat.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendFunc,this),this.chatText.text="",this.isCanMove=!0,1==this.isLianxi&&this.downIcon.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.downFunc,this),this.ganImg.visible=!1;var t=this.getChildByName("dengdai");t.parent&&this.removeChild(t),1==this.isLianxi&&this.countdownFunc(!0,15)},i.prototype.removeAllEventListener=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.beginFunc,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.moveFunc,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.endFunc,this),this.tipsBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showTips,this),this.tipsBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showTips,this),this.lidudi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.liduFunc,this),this.sendChat.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendFunc,this),this.countdownTimer.removeEventListener(egret.TimerEvent.TIMER,this.startCountDown,this),this.isCanMove=!1,1==this.isLianxi&&this.downIcon.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.downFunc,this)},i.prototype.quitFunc=function(){this.resetUI(),1==this.isLianxi&&(this.isCanClose=!0),this.isLianxi=0,this.lianxiImg=new eui.Image("lianxiBtn1"),this.lianxiImg.anchorOffsetX=48,this.lianxiImg.x=this.centerX,this.lianxiImg.y=this.centerY+170,this.addChild(this.lianxiImg),this.lianxiImg.name="lianxi";var t=RES.getRes("ks3"),i=RES.getRes("ks2"),s=RES.getRes("ks1"),e=new dragonBones.EgretFactory;e.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),e.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,i)),this.ksDragon=e.buildArmature("armatureName"),this.ksDragon.display.name="ks",this.addChild(this.ksDragon.display),this.isKsPlay=!0,this.ksDragon.display.x=this.centerX,this.ksDragon.display.y=this.centerY+80,dragonBones.WorldClock.clock.add(this.ksDragon),this.ksDragon.addEventListener(egret.Event.COMPLETE,function(){this.isKsBtn=!0,this.isKsPlay=!1,this.ksDragon.display.touchEnabled=!0,this.ksDragon.display.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startConnect,this),this.lianxiImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lianxiFunc,this)}.bind(this),this),this.ksDragon.animation.gotoAndPlay("zq_ks_01a",-1,-1,1),1==this.isLianxi},i.prototype.SMTOPutBall=function(t){this.whiteBall&&this.whiteBall.parent&&(this.removeChild(this.whiteBall),this.whiteBall=null),this.xIcon&&this.xIcon.parent&&(this.removeChild(this.xIcon),this.xIcon=null),1==this.isBaiqiu?this.countdownFunc(!0,15):this.countdownFunc(!0,25),this.isBaiqiu=0,this.curBall.isJindong=-1,this.curBall.lastX=this.curBall.nextX=Number(t.ball.x),this.curBall.lastY=this.curBall.nextY=Number(t.ball.y),setBaiPos(t.ball.x,t.ball.y),refreshUI()},i.prototype.SMTOHit=function(t){this.isTOHit=!0,this.countdownFunc(!1),this.ganImg.visible=!1,this.shp1.graphics.clear(),this.shp2.graphics.clear(),this.shp3.graphics.clear(),this.shp4.graphics.clear();for(var i=0;i<this.lightArr.length;i++)this.lightArr[i]&&(this.lightArr[i].animation.gotoAndStop("zq_guang_001a",0),this.removeChild(this.lightArr[i].display),dragonBones.WorldClock.clock.remove(this.lightArr[i]));this.lightArr=[],this.isOwnGame=!1,this.isMove=!0,this.isBegin=!1,this.ganImg0.visible=!0,this.ganImg1.visible=!0,this.curBall.vx=0,this.curBall.vy=0,this.isLoading=2,this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},i.prototype.countdownFunc=function(t,i){if(void 0===i&&(i=0),t&&i>0){var s=Math.floor(i);this.curTimerNum=s,this.countdownTimer.running||this.countdownTimer.start()}t||(this.curTimerNum=0,this.countdownTimer.running&&this.countdownTimer.stop(),this.setTimeNum(this.curTimerNum))},i.prototype.startCountDown=function(){this.curTimerNum--,this.setTimeNum(this.curTimerNum),0==this.curTimerNum&&this.countdownTimer.stop()},i.prototype.againFunc=function(){if(this.resetUI(),1==this.isLianxi){var t=new eui.Label;t.text="等待其他玩家...",t.width=1440,t.y=this.centerY,t.name="dengdai",t.textAlign=egret.HorizontalAlign.CENTER,this.addChild(t)}else if(2==this.isLianxi){this.isOwnGame=!0,this.ganImg0.visible=!1,this.ganImg1.visible=!0,this.isBaiqiu=1;var t=new eui.Label;t.text="等待游戏开始...",t.width=1440,t.y=this.centerY,t.name="dengdai",t.textAlign=egret.HorizontalAlign.CENTER,this.addChild(t),egret.setTimeout(this.startGame1,this,100)}},i.prototype.resetUI=function(){this.removeAllEventListener();for(var t=this.ballArr.length-1;t>=0;t--)remove3DBall(t),this.ballArr.splice(t,1);refreshUI(),Refresh3DBall(),this.isMove=!1,this.isBegin=!1,this.isOwnGame=!1,this.otherChairId=-1,this.curActionNum=0,this.myColor=-1,this.smallGroup.visible=!1,this.bigGroup.visible=!1,this.leftLabel.visible=!1,this.rightLabel.visible=!1,this.leftTurn.visible=!1,this.rightTurn.visible=!1,this.ball8.alpha=.4,this.ball16.alpha=.4;for(var t=0;t<this.ballImgArr.length;t++)this.ballImgArr[t]&&(this.ballImgArr[t].alpha=.4);for(var t=0;t<this.lightArr.length;t++)this.lightArr[t]&&(this.lightArr[t].animation.gotoAndStop("zq_guang_001a",0),this.removeChild(this.lightArr[t].display),dragonBones.WorldClock.clock.remove(this.lightArr[t]));this.lightArr=[],this.ganImg.visible=!1,this.ganImg0.visible=!0,this.ganImg1.visible=!0,this["long"]=175.7,this.liduLabel.text="70/100";var i=new egret.Rectangle(251-this["long"],0,this["long"],42);this.lidu.mask=i},i.prototype.showTips=function(t){this.tipsUI.parent||(this.tipsUI.anchorOffsetX=212,this.tipsUI.anchorOffsetY=58,this.tipsUI.x=t.target.x,this.tipsUI.y=t.target.y,this.tipsUI.dingshi(),this.addChild(this.tipsUI))},i.prototype.SMHit=function(t){this.countdownFunc(!1),this.ganImg.visible=!1,this.ganImg0.visible=!0,this.ganImg1.visible=!0,this.curBall.vx=Number(t.vx),this.curBall.vy=Number(t.vy),this.isLoading=2,this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},i.Instance=function(){return null==i._instance&&(i._instance=new i),i._instance},i.prototype.mouseMoveGan=function(t){console.log(""),i.Instance().isKsBtn&&i.Instance().playKsAction(t.pageX,t.pageY),i.Instance().isCanMove&&i.Instance().moveGan(t.pageX,t.pageY)},i.prototype.mouseMoveGanStage=function(t){i.Instance().isKsBtn&&i.Instance().playKsAction(t.stageX,t.stageY),i.Instance().isCanMove&&i.Instance().moveGan(t.stageX,t.stageY)},i.prototype.playKsAction=function(t,i){var s=0,e=0;0==bep?(s=_rate*t,e=_rate*(i-bel)):1==bep&&(s=_rate*(t-bel),e=_rate*i);var t=this.centerX,i=this.centerY+80;s>=t-80&&e>=i-80&&t+80>=s&&i+80>=e?this.isKsPlay||(this.isKsPlay=!0,console.log("play"),this.ksDragon.animation.gotoAndPlay("zq_ks_02a",-1,-1,0)):this.isKsPlay&&(this.isKsPlay=!1,console.log("over")),s>=this.lianxiImg.x-48&&s<=this.lianxiImg.x+48&&e>=this.lianxiImg.y&&e<=this.lianxiImg.y+41?"lianxiBtn1"==this.lianxiImg.source&&(this.lianxiImg.source="lianxiBtn2"):"lianxiBtn2"==this.lianxiImg.source&&(this.lianxiImg.source="lianxiBtn1")},i.prototype.moveGan=function(t,i){if(this.isOwnGame){if(0!=this.isBaiqiu){var s=0,e=0;return 0==bep?(s=_rate*t,e=_rate*(i-bel)):1==bep&&(s=_rate*(t-bel),e=_rate*i),void(s>=116&&e>=31&&1311>=s&&683>=e&&(null==this.whiteBall&&(this.whiteBall=new eui.Image("whiteBall"),this.whiteBall.anchorOffsetX=54.5,this.whiteBall.anchorOffsetY=54.5,this.addChild(this.whiteBall),this.curBall.lastX=this.curBall.nextX=-17,this.curBall.lastY=this.curBall.nextY=-17,this.curBall.vx=0,this.curBall.vy=0,setBaiPos(-17,-17),refreshUI()),1==this.isBaiqiu&&(s>418?(null==this.xIcon&&(this.xIcon=new eui.Image("forbid"),this.xIcon.anchorOffsetX=54.5,this.xIcon.anchorOffsetY=54.5,this.addChild(this.xIcon)),this.xIcon.x=s,this.xIcon.y=e):this.xIcon&&this.xIcon.parent&&(this.removeChild(this.xIcon),this.xIcon=null)),this.whiteBall.x=s,this.whiteBall.y=e))}if(!this.isMove&&!this.isBegin){var s=0,e=0;if(0==bep?(s=_rate*t,e=_rate*(i-bel)):1==bep&&(s=_rate*(t-bel),e=_rate*i),s>=116&&e>=31&&1311>=s&&683>=e){var r=s-this.curBall.nextX,h=e-this.curBall.nextY,n=Math.sqrt(r*r+h*h);if(n<=this._r)return;if(this.showGan(s,e),this.setSubline(),1==this.isLianxi){var a=egret.getTimer();a-this.moveTime>1e3&&(this.moveTime=a)}}}}},i.prototype.rotationCoord=function(t,i,s){0==s&&(s=1e-4);var e=-s,r=Math.cos(e)*Math.cos(e)/Math.sin(e)+Math.sin(e),h=(Math.cos(e)*t/Math.sin(e)-i)/r,n=Math.cos(e)+Math.sin(e)*Math.sin(e)/Math.cos(e),a=(Math.sin(e)*t/Math.cos(e)+i)/n;return{x:h,y:a}},i.prototype.showGan=function(t,i){var s=this.curBall.nextX,e=this.curBall.nextY,r=t,h=i,n=r-s,a=h-e,o=Math.sqrt((r-s)*(r-s)+(h-e)*(h-e)),l=0;n>=0&&0>=a&&(l=180*Math.asin(n/o)/Math.PI-90,this.angleSpeed=Math.asin(n/o),this.angleNum=1,this.huadongAngle=this.angleSpeed-Math.PI/2,this.ganImg.x=s-this.ganLen*Math.sin(Math.asin(n/o)),this.ganImg.y=e+this.ganLen*Math.cos(Math.asin(n/o))),n>0&&a>0&&(l=180*Math.asin(a/o)/Math.PI,this.angleSpeed=Math.asin(a/o),this.angleNum=2,this.huadongAngle=this.angleSpeed,this.ganImg.x=s-this.ganLen*Math.cos(Math.asin(a/o)),this.ganImg.y=e-this.ganLen*Math.sin(Math.asin(a/o))),0>a&&0>n&&(l=180*Math.asin(n/o)/Math.PI-90,this.angleSpeed=Math.asin(n/o),this.angleNum=3,this.huadongAngle=this.angleSpeed-Math.PI/2,this.ganImg.x=s+this.ganLen*Math.sin(Math.asin(-n/o)),this.ganImg.y=e+this.ganLen*Math.cos(Math.asin(-n/o))),0>n&&a>0&&(l=180*-(Math.asin(a/o)+90*Math.PI/180)/Math.PI-90,this.angleSpeed=Math.asin(a/o),this.angleNum=4,this.huadongAngle=Math.PI-this.angleSpeed,this.ganImg.x=s+this.ganLen*Math.cos(Math.asin(a/o)),this.ganImg.y=e-this.ganLen*Math.sin(Math.asin(a/o))),this.ganImg.rotation=l,this.ganImg.visible=!0},i.prototype.liduFunc=function(t){if(!this.isBegin&&!this.isMove){this["long"]=251-t.localX,this.liduLabel.text=""+Math.floor(this["long"]/251*100)+"/100";var i=new egret.Rectangle(251-this["long"],0,this["long"],42);this.lidu.mask=i,this.isClickLidu=!0}},i.prototype.beginFunc=function(t){if(this.isOwnGame){if(t.stageX>=116&&t.stageY>=31&&t.stageX<=1311&&t.stageY<=683&&0!=this.isBaiqiu){var i=0,s="";if(1==this.isBaiqiu?(i=418+this._r,s="word15"):2==this.isBaiqiu&&(i=this.posArr[2].x2,s="word14"),!(t.stageX>this.posArr[0].x2+this._r&&t.stageY>this.posArr[0].y1+this._r&&t.stageX<i-this._r&&t.stageY<this.posArr[3].y2-this._r))return this.promptWord.setSour(s),void(this.promptWord.parent||this.addChild(this.promptWord));for(var e=0;6>e;e++){var r=this.posArr[e].hx,h=this.posArr[e].hy;if(t.stageX>r-this.holeR&&t.stageX<r+this.holeR&&t.stageY>h-this.holeR&&t.stageY<h+this.holeR){var n=t.stageX-r,a=t.stageY-h,o=Math.sqrt(n*n+a*a);if(o<this.holeR)return this.promptWord.setSour(s),void(this.promptWord.parent||this.addChild(this.promptWord))}}for(var l=0;l<this.ballArr.length;l++){var g=this.ballArr[l];if("cur"!=g.name){var n=g.nextX-t.stageX,a=g.nextY-t.stageY,o=Math.sqrt(n*n+a*a);if(o<=2*this._r)return this.promptWord.setSour(s),void(this.promptWord.parent||this.addChild(this.promptWord))}}return 1==this.isLianxi,setBaiPos(t.stageX,t.stageY),refreshUI(),this.curBall.lastX=this.curBall.nextX=t.stageX,this.curBall.lastY=this.curBall.nextY=t.stageY,this.whiteBall&&this.whiteBall.parent&&(this.removeChild(this.whiteBall),this.whiteBall=null),this.xIcon&&this.xIcon.parent&&(this.removeChild(this.xIcon),this.xIcon=null),this.curBall.isJindong=-1,1==this.isLianxi&&(1==this.isBaiqiu?this.countdownFunc(!0,15):2==this.isBaiqiu&&this.countdownFunc(!0,25)),void(this.isBaiqiu=0)}if(!this.isMove&&!this.isBegin&&t.stageX>=116&&t.stageY>=31&&t.stageX<=1311&&t.stageY<=683){var n=t.stageX-this.curBall.nextX,a=t.stageY-this.curBall.nextY,o=Math.sqrt(n*n+a*a);if(o<=this._r)return;return 1==this.isLianxi,this.isBegin=!0,this.isClickLidu?this.isClickLidu=!1:this["long"]=175.7,this.addNum=2,this.isLoading=0,this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),void(this.liduTime=egret.setTimeout(function(){this.isLoading=1},this,500))}}},i.prototype.moveFunc=function(t){},i.prototype.endFunc=function(){if(this.isOwnGame&&!this.isMove&&this.isBegin){var t=2*this["long"]/251;1==this.angleNum?(this.curVx=t*Math.sin(this.angleSpeed),this.curVy=-t*Math.cos(this.angleSpeed)):2==this.angleNum?(this.curVx=t*Math.cos(this.angleSpeed),this.curVy=t*Math.sin(this.angleSpeed)):3==this.angleNum?(this.curVx=t*Math.sin(this.angleSpeed),this.curVy=-t*Math.cos(this.angleSpeed)):4==this.angleNum&&(this.curVx=-t*Math.cos(this.angleSpeed),this.curVy=t*Math.sin(this.angleSpeed)),this.shp1.graphics.clear(),this.shp2.graphics.clear(),this.shp3.graphics.clear(),this.shp4.graphics.clear();for(var i=0;i<this.lightArr.length;i++)this.lightArr[i]&&(this.lightArr[i].animation.gotoAndStop("zq_guang_001a",0),this.removeChild(this.lightArr[i].display),dragonBones.WorldClock.clock.remove(this.lightArr[i]));this.lightArr=[],this.curBall.vx=this.curVx,this.curBall.vy=this.curVy,this.isOwnGame=!1,this.isMove=!0,this.isBegin=!1,1==this.isLianxi,this.countdownFunc(!1),egret.clearTimeout(this.liduTime),this.isLoading=0;var s=this.ganImg.x,e=this.ganImg.y,r=this.curBall.nextX-s,h=this.curBall.nextY-e,n=Math.atan2(h,r),a=Math.sin(n),o=Math.cos(n),l=new egret.Point(0,0);l.x-=80*this["long"]/251;var g=this.rotateR(l.x,l.y,a,o,!1),d=s+g.x,u=e+g.y,c=egret.Tween.get(this.ganImg);c.to({x:d,y:u},1e3*(1-this["long"]/251)),c.to({x:s,y:e},600*(1-this["long"]/251)),c.call(function(){this.isLoading=2,this.ganImg.visible=!1,1==this.isLianxi&&(this.ganImg0.visible=!0),this.ganImg1.visible=!0;var t=this.soundganqiu.play(0,1);t.volume=Math.sqrt(this.curVx*this.curVx+this.curVy*this.curVy)/2},this)}},i.prototype.enterFrame=function(){if(1==this.isLoading){this["long"]+=this.addNum,this["long"]>=251?this.addNum=-2:this["long"]<=0&&(this.addNum=2);var t=new egret.Rectangle(251-this["long"],0,this["long"],42);this.lidu.mask=t,this.liduLabel.text=""+Math.floor(this["long"]/251*100)+"/100"}else 2==this.isLoading&&(this.updataMask(),refreshUI())},i.prototype.updataMask=function(){for(var t=0;30>t;t++){for(var i=this.ballArr.length,s=0,e=i-1;e>=0;e--){var r=this.ballArr[e];if(0==r.vx&&0==r.vy&&-1==r.isJindong&&s++,-1!=r.isJindong){var h=egret.Point.polar(11,r.degree*Math.PI/180);r.nextX=this.posArr[r.isJindong].hx+h.x,r.nextY=this.posArr[r.isJindong].hy+h.y,r.degree+=.6,r.degree>=300&&r.degree<300.6&&this.jinqiuAction(r.isJindong),r.degree>=600&&(this.removeBallArr.push(r.idx),"cur"==r.name?(r.nextX=-17,r.nextY=-17,r.isJindong=-1):(remove3DBall(e),this.ballArr.splice(e,1),this.ballImgArr[r.idx-1]&&(this.ballImgArr[r.idx-1].alpha=1)))}else(0!=r.vx||0!=r.vy)&&(r.nextX+=r.vx,r.nextY+=r.vy,r.startRoll(),this.checkWalls(r))}var i=this.ballArr.length;for(e=0;i-1>e;e++){var n=this.ballArr[e];if(-1==n.isJindong)for(var a=e+1;i>a;a++){var o=this.ballArr[a];-1==o.isJindong&&this.checkCollision(n,o)}}if(i==s){this.isLoading=0,this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),console.log("over"),this["long"]=175.7,this.liduLabel.text="70/100";var l=new egret.Rectangle(251-this["long"],0,this["long"],42);this.lidu.mask=l;for(var e=this.ballArr.length-1;e>=0;e--){var g=this.ballArr[e];g.moc=.9997,g.degree=0,g.isJindong=-1}if(1==this.isLianxi){for(var e=0;e<this.ballArr.length;e++)this.ballArr[e].nextX=Math.round(this.ballArr[e].nextX),this.ballArr[e].nextY=Math.round(this.ballArr[e].nextY);this.firstCollision=0,this.removeBallArr=[]}else if(2==this.isLianxi){if(1==this.ballArr.length){var d=new WinUI;d.x=this.centerX-273,d.y=this.centerY-234.5,this.addChild(d),d.playAction()}else this.isOwnGame=!0;-17==this.curBall.nextX&&-17==this.curBall.nextY&&(this.isBaiqiu=2)}this.isMove=!1;break}}for(var i=this.ballArr.length,e=i-1;e>=0;e--){var g=this.ballArr[e];setBallPos(g.nextX,g.nextY,g.lastX,g.lastY,e),g.lastX=g.nextX,g.lastY=g.nextY}},i.prototype.jinqiuAction=function(t){var i=RES.getRes("jinqiu3"),s=RES.getRes("jinqiu2"),e=RES.getRes("jinqiu1"),r=new dragonBones.EgretFactory;r.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(i)),r.addTextureAtlas(new dragonBones.EgretTextureAtlas(e,s));var h=r.buildArmature("armatureName");this.addChild(h.display),h.display.x=this.posArr[t].hx,h.display.y=this.posArr[t].hy,dragonBones.WorldClock.clock.add(h),h.addEventListener(egret.Event.COMPLETE,function(){dragonBones.WorldClock.clock.remove(h),h.display.parent&&this.removeChild(h.display)}.bind(this),this),h.animation.gotoAndPlay("01",-1,-1,1)},i.prototype.checkWalls=function(t){for(var i=0;6>i;i++){var s=this.posArr[i].hx,e=this.posArr[i].hy;if(t.nextX>s-this.holeR&&t.nextX<s+this.holeR&&t.nextY>e-this.holeR&&t.nextY<e+this.holeR){var r=t.nextX-s,h=t.nextY-e,n=Math.sqrt(r*r+h*h);if(n<this.holeR){console.log("ball: "+t.idx);var a=this.soundrudong.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vx=0,t.vy=0,t.isJindong=i}}}if(t.nextX<this.posArr[0].x2+this._r){if(t.nextY>this.posArr[0].y2&&t.nextY<this.posArr[3].y1){t.nextX=this.posArr[0].x2+this._r;var a=this.soundzhuangbian.play(0,1);return a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vx*=this.bounce,!1}if(t.nextY<=this.posArr[0].y2){var r=t.nextX-this.posArr[0].x2,h=t.nextY-this.posArr[0].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[0].x2,this.posArr[0].y2,.7)}if(t.nextY>=this.posArr[3].y1){var r=t.nextX-this.posArr[3].x1,h=t.nextY-this.posArr[3].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[3].x1,this.posArr[3].y1,.7)}}if(t.nextX>this.posArr[2].x2-this._r){if(t.nextY>this.posArr[2].y2&&t.nextY<this.posArr[5].y1){t.nextX=this.posArr[2].x2-this._r;var a=this.soundzhuangbian.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vx*=this.bounce}if(t.nextY<=this.posArr[2].y2){var r=t.nextX-this.posArr[2].x2,h=t.nextY-this.posArr[2].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[2].x2,this.posArr[2].y2,.7)}if(t.nextY>=this.posArr[5].y1){var r=t.nextX-this.posArr[5].x1,h=t.nextY-this.posArr[5].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[5].x1,this.posArr[5].y1,.7)
}}if(t.nextY<this.posArr[0].y1+this._r){if(t.nextX>this.posArr[0].x1&&t.nextX<this.posArr[1].x1){t.nextY=this.posArr[0].y1+this._r;var a=this.soundzhuangbian.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vy*=this.bounce}if(t.nextX>this.posArr[1].x2&&t.nextX<this.posArr[2].x1){t.nextY=this.posArr[0].y1+this._r;var a=this.soundzhuangbian.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vy*=this.bounce}if(t.nextX<=this.posArr[0].x1){var r=t.nextX-this.posArr[0].x1,h=t.nextY-this.posArr[0].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[0].x1,this.posArr[0].y1,.7)}if(t.nextX>=this.posArr[1].x1&&t.nextX<this.posArr[1].hx){var r=t.nextX-this.posArr[1].x1,h=t.nextY-this.posArr[1].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[1].x1,this.posArr[1].y1,.7)}if(t.nextX<=this.posArr[1].x2&&t.nextX>this.posArr[1].hx){var r=t.nextX-this.posArr[1].x2,h=t.nextY-this.posArr[1].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[1].x2,this.posArr[1].y2,.7)}if(t.nextX>=this.posArr[2].x1){var r=t.nextX-this.posArr[2].x1,h=t.nextY-this.posArr[2].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[2].x1,this.posArr[2].y1,.7)}}if(t.nextY>this.posArr[3].y2-this._r){if(t.nextX>this.posArr[3].x2&&t.nextX<this.posArr[4].x1){t.nextY=this.posArr[3].y2-this._r;var a=this.soundzhuangbian.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vy*=this.bounce}if(t.nextX>this.posArr[4].x2&&t.nextX<this.posArr[5].x2){t.nextY=this.posArr[3].y2-this._r;var a=this.soundzhuangbian.play(0,1);a.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2,t.vy*=this.bounce}if(t.nextX<=this.posArr[3].x2){var r=t.nextX-this.posArr[3].x2,h=t.nextY-this.posArr[3].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[3].x2,this.posArr[3].y2,.7)}if(t.nextX>=this.posArr[4].x1&&t.nextX<this.posArr[4].hx){var r=t.nextX-this.posArr[4].x1,h=t.nextY-this.posArr[4].y1,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[4].x1,this.posArr[4].y1,.7)}if(t.nextX<=this.posArr[4].x2&&t.nextX>this.posArr[4].hx){var r=t.nextX-this.posArr[4].x2,h=t.nextY-this.posArr[4].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[4].x2,this.posArr[4].y2,.7)}if(t.nextX>=this.posArr[5].x2){var r=t.nextX-this.posArr[5].x2,h=t.nextY-this.posArr[5].y2,n=Math.sqrt(r*r+h*h);n<this._r&&this.rebound(t,this.posArr[5].x2,this.posArr[5].y2,.7)}}},i.prototype.setSubline=function(){var t=2,i=0,s=0;1==this.angleNum?(i=t*Math.sin(this.angleSpeed),s=-t*Math.cos(this.angleSpeed)):2==this.angleNum?(i=t*Math.cos(this.angleSpeed),s=t*Math.sin(this.angleSpeed)):3==this.angleNum?(i=t*Math.sin(this.angleSpeed),s=-t*Math.cos(this.angleSpeed)):4==this.angleNum&&(i=-t*Math.cos(this.angleSpeed),s=t*Math.sin(this.angleSpeed)),this.shp1.graphics.clear(),this.shp2.graphics.clear(),this.shp3.graphics.clear(),this.shp4.graphics.clear();for(var e=this.curBall.nextX,r=this.curBall.nextY,h=0;1500>h;h++){e+=i,r+=s;for(var n=this.ballArr.length,a=!1,o=0;n>o;o++){var l=this.ballArr[o];if("cur"!=l.name){var g=l.nextX-e,d=l.nextY-r,u=Math.sqrt(g*g+d*d);if(u<=2*this._r){a=!0;var c=this.rotationCoord(e,r,this.huadongAngle),p=this.rotationCoord(l.nextX,l.nextY,this.huadongAngle),x=c.x-p.x,v=c.y-p.y,m=Math.sqrt(x*x+v*v),y=Math.abs(x/m),b=v/Math.abs(v),A=Math.atan2(d,g),f=Math.sin(A),E=Math.cos(A),T=this.rotateR(g,d,f,E,!0);T.x+=70*y;var I=new egret.Point(0,b*(this._r+50*(1-y))),C=new egret.Point(0,b*this._r),B=this.rotateR(T.x,T.y,f,E,!1),_=this.rotateR(I.x,I.y,f,E,!1),R=this.rotateR(C.x,C.y,f,E,!1);this.shp3.graphics.lineStyle(3,16777215),this.shp3.graphics.moveTo(l.nextX,l.nextY),this.shp3.graphics.lineTo(e+B.x,r+B.y),this.shp3.graphics.endFill(),this.shp4.graphics.lineStyle(3,16777215),this.shp4.graphics.moveTo(e+R.x,r+R.y),this.shp4.graphics.lineTo(e+_.x,r+_.y),this.shp4.graphics.endFill();break}}}if(a)break;for(var w=!0,h=0;6>h;h++){var M=this.posArr[h].hx,L=this.posArr[h].hy;if(e>M-this.holeR&&e<M+this.holeR&&r>L-this.holeR&&r<L+this.holeR){var g=e-M,d=r-L,u=Math.sqrt(g*g+d*d);if(u<this.holeR){w=!1;break}}}if(e<this.posArr[0].x2+this._r)break;if(e>this.posArr[2].x2-this._r)break;if(r<this.posArr[0].y1+this._r)break;if(r>this.posArr[3].y2-this._r)break}this.shp1.graphics.lineStyle(3,16777215),this.shp1.graphics.moveTo(this.curBall.nextX,this.curBall.nextY),this.shp1.graphics.lineTo(e,r),this.shp1.graphics.endFill(),this.shp2.graphics.lineStyle(3,16777215),this.shp2.graphics.drawCircle(e,r,this._r-2),this.shp2.graphics.endFill()},i.prototype.rotateR=function(t,i,s,e,r){var h=new egret.Point;return r?(h.x=t*e+i*s,h.y=i*e-t*s):(h.x=t*e-i*s,h.y=i*e+t*s),h},i.prototype.checkCollision=function(t,i){var s=i.nextX-t.nextX,e=i.nextY-t.nextY,r=Math.sqrt(s*s+e*e);if(r<2*this._r){var h=t.vx+i.vx,n=t.vy+i.vy,a=this.soundzhuangqiu.play(0,1);a.volume=Math.sqrt(h*h+n*n)/2;var o=Math.atan2(e,s),l=Math.sin(o),g=Math.cos(o),d=new egret.Point(0,0),u=this.rotateR(s,e,l,g,!0),c=this.rotateR(t.vx,t.vy,l,g,!0),p=this.rotateR(i.vx,i.vy,l,g,!0),x=2*this._r-Math.abs(d.x-u.x);d.x-=.5*x+1e-4,u.x+=.5*x+1e-4;var v=this.rotateR(d.x,d.y,l,g,!1),m=this.rotateR(u.x,u.y,l,g,!1);i.nextX=t.nextX+m.x,i.nextY=t.nextY+m.y,t.nextX=t.nextX+v.x,t.nextY=t.nextY+v.y;var y=c.x-p.x;c.x=p.x,p.x=y+c.x;var b=this.rotateR(c.x,c.y,l,g,!1),A=this.rotateR(p.x,p.y,l,g,!1);t.vx=b.x,t.vy=b.y,i.vx=A.x,i.vy=A.y,0==this.firstCollision&&(0==t.idx&&(this.firstCollision=i.idx),0==i.idx&&(this.firstCollision=t.idx))}},i.prototype.rebound=function(t,i,s,e){if(0==e)return t.vx=0,void(t.vy=0);var r=this.soundzhuangbian.play(0,1);r.volume=Math.sqrt(t.vx*t.vx+t.vy*t.vy)/2;var h=i-t.nextX,n=s-t.nextY,a=Math.atan2(n,h),o=Math.sin(a),l=Math.cos(a),g=new egret.Point(0,0),d=this.rotateR(h,n,o,l,!0);g.x=d.x-this._r-1e-4;var u=this.rotateR(g.x,g.y,o,l,!1);t.nextX=t.nextX+u.x,t.nextY=t.nextY+u.y;var c=this.rotateR(t.vx,t.vy,o,l,!0),p=this.rotateR(0,0,o,l,!0),x=c.x-p.x;c.x=p.x,p.x=x+c.x;var v=this.rotateR(c.x,c.y,o,l,!1),m=this.rotateR(p.x,p.y,o,l,!1);t.vx=e*(v.x-m.x),t.vy=e*(v.y-m.y)},i.prototype.setTimeNum=function(t){if(!(0>t||t>=100)){var i=Math.floor(t),s=Math.floor(i/10),e=i-10*s;this.leftNumImg.source="num"+s,this.rightNumImg.source="num"+e}},i}(eui.Component);TableUI._instance=null,__reflect(TableUI.prototype,"TableUI");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,i,s){function e(e){i.call(s,e,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?e(r):RES.getResAsync(t,e,this)}else RES.getResByUrl(t,e,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoseUI=function(t){function i(){var i=t.call(this)||this;return i.skinName="LoseUISkin",i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.tuichuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tuichuFunc,this),this.jixuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jixuFunc,this)},i.prototype.playAction=function(){var t=RES.getRes("lose3"),i=RES.getRes("lose2"),s=RES.getRes("lose1"),e=new dragonBones.EgretFactory;e.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),e.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,i));var r=e.buildArmature("armatureName");this.addChild(r.display),r.display.x=275,r.display.y=290,dragonBones.WorldClock.clock.add(r),r.addEventListener(egret.Event.COMPLETE,function(){dragonBones.WorldClock.clock.remove(r)},this),r.animation.gotoAndPlay("zq_lose_01a",-1,-1,1)},i.prototype.tuichuFunc=function(){this.parent&&this.parent.removeChild(this),TableUI.Instance().quitFunc()},i.prototype.jixuFunc=function(){this.parent&&this.parent.removeChild(this),TableUI.Instance().againFunc()},i}(eui.Component);__reflect(LoseUI.prototype,"LoseUI");var NewBall=function(){function t(t){this.radius=17,this.vx=0,this.vy=0,this.idx=0,this.nextX=0,this.nextY=0,this.lastX=0,this.lastY=0,this.name="",this.isJindong=-1,this.moc=.9997,this.degree=0,this.idx=t,create3DBall(t)}return t.prototype.startRoll=function(){this.vx=this.vx*this.moc,this.vy=this.vy*this.moc,Math.abs(this.vx)<.04&&Math.abs(this.vy)<.04&&(this.moc-=1e-6),Math.abs(this.vx)<.002&&Math.abs(this.vy)<.002&&(this.vx=0,this.vy=0)},t}();__reflect(NewBall.prototype,"NewBall");var PromptWord=function(t){function i(){var i=t.call(this)||this;return i._str="",i._time=null,i.skinName="PromptWordUISkin",i}return __extends(i,t),i.prototype.setSour=function(t){this._str!=t&&(this._str=t,this.word.source=t),this.dingshi()},i.prototype.dingshi=function(){this._time&&egret.clearTimeout(this._time),this._time=egret.setTimeout(this.removeThis,this,2300)},i.prototype.removeThis=function(){this._time=null,this.parent&&this.parent.removeChild(this)},i}(eui.Component);__reflect(PromptWord.prototype,"PromptWord");var GameData=function(){function t(){}return t}();GameData.isScoll=!1,GameData.myAccount=0,__reflect(GameData.prototype,"GameData");var TipsUI=function(t){function i(){var i=t.call(this)||this;return i.skinName="TipsUISkin",i}return __extends(i,t),i.prototype.dingshi=function(){egret.setTimeout(this.removeThis,this,3e3)},i.prototype.removeThis=function(){this.parent&&this.parent.removeChild(this)},i}(eui.Component);__reflect(TipsUI.prototype,"TipsUI");var WinUI=function(t){function i(){var i=t.call(this)||this;return i.skinName="WinUISkin",console.log("dawdad"),i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.tuichuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tuichuFunc,this),this.jixuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jixuFunc,this)},i.prototype.playAction=function(){var t=RES.getRes("win3"),i=RES.getRes("win2"),s=RES.getRes("win1"),e=new dragonBones.EgretFactory;e.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),e.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,i));var r=e.buildArmature("armatureName");this.addChild(r.display),r.display.x=275,r.display.y=290,dragonBones.WorldClock.clock.add(r),r.addEventListener(egret.Event.COMPLETE,function(){dragonBones.WorldClock.clock.remove(r)},this),r.animation.gotoAndPlay("zq_win_01a",-1,-1,1)},i.prototype.tuichuFunc=function(){this.parent&&this.parent.removeChild(this),TableUI.Instance().quitFunc()},i.prototype.jixuFunc=function(){this.parent&&this.parent.removeChild(this),TableUI.Instance().againFunc()},i}(eui.Component);__reflect(WinUI.prototype,"WinUI");var LoadingUI=function(t){function i(){var i=t.call(this)||this;return i.createView(),i}return __extends(i,t),i.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=1026,this.textField.height=100,this.textField.textAlign="center"},i.prototype.setProgress=function(t,i){this.textField.text="Loading..."+t+"/"+i},i}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.isThemeLoadEnd=!1,i.isResourceLoadEnd=!1,i}return __extends(i,t),i.prototype.createChildren=function(){var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var i=new eui.Theme("resource/default.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},i.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.mPR(),this.createScene()},i.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.isResourceLoadEnd=!0,this.createScene())},i.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},i.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},i.prototype.startCreateScene=function(){GameData.isScoll=!1,add3DBall();var t=TableUI.Instance();this.addChild(t),window.addEventListener("resize",this.getScene)},i.prototype.getScene=function(){IsDifferent()},i.prototype.mPR=function(){var t=1440/document.body.clientWidth,i=900/document.body.clientHeight;t>=i?(bep=0,_rate=t,bel=(document.body.clientHeight-900/t)/2):(bep=1,_rate=i,bel=(document.body.clientWidth-1440/i)/2)},i}(eui.UILayer);__reflect(Main.prototype,"Main");var _rate,bel,bep,ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,i,s,e){function r(t){i.call(e,t)}function h(i){i.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,h,null),s.call(e))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,h,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);