var __reflect=this&&this.__reflect||function(t,e,s){t.__class__=e,s?s.push(e):s=[e],t.__types__=t.__types__?s.concat(t.__types__):s},__extends=this&&this.__extends||function(t,e){function s(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);s.prototype=e.prototype,t.prototype=new s},__awaiter=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))(function(n,o){function r(t){try{h(i.next(t))}catch(e){o(e)}}function a(t){try{h(i["throw"](t))}catch(e){o(e)}}function h(t){t.done?n(t.value):new s(function(e){e(t.value)}).then(r,a)}h((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function s(t){return function(e){return i([t,e])}}function i(s){if(n)throw new TypeError("Generator is already executing.");for(;h;)try{if(n=1,o&&(r=o[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return h.label++,{value:s[1],done:!1};case 5:h.label++,o=s[1],s=[0];continue;case 7:s=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){h=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){h.label=s[1];break}if(6===s[0]&&h.label<r[1]){h.label=r[1],r=s;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(s);break}r[2]&&h.ops.pop(),h.trys.pop();continue}s=e.call(t,h)}catch(i){s=[6,i],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var n,o,r,a,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},State=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addToParent=function(t,e){t.addChild(this),this.isInit||this.init(),this.show(e)},e.prototype.init=function(){this.isInit=!0},e.prototype.show=function(t){},e.prototype.next=function(t,e){this.dispatchEvent(new StateEvent(StateEvent.NEXT,t,e))},e.prototype.popup=function(t,e){this.dispatchEvent(new StateEvent(StateEvent.POPUP,t,e))},e.prototype.returnToLast=function(t){this.dispatchEvent(new StateEvent(StateEvent.LAST,null,t))},e.prototype.tick=function(t){},e.prototype.close=function(){this.parent&&(this.isPopup&&this.dispatchEvent(new StateEvent(StateEvent.POPUPCLOSE,null,null)),this.parent.removeChild(this),this.dispose())},e.prototype.dispose=function(){App.MessageCenter.removeAll(this),App.TimerManager.removeAll(this)},e}(egret.DisplayObjectContainer);__reflect(State.prototype,"State",["IState","egret.IEventDispatcher"]);var BaseClass=function(){function t(){}return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var s=this;if(!s._instance){var i=t.length;0==i?s._instance=new s:1==i?s._instance=new s(t[0]):2==i?s._instance=new s(t[0],t[1]):3==i?s._instance=new s(t[0],t[1],t[2]):4==i?s._instance=new s(t[0],t[1],t[2],t[3]):5==i&&(s._instance=new s(t[0],t[1],t[2],t[3],t[4]))}return s._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var GameUser=function(){function t(){this.id=0,this.name="",this.avatar="http://pic.vszone.cn/upload/avatar/1464079970.png",this.token="",this.pValue=0,this.tableID=0,this.isOwner=!1,this.curAvatarType=1,this.ownerId=0,this.maxScore=0}return t}();__reflect(GameUser.prototype,"GameUser");var StateBG=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.stageWidth=App.GameWidth,this.stageHeight=App.GameHeight,this.halfStageWidth=this.stageWidth/2,this.halfStageHeight=this.stageHeight/2},Object.defineProperty(e.prototype,"bg",{set:function(t){this.background=AssetManager.getBitmap(t),this.background&&(this.background.x=this.stageWidth/2,this.background.y=this.stageHeight/2,this.addChild(this.background))},enumerable:!0,configurable:!0}),e}(State);__reflect(StateBG.prototype,"StateBG");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,App.TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),s=0,i=e.length;i>s;s++){var n=e[s];this.checkCanClear(n)&&t-this._cache[n]>=SoundManager.CLEAR_TIME&&(delete this._cache[n],RES.destroyRes(n))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var s=this._loadingCache.indexOf(e);-1!=s&&(this._loadingCache.splice(s,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var Lobby=function(t){function e(){var e=t.call(this)||this;return e.i=0,e.skinName="resource/mySkins/Lobby.exml",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.selected.getChildAt(0).visible=!0,PcKeyBoardHelper.instance.addListener(this.KeyBoardMethod,this),this.len=this.selected.numChildren},e.prototype.KeyBoardMethod=function(t){if(39==t.keyCode){for(this.i;this.i<this.len;this.i++)if(this.selected.getChildAt(this.i).visible=!0){this.selected.getChildAt(this.i).visible=!1,this.i!=this.len-1?(this.selected.getChildAt(this.i+1).visible=!0,this.i=this.i+1):(this.selected.getChildAt(0).visible=!0,this.i=0);break}}else if(37==t.keyCode){for(this.i;this.i<this.len;this.i++)if(this.selected.getChildAt(this.i).visible=!0){this.selected.getChildAt(this.i).visible=!1,0!=this.i?(this.selected.getChildAt(this.i-1).visible=!0,this.i=this.i-1):(this.selected.getChildAt(2).visible=!0,this.i=2);break}}else if(13==t.keyCode)switch(this.i){case 0:GameSceneView._gameScene.match(0),console.log("匹配模式"),PcKeyBoardHelper.instance.removeListener(this);break;case 1:console.log("xuanze 排位"),GameSceneView._gameScene.match(1),PcKeyBoardHelper.instance.removeListener(this),this.i=0;break;case 2:GameSceneView._gameScene.match(2),PcKeyBoardHelper.instance.removeListener(this),console.log("家庭模式"),this.i=0}},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.height=this.stage.stageHeight,this.initView()},e.prototype.initView=function(){var t=this;this.group.getChildAt(0).addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.showSelected(0),GameSceneView._gameScene.match(0)},this),this.group.getChildAt(1).addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.showSelected(1),GameSceneView._gameScene.match(1)},this),this.group.getChildAt(2).addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.showSelected(2),GameSceneView._gameScene.match(2)},this)},e.prototype.showSelected=function(t){for(var e=0;e<this.selected.numChildren;e++)this.selected.getChildAt(e).visible=e==t},e.canClick=!0,e}(eui.Component);__reflect(Lobby.prototype,"Lobby",["eui.UIComponent","egret.DisplayObject"]);var Login=function(t){function e(){var e=t.call(this)||this;return e.addMsResponseListen(),e}return __extends(e,t),e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s)},e.prototype.childrenCreated=function(){this.height=this.stage.stageHeight,t.prototype.childrenCreated.call(this),this.loading=Loading.create(this),this.Init()},e.prototype.Init=function(){this.loading.show(),this.CheckSaoMa();mvs.MsEngine.getInstance.init(GameData.CHANNEL,GameData.DEFAULT_ENV,GameData.gameID)},e.prototype.CheckSaoMa=function(){var t=window.location.href,e=t.split("?",20);GameData.roomID=e[1],e.length>1&&(GameData.isSaoMaEnter=!0)},e.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_INIT_RSP,this.initResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_REGISTERUSER_RSP,this.registerUserResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this)},e.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_INIT_RSP,this.initResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_REGISTERUSER_RSP,this.registerUserResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this)},e.prototype.initResponse=function(t){console.log("initResponse,status:"+t.data.status),200==t.data.status&&mvs.MsEngine.getInstance.registerUser()},e.prototype.registerUserResponse=function(t){var e=t.data;GameData.gameUser.id=e.id,GameData.gameUser.name=e.name,console.log(e.name+"________________________________________"),GameData.gameUser.avatar=e.avatar,GameData.gameUser.token=e.token,0==e.status&&mvs.MsEngine.getInstance.login(e.id,e.token,GameData.gameID,GameData.appkey,GameData.secretKey)},e.prototype.loginResponse=function(t){var e=this;mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this);var s=t.data;console.log("loginResponse, status="+s.status),200!=s.status?console.log("登陆失败"):(console.log("登陆成功 roomID="+s.roomID),"0"!==s.roomID?(GameData.roomID=s.roomID,GameSceneView._gameScene.reconnectView()):setTimeout(function(){e.loading.close(),0==GameData.isSaoMaEnter?GameSceneView._gameScene.lobby():GameSceneView._gameScene.match(4)},500))},e}(eui.Component);__reflect(Login.prototype,"Login",["eui.UIComponent","egret.DisplayObject"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(s){switch(s.label){case 0:return[4,this.loadResource()];case 1:return s.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=s.sent(),[4,platform.login()];case 3:return s.sent(),[4,platform.getUserInfo()];case 4:return e=s.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return s.sent(),[4,RES.loadGroup("loading")];case 2:return s.sent(),t=new LoadingUI,this.stage.addChild(t),[4,this.loadTheme()];case 3:return s.sent(),[4,RES.loadGroup("lobby",0,t)];case 4:return s.sent(),[4,this.onResourceLoadComplete()];case 5:return s.sent(),this.stage.removeChild(t),[3,7];case 6:return e=s.sent(),console.error(e),[3,7];case 7:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,s){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.onResourceLoadComplete=function(){var t=RES.getRes("dbConfig_json");AssetManager.loadDBAnimation(t.db[0])},e.prototype.createGameScene=function(){LocalStore_Clear(),this._scene=new GameSceneView,this._scene.graphics.beginFill(0),this._scene.graphics.drawRect(this.x,this.y,this.width,this.height),this._scene.graphics.endFill(),this.addChild(this._scene),console.log(this._scene)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var match=function(t){function e(s){var i=t.call(this)||this;return i._isInRoom=!1,i.isOwner=!1,i.canStartGame=!1,i._roomID="",i.default_name="待加入",i.default_rect_color=5592405,i.isOnePlayAgain=!0,i.curSelect=1,i.canRigLef=!1,i.num=0,i.skinName="resource/mySkins/match.exml",e.joinFlag=s,i}return __extends(e,t),e.prototype.showBtn=function(){2==e.joinFlag||3==e.joinFlag?(console.log(""),this.btn_start.visible=!0,this.group_selected.visible=!0,this.wenxintishi.visible=!0,this.wenxintishi.y+this.wenxintishi.height>this.group_btns.y&&(this.group_btns.y=this.wenxintishi.y+this.wenxintishi.height,this.group_selected.y=this.wenxintishi.y+this.wenxintishi.height)):(this.btn_leave.x=this.group_btns.width/2,this.group_selected.getChildAt(0).x=this.btn_leave.x,this.btn_start.visible=!1),PcKeyBoardHelper.instance.addListener(this.KeyBoardMethod,this)},e.prototype.KeyBoardMethod=function(t){if(0==e.joinFlag||1==e.joinFlag)40==t.keyCode?(this.group_selected.getChildAt(0).visible=!0,this.canRigLef=!0):this.canRigLef&&13==t.keyCode&&(this.mbuttonLeaveRoom(),PcKeyBoardHelper.instance.removeListener(this));else if(2==e.joinFlag&&(40==t.keyCode&&(this.group_selected.getChildAt(this.curSelect).visible=!0,this.canRigLef=!0),this.canRigLef&&37==t.keyCode&&(this.group_selected.getChildAt(this.curSelect).visible=!1,this.curSelect=0==this.curSelect?1:0,this.group_selected.getChildAt(this.curSelect).visible=!0),this.canRigLef&&39==t.keyCode&&(this.group_selected.getChildAt(this.curSelect).visible=!1,this.curSelect=1==this.curSelect?0:1,this.group_selected.getChildAt(this.curSelect).visible=!0),this.canRigLef&&13==t.keyCode))switch(this.curSelect){case 0:this.curSelect=1,this.mbuttonLeaveRoom(),PcKeyBoardHelper.instance.removeListener(this);break;case 1:this.canStartGame&&(this.StartGame(),this.curSelect=1,PcKeyBoardHelper.instance.removeListener(this))}},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);for(var s=GameData._playerList.length,i=0;s>i;i++)this.delPlayerList(GameData._playerList[0].id);switch(mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getroomDetails,this),e.joinFlag){case 0:this.joinRandRoom();break;case 1:var n={name:"paiwei",score:"score"};this.joinRoomWithPro(n);break;case 2:this.createRoom();break;case 3:GameData.roomID&&mvs.MsEngine.getInstance.getRoomDetail(GameData.roomID);break;case 4:this.joinWithRoomID(GameData.roomID)}this.initView(),this.btn_leave.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonLeaveRoom,this)},e.prototype.initView=function(){var t=this;this.player1LoadingMask.width=0,this.player2LoadingMask.width=0,this.player1Loading.mask=this.player1LoadingMask,this.player2Loading.mask=this.player2LoadingMask,this.pipeiIng_img.width=this.playerbg1_group.width,this.pipeiIng_img.height=this.playerbg1_group.height,this.StageH=this.stage.stageHeight,this.StageW=this.stage.stageWidth,this.height=this.StageH,this.vX=this.v.x,this.sX=this.s.x,this.v.x=0-this.width,this.s.x=this.width+this.s.width,this.showBtn(),this.addMsResponseListen(),this.strTXT=this.txt.text;var e=0;this.set=setInterval(function(){t.txt.text=t.strTXT.substring(0,e),e++,4==e&&(e=0)},350)},e.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_RSP,this.setRoomPropertyResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_NTFY,this.setRoomPropertynotify,this)},e.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_RSP,this.setRoomPropertyResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_NTFY,this.setRoomPropertynotify,this)},e.prototype.getroomDetails=function(t){console.log(t.data.owner),GameData.gameUser.id==t.data.owner?GameData.isRoomOwner=!0:GameData.isRoomOwner=!1;for(var e=0;e<t.data.userInfos.length;e++){var s=JSON.parse(t.data.userInfos[e].userProfile);2==t.data.userInfos.length&&2!=GameData._playerList.length?t.data.userInfos[e].userID==GameData.gameUser.id?this.addPlayerList(t.data.userInfos[e].userID,s.name,s.avatar,1,s.curAvatarType,GameData.isRoomOwner):this.addPlayerList(t.data.userInfos[e].userID,s.name,s.avatar,2,s.curAvatarType,GameData.isRoomOwner):1==t.data.userInfos.length&&1!=GameData._playerList.length&&this.addPlayerList(t.data.userInfos[e].userID,s.name,s.avatar,1,s.curAvatarType,GameData.isRoomOwner)}this.playAgain()},e.prototype.playAgain=function(){if(this.isOnePlayAgain){2==GameData._playerList.length?this.num++:1==GameData._playerList.length&&(this.num=0),this._isInRoom=!0,console.log("开始擦除用户信息{{{{{{{{{}}}}}}}}}"),GameData.isRoomOwner&&this.createQRCode();for(var t=0;t<GameData._playerList.length;t++)this.showPlayer(GameData._playerList[t]),console.log(GameData._playerList[t]);this.txtGroup.visible=!1,this.btn_leave.anchorOffsetX=this.btn_leave.width/2,this.btn_start.anchorOffsetX=this.btn_start.width/2,this.btn_leave.x=this.width/2-this.btn_leave.width/2*3,this.btn_start.x=this.width/2+this.btn_start.width/3*2,this.btn_start.visible=!0,this.wenxintishi.visible=!0,this.checkStart(),this.isOnePlayAgain=!1}},e.prototype.joinRandRoom=function(){GameData.isCreateRoom=!1;var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRandomRoom(GameData.maxPlayerNum,t)},e.prototype.createRoom=function(){GameData.isCreateRoom=!0;var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.createRoom(GameData.createRoomInfo,t)},e.prototype.joinWithRoomID=function(t){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRoom(t,e)},e.prototype.joinRoomWithPro=function(t){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar}),s=new MsMatchInfo(GameData.maxPlayerNum,0,0,t);mvs.MsEngine.getInstance.joinRoomWithProperties(s,e)},e.prototype.addPlayerList=function(t,e,s,i,n,o){void 0===o&&(o=!1);var r=new GameUser;return r.id=t,r.name=e,r.avatar=s,r.tableID=i,r.isOwner=o,r.curAvatarType=n,GameData._playerList.push(r),this.showPlayer(r),r},e.prototype.delPlayerList=function(t){for(var e=new GameUser,s=0;s<GameData._playerList.length;s++)GameData._playerList[s].id==t&&(e.id=GameData._playerList[s].id,e.avatar=GameData._playerList[s].avatar,e.name=GameData._playerList[s].name,e.tableID=GameData._playerList[s].tableID,GameData._playerList.splice(s,1),this.wipePlayer(e))},e.prototype.showPlayer=function(t){var e=t.tableID;t.id==GameData.gameUser.id&&(this.player2_name.text=GameData.gameUser.name,this.LoadeAvatar(t.avatar,this.playerbg2_group)),1==e||2==e&&(this.sprite&&(this.saomatip.visible=!1,this.shp.visible=!1,this.sprite.visible=!1),this.pipeiIng_img.texture=RES.getRes("bg2_png"),this.LoadeAvatar(t.avatar,this.playerbg1_group),this.player1_name.text=t.name,this.txtGroup.visible=!1)},e.prototype.wipePlayer=function(t){var e=t.tableID;1==e?(this.pipeiIng_img.texture=RES.getRes("bg1_png"),this.playerbg2_group.getChildByName("touxiang")&&this.playerbg2_group.removeChild(this.playerbg2_group.getChildByName("touxiang"))):2==e&&(this.player1_name.text="",this.pipeiIng_img.texture=RES.getRes("bg1_png"),this.playerbg1_group.getChildByName("touxiang")&&this.playerbg1_group.removeChild(this.playerbg1_group.getChildByName("touxiang")))},e.prototype.wipePlayerLocation=function(t,e){this.num--,this.createQRCode(),this.isOwner=e==GameData.gameUser.id,this.delPlayerList(t);for(var s=0;s<GameData._playerList.length;s++)GameData._playerList[s].isOwner=e==GameData._playerList[s].id,GameData._playerList[s].tableID=s+1},e.prototype.mbuttonLeaveRoom=function(){e.joinFlag=0,clearTimeout(this.ss),this._isInRoom?mvs.MsEngine.getInstance.leaveRoom("累了困了离开一下"):(this.release(),GameSceneView._gameScene.lobby())},e.prototype.btnKickPlayerClick=function(t){var e=0;"btn_kick2"==t.target.name?e=2:"btn_kick3"==t.target.name&&(e=3);var s=this.getUserForTableID(e);return null==s?void console.info("用户不存在"):void mvs.MsEngine.getInstance.kickPlayer(s.id,"我们不能一起好好的玩游戏")},e.prototype.getUserForTableID=function(t){var e=null;return GameData._playerList.forEach(function(s){s.tableID==t&&(e=s)}),e},e.prototype.leaveRoomNotify=function(t){var s=t.data;console.info("玩家离开",s);var i=s.userId;s.owner==GameData.gameUser.id?(this.isOwner=!0,GameData.isRoomOwner=!0):this.isOwner=!1,this.delPlayerList(i),this.canStartGame=!1,0==e.joinFlag||1==e.joinFlag?this.txtGroup.visible=!0:(2==e.joinFlag||3==e.joinFlag||4==e.joinFlag)&&(this.player1_name.text="",this.createQRCode());for(var n=0;n<GameData._playerList.length;n++)s.owner==GameData._playerList[n].id?GameData._playerList[n].isOwner=!0:GameData._playerList[n].isOwner=!1,GameData._playerList[n].tableID=n+1,this.showPlayer(GameData._playerList[n])},e.prototype.leaveRoomResponse=function(t){this.delPlayerList(t.data.userId);var e=t.data;200!==e.status?console.log("退出房间失败！status="+e.status):(this.release(),console.log("闯哥牛逼"),GameSceneView._gameScene.lobby())},e.prototype.createRoomResponse=function(t){var e=t.data;if(200==e.status){console.log("创建房间成功###############################");var s=1;this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,s,GameData.gameUser.curAvatarType,this.isOwner),this._roomID=e.roomID,GameData.roomID=e.roomID,this._isInRoom=!0,this.createQRCode(),this.txtGroup.visible=!1,e.owner==GameData.gameUser.id?(this.isOwner=!0,GameData.isRoomOwner=!0):this.isOwner=!1}else console.info("加入房间失败",e)},e.prototype.joinRoomResponse=function(t){var e=t.data,s=this;if(200==e.status){GameData.gameUser.ownerId=e.owner,e.roomInfo.ownerId==GameData.gameUser.id?(this.isOwner=!0,GameData.isRoomOwner=!0,this.ss=setTimeout(function(){0==s.num&&s.GameAI()},5e3)):this.isOwner=!1,this._roomID=e.roomInfo.roomID,GameData.roomID=e.roomInfo.roomID,this._isInRoom=!0,GameData.gameUser.isOwner=!1;var i=1;this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,i,GameData.gameUser.curAvatarType,this.isOwner);for(var n=e.userList,o=0;o<n.length;o++)i++,this.otherJoinShowInfo(n[o].userId,i,n[o].userProfile,e.roomInfo.ownerId==n[o].userId);this.checkStart()}else console.info("加入房间失败",e)},e.prototype.checkStart=function(){var t=this;console.info("房间人数："+GameData._playerList.length),GameData._playerList.length==GameData.maxPlayerNum?(console.info("可以开始游戏"),console.log(GameData.isRoomOwner),1==GameData.isRoomOwner&&(this.sprite?(this.canStartGame=!0,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.StartGame(),t.btn_start.enabled=!1},this)):(this.canStartGame=!0,this.StartGame()))):this.canStartGame=!1},e.prototype.otherJoinShowInfo=function(t,e,s,i){if(void 0===i&&(i=!1),s&&""!==s){var n="",o="",r=JSON.parse(s);r.name&&(n=r.name),r.avatar&&(o=r.avatar),this.addPlayerList(t,n,o,e,r.curAvatarType,i)}},e.prototype.joinRoomNotify=function(t){this.num++,clearTimeout(this.ss);var e=t.data,s=(e.userId,GameData._playerList.length+1);this.otherJoinShowInfo(e.userId,s,e.userProfile,e.userId==e.owner),this.checkStart()},e.prototype.notifyGameStart=function(){this.btn_leave.visible=!1,e.canClick=!1,this.group_selected.visible=!1,this.btn_leave.enabled=!1,1==this.isOwner;var t=[];GameData._playerList.forEach(function(e){t.push({id:e.id,name:e.name,avatar:e.avatar})});var s={action:GameData.gameStartEvent,userIds:t},i=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(s));return 0!==i.result?console.log("发送游戏开始通知失败，错误码"+i.result):(GameData.events[i.sequence]=s,void console.log("发起游戏开始的通知，等待回复"))},e.prototype.StartGame=function(){this.btn_start.visible=!1,this.group_selected.visible=!1,GameData._playerList.length>=GameData.maxPlayerNum?(GameData.playerUserIds=GameData._playerList,console.log("停止加入房间"),mvs.MsEngine.getInstance.joinOver("joinOver")):console.log("人不够，或者还有人没有准备！")},e.prototype.sendEventResponse=function(t){var e=t.data;if(200!==e.status)return console.log("事件发送失败,status:"+status);var s=GameData.events[e.sequence];s&&s.action===GameData.gameStartEvent&&(delete GameData.events[e.sequence],this.release(),GameSceneView._gameScene.play(),PcKeyBoardHelper.instance.removeListener(this))},e.prototype.sendEventNotify=function(t){var e=t.data;e&&e.cpProto&&e.cpProto.indexOf(GameData.gameStartEvent)>=0&&(GameData.playerUserIds=GameData._playerList,this.release(),PcKeyBoardHelper.instance.removeListener(this),GameSceneView._gameScene.play())},e.prototype.joinOverResponse=function(t){var s=t.data;if(200===s.status){if(this.btn_leave.visible=!1,e.canClick=!1,PcKeyBoardHelper.instance.removeListener(this),this.group_selected.visible=!1,this.canStartGame&&1==this.num)return this.loadGameSource(),void(GameData.playerUserIds=GameData._playerList);1==App.CurrGameIsAi&&this.loadGameSource()}else console.log("关闭房间失败，回调通知错误码：",s.status);Toast.show(" 设置不允许房间加人 "+(200==s.status?"success":"fail"))},e.prototype.joinOverNotify=function(t){this.loadGameSource();var e=t.data;console.log("userID:"+e.userID+" 关闭房间："+e.roomID+" cpProto:"+e.cpProto),Toast.show(e.userID+" 设置了不允许房间加人")},e.prototype.joinOpenResponse=function(t){var e=t.data;Toast.show(" 设置允许房间加人 "+(200==e.status?"success":"fail"))},e.prototype.joinOpenNotify=function(t){var e=t.data;Toast.show(e.userID+" 设置了允许房间加人")},e.prototype.cancelStart=function(t,e){this.canStartGame=!1},e.prototype.kickPlayerResponse=function(t){var e=t.data;this.cancelStart(e.userID,this._roomID),this.wipePlayerLocation(e.userID,e.owner)},e.prototype.kickPlayerNotify=function(t){var e=t.data;console.info("玩家离开",e),e.userID==GameData.gameUser.id?(this.release(),GameSceneView._gameScene.lobby()):(this.cancelStart(e.userID,this._roomID),this.wipePlayerLocation(e.userID,e.owner))},e.prototype.networkStateNotify=function(t){var e=t.data,s=e.userID;this.cancelStart(s,e.roomID),(e.state=1)?(console.info("玩家断开:"+s),mvs.MsEngine.getInstance.kickPlayer(s,"玩家断线踢掉")):2==e.state?console.info("玩家正在从新连接..."+s):(console.info("玩家离开"+s),this.wipePlayerLocation(e.userID,e.owner))},e.prototype.setRoomPropertynotify=function(t){var e=t.data;console.log("roomProperty = "+e.roomProperty),e.roomProperty===GameData.roomPropertyType.mapB?GameData.roomPropertyValue=GameData.roomPropertyType.mapB:GameData.roomPropertyValue=GameData.roomPropertyType.mapA},e.prototype.setRoomPropertyResponse=function(t){console.log("roomProperty = "+t.data.roomProperty)},e.prototype.CreateVsImg=function(){var t=this;clearInterval(this.set),egret.Tween.get(this.shandian).to({alpha:1},1e3),egret.Tween.get(this.v).to({x:this.vX},1e3,egret.Ease.quartOut),egret.Tween.get(this.s).to({x:this.sX},1e3,egret.Ease.quartOut).wait(300).call(function(){GameData.isRoomOwner?t.notifyGameStart():1==App.CurrGameIsAi&&GameSceneView._gameScene.play()})},e.prototype.loadGameSource=function(){var t=this;egret.Tween.get(this.player1LoadingMask).to({width:this.player1Loading.width},1e3),egret.Tween.get(this.player2LoadingMask).to({width:this.player1Loading.width},1e3).call(function(){t.CreateVsImg()});var e=0;setInterval(function(){100>e&&(e+=10,t.player2loadingtxt.text=e.toString()+"%",t.player1loadingtxt.text=e.toString()+"%")},100)},e.prototype.LoadeAvatar=function(t,e){var s=new egret.ImageLoader;s.crossOrigin="anonymous",s.load(t),s.once(egret.Event.COMPLETE,function(t){if(t.currentTarget.data){var s=new egret.Texture;s.bitmapData=t.currentTarget.data;var i=new egret.Bitmap(s);i.width=i.height=100,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,e.addChild(i),i.name="touxiang",i.x=e.width/2,i.y=e.height/2}},this)},e.prototype.createQRCode=function(){this.shp=new egret.Shape,this.shp.graphics.beginFill(16777215,1),this.shp.graphics.drawRect(0,0,this.playerbg1_group.height/4*3,this.playerbg1_group.height/4*3),this.shp.anchorOffsetX=this.shp.width/2,this.shp.anchorOffsetY=this.shp.height/2,this.shp.graphics.endFill(),this.shp.x=this.qrcodebg.x,this.shp.y=this.playerbg1_group.height/2-20,this.playerbg1_group.addChild(this.shp);var t=window.location.host;this.sprite=qr.QRCode.create("http://"+t+"/index.html?"+GameData.roomID,50,this.shp.width,this.shp.height),console.log("http://"+t+"/index.html?roomid="+GameData.roomID),console.log(this.qrcodebg.anchorOffsetX,this.qrcodebg.anchorOffsetY+"}}}}}}}}}}}}}}}}}}}}}}}}}}"),this.sprite.anchorOffsetX=this.sprite.width/2,this.sprite.anchorOffsetY=this.sprite.height/2,this.playerbg1_group.addChild(this.sprite),this.sprite.x=this.qrcodebg.x,this.sprite.y=this.shp.y,this.saomatip.y=this.shp.y+this.shp.height/2,this.saomatip.visible=!0},e.prototype.GameAI=function(){console.log("匹配5s"),App.CurrGameIsAi=!0,mvs.MsEngine.getInstance.joinOver("joinOver");var t=new GameUser;t.id="12138",t.name="游客12138",t.avatar="resource/assets/egret_icon.png",t.tableID=2,t.isOwner=!1,GameData._playerList.push(t),this.showPlayer(t)
},e.joinFlag=0,e.canClick=!0,e}(eui.Component);__reflect(match.prototype,"match",["eui.UIComponent","egret.DisplayObject"]);var PcKeyBoardHelper=function(){function t(){this.isListening=!1,this.list={}}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.add=function(){0==this.isListening&&(this.isListening=!0,document.addEventListener("keydown",t.instance.onKeyDown))},t.prototype.onKeyDown=function(e){console.log("evt.keyCode:"+e.keyCode);var s;for(s in t.instance.list){var i=t.instance.list[s];i.callback.call(i.target,e)}},t.prototype.addListener=function(e,s){var i=egret.getQualifiedClassName(s);if(null==t._instance.list[i]){var n=new KeyVo(i,s,e);t._instance.list[n.name]=n}t._instance.add()},t.prototype.removeListener=function(e){var s=egret.getQualifiedClassName(e);null!=t._instance.list[s]&&delete t._instance.list[s],this.checkCount()},t.prototype.checkCount=function(){for(var e in t._instance.list)return;document.removeEventListener("keydown",t.instance.onKeyDown),this.isListening=!1},t}();__reflect(PcKeyBoardHelper.prototype,"PcKeyBoardHelper");var KeyVo=function(){function t(t,e,s){this.name="",this.name=t,this.target=e,this.callback=s}return t}();__reflect(KeyVo.prototype,"KeyVo");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,s,i){function n(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),s.call(i))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(i,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LanguageType=function(){function t(){}return t.En="_En",t.Ch="",t}();__reflect(LanguageType.prototype,"LanguageType");var App=function(){function t(){}return Object.defineProperty(t,"MessageCenter",{get:function(){return MessageCenter.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TimerManager",{get:function(){return TimerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResourceUtils",{get:function(){return ResourceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DisplayUtils",{get:function(){return DisplayUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GameWidth",{get:function(){return t.StageUtils.getWidth()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GameHeight",{get:function(){return t.StageUtils.getHeight()},enumerable:!0,configurable:!0}),t.Proto=null,t.Language=LanguageType.Ch,t.UserToken="",t.CurrChatId="",t.CurrGameId=1,t.CurrGameIsAi=!1,t.CurrGameAiLevel=3,t.CurrRoomId="",t.CurrPlatformUid="",t}();__reflect(App.prototype,"App");var DBArmature=function(t){function e(e){var s=t.call(this)||this;return s._displayEvents=[],s._armature=e,s._armatureDisplay=e.display,s.dealClock(s),s.addChild(s._armatureDisplay),s}return __extends(e,t),e.prototype.dealClock=function(t){var e=this,s=t.$onAddToStage.bind(t);t.$onAddToStage=function(t,i){s(t,i),e.$addToClock()};var i=t.$onRemoveFromStage.bind(t);t.$onRemoveFromStage=function(){i(),e.$removeFromClock()}},e.prototype.addToClock=function(t){this._curClock||(this._curClock=t,this._curClock.add(this._armature))},e.prototype.$addToClock=function(){this.addToClock(dragonBones.EgretFactory.factory.clock)},e.prototype.$removeFromClock=function(){this._curClock&&(this._curClock.remove(this._armature),this._curClock=null)},e.prototype.getRunDbNum=function(){var t=dragonBones.EgretFactory.factory.clock._animatebles,e={};return t.forEach(function(t){if(t){var s=t.armatureData.name;e[s]||(e[s]=0),e[s]++}}),JSON.stringify(e)},e.prototype.gotoAndStop=function(t){this._currAction=t,this._armature.animation.gotoAndStopByFrame(t)},e.prototype.gotoAndStopByTime=function(t,e){this._currAction=t,this._armature.animation.gotoAndStopByTime(t,e)},e.prototype.gotoAndStopByProgress=function(t,e){this._currAction=t,this._armature.animation.gotoAndStopByProgress(t,e)},e.prototype.play=function(t,e){return void 0===e&&(e=0),this._currAction=t,this._armature.animation.play(t,e)},Object.defineProperty(e.prototype,"currAction",{get:function(){return this._currAction},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this._armature.animation.stop()},e.prototype.replaceSlot=function(t,e){var s=this._armature.getSlot(t);s&&(s.display=e)},e.prototype.replaceTexture=function(t){this._armature.replaceTexture(t)},e.prototype.replaceSkin=function(t){AssetManager.dbFactory.replaceSkin(this._armature,t)},Object.defineProperty(e.prototype,"armatureName",{get:function(){return this._armature.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._armature.animation.timeScale},set:function(t){this._armature&&(this._armature.animation.timeScale=t)},enumerable:!0,configurable:!0}),e.prototype.getSlot=function(t){return this._armature.getSlot(t)},e.prototype.getBone=function(t){return this._armature.getBone(t)},e.prototype.once=function(t,e,s){this._armatureDisplay.once(t,e,s)},e.prototype.addDisplayEvent=function(t,e,s){this._armatureDisplay.addEvent(t,e,s),this._displayEvents.push([t,e,s])},e.prototype.removeDisplayEvent=function(t,e,s){this._armatureDisplay.removeEvent(t,e,s)},e.prototype.removeAllDisplayEvent=function(){for(;this._displayEvents.length;){var t=this._displayEvents.pop();this.removeDisplayEvent(t[0],t[1],t[2])}},e.prototype.dispose=function(){this._armature&&(AssetManager.removeCacheArmature(this),this.$removeFromClock(),this.removeAllDisplayEvent(),egret.Tween.removeTweens(this),this._armature.dispose(),this._armature=null,this._armatureDisplay=null)},e}(egret.DisplayObjectContainer);__reflect(DBArmature.prototype,"DBArmature");var DBProgress=function(t){function e(e){var s=t.call(this)||this;return s._armature=e,s._armature.gotoAndStop("progress"),s.addChild(s._armature),s}return __extends(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(t){this._progress=t,this._progress>1&&(this._progress=1),this._progress<0&&(this._progress=0),this._armature.gotoAndStopByProgress("progress",this._progress)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(DBProgress.prototype,"DBProgress");var GameData=function(){function t(){}return t.init=function(){this.isGameOver=!0,this.isRoomOwner=!1,this.syncFrame=!1,this.number1="",this.number2="",this.number3="",this.roomID="",this.intervalList=[],this.playerUserIds=[],this.roomPropertyValue=this.roomPropertyType.mapA},t.configEnvir=function(e,s){t.CHANNEL=e,t.DEFAULT_ENV=s?t.ENVIRONMENT.dev:t.ENVIRONMENT.pro,"MatchVS"===e&&(t.gameID=201150,t.appkey="0db8550d9bd345da82b852564f59d2e6",t.secretKey="15bf7e1bc2454d21b071d67f568e257c"),"MatchVS-Test"===e&&(t.gameID=201170,t.appkey="a5b937f29a4c480bb6946093105c0565",t.secretKey="a8c5c84afde44136a5eea6f0ac09887c"),"MatchVS-Test1"===e&&(t.gameID=201078,t.appkey="938e1ee0db444a079fe0695598677ba0",t.secretKey="9b11e0eca09141a1961d49d6b6028075")},t.getBindOpenIDAddr=function(t,e){if("MatchVS"==t||"Matchvs"==t){if("release"==e)return"http://vsuser.matchvs.com/wc6/thirdBind.do?";if("alpha"==e)return"http://alphavsuser.matchvs.com/wc6/thirdBind.do?"}else if("MatchVS-Test1"==t){if("release"==e)return"http://zwuser.matchvs.com/wc6/thirdBind.do?";if("alpha"==e)return"http://alphazwuser.matchvs.com/wc6/thirdBind.do?"}},t.getSign=function(e){var s=t.appkey+"&"+e+"&"+t.secretKey;console.info("待签名："+s);var i=(new MD5).hex_md5(s);return i},t.CHANNEL="MatchVS",t.DEFAULT_ENV="release",t.ENVIRONMENT={dev:"alpha",pro:"release"},t.gameID=202469,t.appkey="d9de1c66d3ab446c9b6e9a7d687649ae#E",t.secretKey="a0aca80d3f6a4168b3458e19e58eee14",t.gameUser=new GameUser,t.playerUserIds=[],t.matchType=0,t.randomMatch=1,t.specialMatch=2,t.tagsMatch=3,t.maxPlayerNum=2,t.isRoomOwner=!1,t._playerList=[],t.isCreateRoom=!1,t.gameStartEvent="gameStart",t.gameOverEvent="gameOver",t.playerPositionEvent="playerPosition",t.reconnectStartEvent="gameReconnectStart",t.newStarEvent="newStar",t.changeStarEvent="changeStar",t.gameReadyEvent="gameReady",t.reconnectReadyEvent="gameReconnectReady",t.events={},t.syncFrame=!1,t.isGameOver=!1,t.starPositionX=0,t.starPositionY=0,t.frameRate=20,t.defaultHeight=400,t.roomID="",t.isSaoMaEnter=!1,t.intervalList=[],t.number1="",t.number2="",t.number3="",t.playerTime=60,t.roomPropertyType={mapA:"mapA",mapB:"mapB"},t.roomPropertyValue="mapA",t.createRoomInfo=new MsCreateRoomInfo("MatchvsDemoEgret",2,0,0,1,"mapA"),t}();__reflect(GameData.prototype,"GameData");var gameLoading=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.img.texture=RES.getRes("loading_png"),this.addChild(this.img),this.img.scaleX=0,RES.loadGroup("preload"),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,function(){},this)},e.prototype.onProgress=function(t,e){this.scaleX=t/e},e}(egret.Sprite);__reflect(gameLoading.prototype,"gameLoading");var GameKingkong=function(t){function e(){var e=t.call(this)||this;return e.masterScore=0,e._uiContainer=new egret.DisplayObjectContainer,e._progress1=new DBProgress(AssetManager.getDBArmature("progress1")),e._progress2=new DBProgress(AssetManager.getDBArmature("progress2")),GameSceneView._gameScene.gameResult(1),e}return __extends(e,t),e.prototype.KeyBoardMethod=function(t){e.canClick&&(38==t.keyCode?this._sceneLeft.touchRight():13==t.keyCode&&this._sceneLeft.touchLeft())},e.prototype.init=function(){t.prototype.init.call(this),PcKeyBoardHelper.instance.addListener(this.KeyBoardMethod,this),mvs.MsEngine.getInstance.setFrameSync(GameData.frameRate),this.bg="bg_jpg",this.background.height>App.GameHeight&&(this.background.height=App.GameHeight,this.background.anchorOffsetY=this.background.height/2,this.background.y=App.GameHeight/2),App.GameHeight>this.background.height&&(this.background.height=App.GameHeight,this.background.anchorOffsetY=this.background.height/2,this.background.y=App.GameHeight/2);var e=AssetManager.getBitmap("blackMask_png",!1,!1);e.width=e.height=App.GameWidth,e.anchorOffsetY=e.height,e.y=(App.GameHeight-this.background.height)/2;var s=AssetManager.getBitmap("blackMask_png",!1,!1);s.width=s.height=App.GameWidth,s.y=App.GameHeight-(App.GameHeight-this.background.height)/2,this._sceneLeft=new KingkongScene(this.background.width,this.background.height,!0),this._sceneRight=new KingkongScene(this.background.width,this.background.height),App.SoundManager.playBg("kingkongBgMusic_mp3"),App.CurrGameIsAi?this._sceneRight.mode=KingkongScene.MODE_AI:this._sceneRight.mode=KingkongScene.MODE_NET,this._sceneRight.self=!1,this._sceneRight.scaleX=-1,this._sceneRight.scaleY=-1,this._sceneRight.x=this.background.width,this._sceneRight.y=this.background.height+(App.GameHeight-this.background.height)/2,this._uiContainer.width=this.background.width,this._uiContainer.height=this.background.height,this._uiContainer.anchorOffsetY=this._uiContainer.height/2,this._uiContainer.anchorOffsetX=this._uiContainer.width/2,this._uiContainer.x=App.GameWidth/2,this._uiContainer.y=App.GameHeight/2,this._conBitmap=AssetManager.getBitmap("spaceBg_png",!1,!1),this._conBitmap.width=App.GameWidth,this._conBitmap.height=App.GameHeight,this.addChild(this._conBitmap),this._sceneLeft.y=(App.GameHeight-this.background.height)/2,this.addChild(this._sceneRight),this.addChild(this._sceneLeft),this.addChild(this._uiContainer),this._progress1.x=this.background.width,this._progress1.y=this.background.height/2,this._progress1.rotation=90,this._progress2.x=this.background.width,this._progress2.y=this.background.height/2,this._progress2.rotation=90,this._uiContainer.addChild(this._progress2),this._uiContainer.addChild(this._progress1);var i=AssetManager.getBitmap("mask_png");i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height,i.x=this._progress1.x-5,i.y=this._progress1.y-280,this._uiContainer.addChild(i);var n=AssetManager.getBitmap("mask_png");n.anchorOffsetX=n.width/2,n.anchorOffsetY=0,n.x=this._progress1.x-5,n.y=this._progress1.y+280,this._uiContainer.addChild(n);var o=AssetManager.getBitmap("winLine_jpg");o.anchorOffsetX=o.width/2,o.anchorOffsetY=0,o.x=this._progress1.x+1,o.y=this._progress1.y-270,this._uiContainer.addChild(o),this.addChild(e),this.addChild(s),this._conBitmap.touchEnabled=!0,this._conBitmap.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._sceneLeft.addEventListener(Kingkong.EVENT_SHOOT,this.onLeftShoot,this),this._sceneRight.addEventListener(Kingkong.EVENT_SHOOT,this.onRightShoot,this),this._sceneLeft.addEventListener(Kingkong.EVENT_WIN,this.onLeftWin,this),this._sceneRight.addEventListener(Kingkong.EVENT_WIN,this.onRightWin,this),this._sceneLeft.addEventListener(Kingkong.EVENT_GAME_START,this.onGameStart,this),this._sceneLeft.addEventListener(Kingkong.EVENT_GAME_OVER,this.onGameOver,this),this._sceneRight.addEventListener(Kingkong.EVENT_GAME_OVER,this.onGameOver,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_BOOM,this.onMasterEvent,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_GET_BANANA,this.onMasterEvent,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_GET_BOOM,this.onMasterEvent,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_JUMP,this.onMasterEvent,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_SHOOT,this.onMasterEvent,this),this._sceneLeft.addEventListener(KingkongScene.EVENT_SHOOT_GROUND,this.onMasterEvent,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.onGameEvent,this)},e.prototype.onMasterEvent=function(t){var e=[];if(GameData.playerUserIds.forEach(function(t){e.push(t.id)}),this._sceneRight.mode==KingkongScene.MODE_NET){t.data;switch(t.type){case KingkongScene.EVENT_BOOM:mvs.MsEngine.getInstance.sendEvent("boom");break;case KingkongScene.EVENT_GET_BANANA:mvs.MsEngine.getInstance.sendEvent("getBanana");break;case KingkongScene.EVENT_GET_BOOM:mvs.MsEngine.getInstance.sendEvent("getBoom");break;case KingkongScene.EVENT_JUMP:mvs.MsEngine.getInstance.sendEvent("jump");break;case KingkongScene.EVENT_SHOOT:mvs.MsEngine.getInstance.sendEvent("shoot");break;case KingkongScene.EVENT_SHOOT_GROUND:}}},e.prototype.onGameEvent=function(t){var e=t.data;switch(e.cpProto){case"getBoom":this._sceneRight.kingkongGetBoom();break;case"getBanana":this._sceneRight.kingkongGetBanana();break;case"boom":this._sceneRight.kingkongHit();break;case"jump":this._sceneRight.kingkongJump();break;case"shoot":this._sceneRight.kingkongShoot()}},e.prototype.stop=function(){this.isStop||(egret.stopTick(this.tick,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.onGameEvent,this),this.isStop=!0,this._progress1.progress=0,this._progress2.progress=0,this._sceneLeft.dispose(),this._sceneRight.dispose())},e.prototype.onGameOver=function(t){this.stop(),App.CurrGameIsAi?GameSceneView._gameScene.gameResult(this._win):GameSceneView._gameScene.gameResult(this._win),this.dispose()},e.prototype.onGameResult=function(t){"1"===t.data.cpProto&&(console.log("masterWIN"),this.addChild(new GameResultView(1))),"3"===t.data.cpProto&&(console.log("shadiaoWIN"),this.addChild(new GameResultView(3)))},e.prototype.onGameStart=function(t){var e=this;this._win=1,this._sceneRight.startRun(),egret.startTick(this.tick,this),this._sceneLeft.gameStart&&(this.Interval_100ms=setInterval(function(){e.masterScore+=.1},this,100))},e.prototype.onLeftWin=function(t){this._win=1;var e=this.masterScore.toFixed(1);GameData.gameUser.curscore=Number(e),clearInterval(this.Interval_100ms),this._sceneRight.fail()},e.prototype.onRightWin=function(t){this._win=3,this._sceneLeft.fail()},e.prototype.onLeftShoot=function(t){this._sceneLeft.fireBoom(this._sceneRight.addBoom)},e.prototype.onRightShoot=function(t){this._sceneRight.fireBoom(this._sceneLeft.addBoom)},e.prototype.onTouchBegin=function(t){t.stageX<this.background.width/2?t.stageY>this.background.height/4?this._sceneLeft.touchLeft():this._sceneRight.mode==KingkongScene.MODE_MANUAL&&this._sceneRight.touchRight():t.stageY>this.background.height/4?this._sceneLeft.touchRight():this._sceneRight.mode==KingkongScene.MODE_MANUAL&&this._sceneRight.touchLeft()},e.prototype.tick=function(t){return this._sceneLeft.gameStart&&(this._progress2&&(this._progress2.progress=this._sceneLeft.progress),this._progress1&&(this._progress1.progress=this._sceneRight.progress)),!0},e.prototype.dispose=function(){e.canClick=!1,PcKeyBoardHelper.instance.removeListener(this),this._conBitmap.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._sceneLeft.removeEventListener(Kingkong.EVENT_SHOOT,this.onLeftShoot,this),this._sceneRight.removeEventListener(Kingkong.EVENT_SHOOT,this.onRightShoot,this),this._sceneLeft.removeEventListener(Kingkong.EVENT_WIN,this.onLeftWin,this),this._sceneRight.removeEventListener(Kingkong.EVENT_WIN,this.onRightWin,this),this._sceneLeft.removeEventListener(Kingkong.EVENT_GAME_START,this.onGameStart,this),this._sceneRight.removeEventListener(Kingkong.EVENT_GAME_START,this.onGameStart,this),this._sceneLeft.dispose(),this._sceneRight.dispose(),ObjectPool.clearClass("KingkongItem")},e.canClick=!0,e}(StateBG);__reflect(GameKingkong.prototype,"GameKingkong");var GameResultView=function(t){function e(e){var s=t.call(this)||this;return s.particlesArr=[],s.isAgain=!1,s.curSelect=1,s.isAgain=!1,0==match.joinFlag||1==match.joinFlag||GameData.isSaoMaEnter?mvs.MsEngine.getInstance.leaveRoom("bye"):GameData.isCreateRoom&&mvs.MsEngine.getInstance.joinOpen("加入吧"),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,s.leaveRoomResponse,s),s.skinName="resource/mySkins/GameResultSkin.exml",s.winNumber=e,s.addEventListener(eui.UIEvent.CREATION_COMPLETE,s.onComplete,s),PcKeyBoardHelper.instance.addListener(s.KeyBoardMethod,s),s.init(),s}return __extends(e,t),e.prototype.init=function(){this.y=this.height,egret.Tween.get(this).to({y:0},1e3,egret.Ease.backInOut)},e.prototype.KeyBoardMethod=function(t){var t=event||window.event||arguments[0];if(e.canClick&&(40==t.keyCode&&(this.group_selected.getChildAt(this.curSelect).visible=!0),(37==t.keyCode||39==t.keyCode)&&(this.group_selected.getChildAt(this.curSelect).visible=!1,this.curSelect=0==this.curSelect?1:0,this.group_selected.getChildAt(this.curSelect).visible=!0),13==t.keyCode))switch(this.curSelect){case 0:this.onLevelClick(),this.curSelect=1;break;case 1:this.onAgaginClick()}},e.prototype.onComplete=function(){this.height=this.stage.stageHeight,this.btn_again.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onAgaginClick,this),this.btn_leave.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onLevelClick,this),this.showResult()},e.prototype.onLevelClick=function(){PcKeyBoardHelper.instance.removeListener(this),this.dispose(),match.joinFlag=0,e.canClick=!1,mvs.MsEngine.getInstance.leaveRoom("zoule"),GameSceneView._gameScene.lobby()},e.prototype.showResult=function(){for(var t=0;t<GameData._playerList.length;t++)GameData._playerList[t].isOwner?this.lab_otherName.text=GameData._playerList[t].name:this.lab_masterName.text=GameData._playerList[t].name;3==this.winNumber?(this.img_result1.source="loseBG_png",this.img_result2.source="winBG_png",this.onParticleEffect(this.gp_particle.width/2+400,this.gp_particle.height/2,"hua"),this.onParticleEffect(this.gp_particle.width/2-400,this.gp_particle.height/2,"falisnow")):1==this.winNumber&&(this.checkMaxScore(),this.img_result1.source="winBG_png",this.img_result2.source="loseBG_png",this.onParticleEffect(this.gp_particle.width/2-400,this.gp_particle.height/2,"hua"),this.onParticleEffect(this.gp_particle.width/2+400,this.gp_particle.height/2,"falisnow")),this.addPerson()},e.prototype.checkMaxScore=function(){GameData.gameUser.curscore>GameData.gameUser.maxScore&&(this.onParticleEffect(0,0,"flowers"),GameData.gameUser.maxScore=GameData.gameUser.curscore)},e.prototype.onAgaginClick=function(){this.dispose(),PcKeyBoardHelper.instance.removeListener(this),e.canClick=!1,1==GameData.isCreateRoom?GameSceneView._gameScene.match(3):0==match.joinFlag?GameSceneView._gameScene.match(0):GameData.isSaoMaEnter?GameSceneView._gameScene.match(4):1==match.joinFlag&&GameSceneView._gameScene.match(1)},e.prototype.leaveRoomResponse=function(t){var e=t.data;200!==e.status?console.log("退出房间失败！status="+e.status):mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this)},e.prototype.onParticleEffect=function(t,e,s,i,n){void 0===i&&(i=-1),void 0===n&&(n=1);var o=RES.getRes(s+"_png"),r=RES.getRes(s+"_json"),a=new particle.GravityParticleSystem(o,r);if(this.particlesArr.push(a),a.y=e,a.x=t,a.scaleX=n,"flowers"==s?(this.group_flower.addChild(a),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2):this.gp_particle.addChild(a),a.start(i),"hua"==s)for(var h=2;7>h;h++){s="hua"+h;var o=RES.getRes(s+"_png"),r=RES.getRes("hua_json"),a=new particle.GravityParticleSystem(o,r);this.particlesArr.push(a),a.y=e,a.x=t,a.scaleX=n,this.gp_particle.addChild(a),a.start(i)}},e.prototype.addPerson=function(){this.roleAvatar1=this.createAvatar(this.gp_people1,!0),this.roleAvatar2=this.createAvatar(this.gp_people2,!1);GameData.gameUser;this.addDBresult(),this.dbResult1.visible=!0,this.dbResult2.visible=!0,1==this.winNumber?(this.dbResult1.play("win",1),this.dbResult2.play("loser",1),this.roleAvatar1.armature.play("win"),this.roleAvatar2.armature.play("Loser2"),App.SoundManager.playEffect("win_mp3")):3==this.winNumber&&(this.dbResult2.play("win",1),this.dbResult1.play("loser",1),this.roleAvatar2.armature.play("win"),this.roleAvatar1.armature.play("Loser2"),App.SoundManager.playEffect("lose_mp3"),App.SoundManager.muteBg())},e.prototype.createAvatar=function(t,e){t.removeChildren();var s,i;if(e)i=GameData.gameUser;else for(var n=0;n<GameData._playerList.length;n++)GameData._playerList[n].id!=GameData.gameUser.id&&(i=GameData._playerList[n]);return s=new RoleAvatar(i.curAvatarType,i.avatar),s.armature.x=.5*t.width,s.armature.y=t.height,t.addChild(s.armature),s},e.prototype.addDBresult=function(){this.dbResult1=AssetManager.getQuickDBArmature("winloser"),this.dbResult2=AssetManager.getQuickDBArmature("winloser"),this.gp_wenzi.addChild(this.dbResult1),this.gp_wenzi.addChild(this.dbResult2),this.dbResult1.x=this.gp_wenzi.width/2-400,this.dbResult2.x=this.gp_wenzi.width/2+400,this.dbResult1.y=this.gp_wenzi.height/2-100,this.dbResult2.y=this.gp_wenzi.height/2-100,this.dbResult1.addDisplayEvent(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onPlayResultComplete,this),this.dbResult1.visible=!1,this.dbResult2.visible=!1},e.prototype.onPlayResultComplete=function(){var t=this;this.dbResult1.visible=!1,this.dbResult2.visible=!1,setTimeout(function(){for(var e=0;e<t.particlesArr.length;e++)t.particlesArr[e].stop()},5e3)},e.prototype.dispose=function(){this.dbResult1.dispose(),this.dbResult2.dispose(),this.roleAvatar1.dispose(),this.roleAvatar2.dispose()},e.canClick=!0,e}(eui.Component);__reflect(GameResultView.prototype,"GameResultView");var KingkongScene=function(t){function e(e,s,i,n){void 0===i&&(i=!1),void 0===n&&(n=null);var o=t.call(this)||this;o._totalDistance=35570,o._curItemConfigs=[],o._curItems=[],o._kingkongPosMinY=1521,o._kingkongPosMaxY=1900,o._fastLastTime=3,o.self=!0,o._kingkongOffsetY=65,o._kingkongOffsetX=240,o._curLevel=1,o._invincibleTime=0,o.progress=0,o.fireBoom=function(t){var e=ObjectPool.pop(KingkongItem,"KingkongItem");e.type=KingkongItem.TYPE_FIRE_BOOM,e.x=0,o.master?(e.y=o.stageWidth-o._kingkong.x,App.SoundManager.playEffect("renglei2_mp3",!0)):(e.y=o.stageWidth-o._kingkong.x,App.SoundManager.playEffect("renglei_mp3",!0)),o._itemContainer.addChild(e);var s=egret.Tween.get(e);s.to({x:-o.stageHeight/3,scaleX:2,scaleY:2,rotation:90},250),s.to({x:-o.stageHeight+100,scaleX:1,scaleY:1,rotation:180},250),s.call(function(){e.parent&&e.parent.removeChild(e),t()})},o.addBoom=function(){var t=ObjectPool.pop(KingkongItem,"KingkongItem");t.type=KingkongItem.TYPE_FIRE_BOOM,t.x=0,o.master?t.y=o._kingkongOffsetY:t.y=o._kingkongOffsetY,o._itemContainer.addChild(t),o.addBoomComplete(t)},o.master=i,o.stageWidth=e,o.stageHeight=s,o.addEventListener(egret.Event.ADDED_TO_STAGE,o.onAdded,o),o._building=new Building,o._kingkong=new Kingkong(i),o._itemContainer=new egret.DisplayObjectContainer,n?o._uiContainer=n:o._uiContainer=new egret.DisplayObjectContainer,o.btnJump=AssetManager.getDBArmature("tiaoyue"),o.btnShoot=AssetManager.getDBArmature("renglei"),o._tip=AssetManager.getDBArmature("tishi");var r=GameData.gameUser;if(o.master)r=GameData.gameUser;else{for(var a=0;a<GameData._playerList.length;a++)GameData._playerList[a].id!=GameData.gameUser.id&&(r=GameData._playerList[a]);r.curAvatarType=2}return o._avatar=new RoleAvatar(r.curAvatarType,r.avatar).armature,o._chain=AssetManager.getBitmap("chain_png"),o}return __extends(e,t),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t,this._mode==e.MODE_AI&&this.initAI(AIKingkong.AI_LEVEL_3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameStart",{get:function(){return this._gameStart},enumerable:!0,configurable:!0}),e.prototype.addTip=function(){var t=this;this._tip&&(this._tip.play("tishi2",0),this.tipFlag=setTimeout(function(){t.removeTip()},2e3),this._tip.x=this.btnJump.x,this._tip.y=this.btnJump.y,this._uiContainer.addChild(this._tip))},e.prototype.removeTip=function(){this._tip&&this._tip.parent&&(this._tip.stop(),this._tip.parent.removeChild(this._tip),clearTimeout(this.tipFlag),this.tipFlag=void 0)},e.prototype.onAdded=function(t){this.init()},e.prototype.dispose=function(){App.TimerManager.remove(this.advanceTime,this),this.removeAllItems(),this._itemContainer.removeChildren(),this.tipFlag&&clearTimeout(this.tipFlag)},e.prototype.init=function(){var t=RES.getRes("levelConfig_json").level[this._curLevel];this._curItemConfigs=t.concat(),this._building.rotation=90,this._building.x=0,this._building.y=this.stageHeight,this.addChild(this._building),this._building.stop(),this._avatar.rotation=90,this._avatar.x=this.stageWidth/2-250,this._avatar.y=this.stageHeight/2,this._avatar.scaleX=this._avatar.scaleY=.7,this.addChild(this._avatar),this._chain.x=this._avatar.x,this._chain.y=this._avatar.y,this._chain.scaleX=this._chain.scaleY=.7,this.addChild(this._chain),this._uiContainer.x=0,this._uiContainer.y=0,this.addChild(this._uiContainer),this.btnJump.x=this.btnShoot.x=.5*this.stageWidth,this.btnJump.y=this.btnShoot.y=.5*this.stageHeight,this.addChild(this._itemContainer),this._itemContainer.rotation=90,this._itemContainer.x=this.stageWidth-60,this._itemContainer.y=this.stageHeight-50,this._uiContainer.addChild(this.btnJump),this._uiContainer.addChild(this.btnShoot),this.master||(this.btnJump.visible=!1,this.btnShoot.visible=!1),this._kingkong.x=this._kingkongOffsetX,this._kingkong.y=this.stageHeight-this._kingkongOffsetY,this._kingkong.rotation=90,this._kingkongPosY=this.stageWidth-this._kingkong.x,this._kingkongPosMaxY=this._kingkongPosY+Kingkong.LEG_LENGTH+KingkongItem.HALF_SIZE,this._kingkongPosMinY=this._kingkongPosY-Kingkong.LEG_LENGTH-KingkongItem.HALF_SIZE,this.addChild(this._kingkong),this._kingkong.stand(),this._totalDistance=this.configToD(this._curItemConfigs[this._curItemConfigs.length-1].d)+this.stageWidth-320,console.log(this._totalDistance),this._mode==e.MODE_AI&&this.initAI(AIKingkong.AI_LEVEL_3),this.master&&this.preStart(),App.TimerManager.doTimer(1,0,this.advanceTime,this)},e.prototype.initAI=function(t){this._mode==e.MODE_AI&&(null==this._ai&&(this._ai=new AIKingkong,this._ai.addEventListener(Kingkong.EVENT_SHOOT,this.onAIShoot,this),this._ai.addEventListener(Kingkong.EVENT_JUMP,this.onAIJump,this)),this._ai.level=t,this._ai.kingkong=this._kingkong,this._ai.curItems=this._curItems)},e.prototype.onAIShoot=function(t){this.touchLeft()},e.prototype.onAIJump=function(t){this.touchRight()},e.prototype.advanceTime=function(t){return this._gameStart&&(this._building.advanceTime(t),this._curTime+=t,this._curDistance=this._building.curDistance,this.addItems(),this.moveItems(),this.removeItems(),this.testHit(),this._fast&&this.checkFast(t),this.checkWin(),this.progress=this._curDistance/this._totalDistance,this._mode==e.MODE_AI&&this._ai.advanceTime(t),this._invincibleTime>0&&(this._invincibleTime-=t)),!0},e.prototype.checkWin=function(){this._curDistance>this._totalDistance&&this.win()},e.prototype.fail=function(){this._kingkong.getBoom(!1),this.btnShoot.play("renglei0",1),this.removeTip(),this.gameOver()},e.prototype.win=function(){var t=this;if(this.key){this.key.x+=this._kingkong.x,this.key.y+=this._kingkong.y,this._uiContainer.addChild(this.key);var e=egret.Tween.get(this.key),s=this._avatar.x-this.key.x,i=this._avatar.y-this.key.y;e.to({x:this.key.x+s/2,y:this.key.y+i/2,scaleX:2,scaleY:2},1e3),e.to({x:this.key.x+s,y:this.key.y+i,scaleX:1,scaleY:1},1e3),e.call(function(){t._avatar.play("win"),t._chain.alpha=0,t.key.x=0,t.removeItem(t.key,0),t.key=null}),e.call(function(){t.dispatchEvent(new egret.Event(Kingkong.EVENT_GAME_OVER))})}this._kingkong.getBoom(!1),this.btnShoot.play("renglei0",1),this.removeTip(),this.dispatchEvent(new egret.Event(Kingkong.EVENT_WIN)),this.gameOver()},e.prototype.gameOver=function(){this._curDistance=0,this._fastLastTime=0,this._building.curDistance=0,this._curTime=0,this._gameStart=!1,this._building.stop(),this._kingkong.stand(),this.removeTip(),this._mode==e.MODE_AI&&this._ai.over(),this.tipFlag&&clearTimeout(this.tipFlag)},e.prototype.checkFast=function(t){this._fastLastTime>0?this._fastLastTime-=t:this.stopFast()},e.prototype.testHit=function(){var t,s,i,n,o;for(t=0,s=this._curItems.length;s>t;t++){if(this._curItems[t].type===KingkongItem.TYPE_WIN)return;if(!(this._curItems[t].type!=KingkongItem.TYPE_KEY&&this._curItems[t].y>this._kingkongPosMinY))break;if(this._curItems[t].y<this._kingkongPosMaxY&&!this._kingkong.onAir()&&!this._kingkong.invincible){o=this._curItems[t],i=!0,n=this._curItems[t].type,this.removeItem(o,t);break}}if(i&&this.mode!=e.MODE_NET)switch(n){case KingkongItem.TYPE_BANANA:this.kingkongGetBanana();break;case KingkongItem.TYPE_BOOM:this.kingkongGetBoom();break;case KingkongItem.TYPE_FIRE_BOOM:this._invincibleTime<=0&&(this.kingkongHit(),this._invincibleTime=e.INVINCIBLE_TIME)}},e.prototype.stopFast=function(){this._fast=!1,this._building.runNormal(),this._kingkong.runNormal()},e.prototype.kingkongGetBanana=function(){this.master&&this.dispatchEvent(new egret.Event(e.EVENT_GET_BANANA,!1,!1,this._curDistance)),this._fast=!0,this._slow=!1,App.SoundManager.playEffect("banana_mp3",!0),this._fastLastTime=e.FAST_TIME,this._building.runFast(),this._kingkong.runFast(),this._avatar.play("chi",1)},e.prototype.kingkongGetBoom=function(){this.master&&this.dispatchEvent(new egret.Event(e.EVENT_GET_BOOM,!1,!1,this._curDistance)),this._kingkong.getBoom(!0),this.btnShoot.play("renglei1",1),this.master&&!this.tipFlag&&this.addTip()},e.prototype.kingkongRecover=function(){this._slow=!1,this._fast=!1,this._building.runNormal(),this._kingkong.runNormal(),this._kingkong.removeEventListener(Kingkong.EVENT_RECOVER,this.onKingkongRecover,this)
},e.prototype.onKingkongRecover=function(t){this.kingkongRecover()},e.prototype.kingkongHit=function(){this.master&&this.dispatchEvent(new egret.Event(e.EVENT_BOOM,!1,!1,this._curDistance)),this._slow=!0,this._fast=!1,this._building.runSlow(),this._kingkong.runSlow(),this._kingkong.getBoom(!1),this.removeTip(),App.SoundManager.playEffect("kingkongBoom_mp3",!0),this.btnShoot.play("renglei0",1),this._kingkong.addEventListener(Kingkong.EVENT_RECOVER,this.onKingkongRecover,this),this._kingkong.playHit(),this._avatar.play("zha",1)},e.prototype.disToConfig=function(t){return(this._curDistance-t)/100},e.prototype.configToD=function(t){return 100*t},e.prototype.addBoomComplete=function(t){t.pos=this.disToConfig(t.y),this.master||this.dispatchEvent(new egret.Event(e.EVENT_SHOOT_GROUND,!1,!1,t.pos)),this._lastAddedBoom=t;var s,i,n;for(s=0,i=this._curItems.length;i>s;s++)if(this._curItems[s].pos>t.pos){this._curItems.splice(s,0,t),n=!0;break}n||this._curItems.push(t)},e.prototype.addItems=function(){if(this._curItemConfigs.length>0)for(var t=this._curItemConfigs[0].d,e=this._curItemConfigs[0].t,s=this.configToD(t);s<this._curDistance;){this._curItemConfigs.shift();var i=ObjectPool.pop(KingkongItem,"KingkongItem");if(i.x=0,i.type=e,i.pos=t,i.type==KingkongItem.TYPE_KEY&&(this.key=i),this._itemContainer.addChild(i),this._curItems.push(i),!(this._curItemConfigs.length>0)){s=Number.MAX_VALUE;break}t=this._curItemConfigs[0].d,e=this._curItemConfigs[0].t,s=this.configToD(t)}},e.prototype.moveItems=function(){var t,e,s;for(t=0,e=this._curItems.length;e>t;t++)s=this._curItems[t],s.y=this._curDistance-this.configToD(s.pos)},e.prototype.removeItem=function(t,e){ObjectPool.push(t),this._curItems.splice(e,1),t.parent&&t.parent.removeChild(t)},e.prototype.removeItems=function(){var t,e,s;for(t=0,e=this._curItems.length;e>t;t++)s=this._curItems[t],s.y>this.stageWidth&&s.type!=KingkongItem.TYPE_KEY&&(ObjectPool.push(s),this._curItems.splice(t,1),t--,e--,s.parent&&s.parent.removeChild(s))},e.prototype.removeAllItems=function(){var t,e,s;for(t=0,e=this._curItems.length;e>t;t++)s=this._curItems[t],ObjectPool.push(s),this._curItems.splice(t,1),t--,e--,s.parent&&s.parent.removeChild(s)},e.prototype.touchLeft=function(){this._kingkong.hasBoom&&this.kingkongShoot()},e.prototype.touchRight=function(){this._kingkong.jumpEnable()&&this.kingkongJump()},e.prototype.kingkongJump=function(){console.log(this.master),this.master&&this.dispatchEvent(new egret.Event(e.EVENT_JUMP,!1,!1,this._curDistance)),this._kingkong.jump(),App.SoundManager.playEffect("kingkongjump_mp3",!0),this.btnJump.play("tiaoyue",1),e.touched=!0},e.prototype.kingkongShoot=function(){var t=this,s=this;this.master&&s.dispatchEvent(new egret.Event(e.EVENT_SHOOT,!1,!1,this._curDistance));var i=function(){t.btnShoot.removeDisplayEvent(dragonBones.EventObject.COMPLETE,i,t),t.btnShoot.play("renglei0",1)};this.btnShoot.addDisplayEvent(dragonBones.EventObject.COMPLETE,i,this),this.btnShoot.play("renglei2",1),this._kingkong.getBoom(!1),this.removeTip(),this.dispatchEvent(new egret.Event(Kingkong.EVENT_SHOOT)),e.touched=!0},e.prototype.preStart=function(){var t=this,e=new GameReady(function(){t.startRun(),t.dispatchEvent(new egret.Event(Kingkong.EVENT_GAME_START))});e.x=App.GameWidth/2,e.y=App.GameHeight/2,this.addChild(e),e.play()},e.prototype.startRun=function(){this._gameStart=!0,this._curTime=0,this.progress=0,this._building.reset(),this._kingkong.reset(),this._invincibleTime=0,this._curDistance=0,this._avatar&&this._avatar.play("newAnimation"),this._building.run(),this._kingkong.run(),this._mode==e.MODE_AI&&this._ai.start()},e.EVENT_SHOOT="kingkongScene:EVENT_SHOOT",e.EVENT_SHOOT_GROUND="kingkongScene:EVENT_SHOOT_GROUND",e.EVENT_JUMP="kingkongScene:EVENT_JUMP",e.EVENT_BOOM="kingkongScene:EVENT_BOOM",e.EVENT_GET_BOOM="kingkongScene:EVENT_GET_BOOM",e.EVENT_GET_BANANA="kingkongScene:EVENT_GET_BANANA",e.MODE_MANUAL=0,e.MODE_NET=1,e.MODE_AI=2,e.FAST_TIME=3e3,e.INVINCIBLE_TIME=1.1,e}(egret.DisplayObjectContainer);__reflect(KingkongScene.prototype,"KingkongScene");var GameSceneView=function(t){function e(){var s=t.call(this)||this;return e._gameScene=s,s.initView(),s}return __extends(e,t),e.prototype.errorResponse=function(t,s){console.log("错误回调：errCode="+t+" errMsg="+s),e._gameScene.errorView(0,"错误回调：errCode="+t+" errMsg="+s)},e.prototype.errorResponses=function(t){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponse,this);var s=t.data.errCode,i=t.data.errMsg;1001==s&&(""!=i&&i.indexOf("hotel")>=0?e._gameScene.errorView(1,"错误回调：errCode="+s+" errMsg="+i):e._gameScene.errorView(0,"错误回调：errCode="+s+" errMsg="+i))},e.prototype.initView=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponses,this),this.thisContainer=new egret.Sprite,this.addChild(this.thisContainer),this.login()},e.prototype.premiseLogin=function(){this.removeAll();var t=new PremiseLoginUI;this.thisContainer.addChild(t)},e.prototype.login=function(){this.removeAll();var t=new Login;this.cuntPage=t,this.thisContainer.addChild(t)},e.prototype.lobby=function(){this.removeAll();var t=new Lobby;Lobby.canClick=!0,this.cuntPage=t,this.thisContainer.addChild(t)},e.prototype.match=function(t){this.removeAll();var e=new match(t);match.canClick=!0,this.cuntPage=e,this.thisContainer.addChild(e),console.log(11111),console.log(this.thisContainer)},e.prototype.gameResult=function(t){GameResultView.canClick=!0;var e=new GameResultView(t);this.cuntPage=e,this.thisContainer.addChild(e)},e.prototype.play=function(){this.removeAll(),GameKingkong.canClick=!0;var t=new GameKingkong;this.cuntPage=t,this.thisContainer.addChild(t)},e.prototype.showResult=function(t,e){this.removeAll();var s=new GameResult;s.setResult(t,e),this.thisContainer.addChild(s)},e.prototype.showRoomList=function(){this.removeAll();var t=new RoomListUI;this.thisContainer.addChild(t)},e.prototype.tagsMatchView=function(){this.removeAll();var t=new MatchProperty;this.thisContainer.addChild(t)},e.prototype.createRoom=function(t,e){this.removeAll();var s=new MatchUI;s.setJoinParame(MatchUI.JOINFLAG.CREATEROOM),this.thisContainer.addChild(s)},e.prototype.joinRoomSpecial=function(){this.removeAll();var t=new MatchRoomID;this.thisContainer.addChild(t)},e.prototype.reconnectView=function(){this.removeAll();var t=new ReconnectUI;this.thisContainer.addChild(t)},e.prototype.errorView=function(t,e){this.removeAll(),GameData.init();var s=new ErrorNote;s.SetErrorMsg(e),this.thisContainer.addChild(s)},e.prototype.removeAll=function(){this.cuntPage&&this.cuntPage.release&&(console.log("释放"),this.cuntPage.release(),this.cuntPage=null),this.thisContainer.removeChildren()},e}(egret.Sprite);__reflect(GameSceneView.prototype,"GameSceneView");var AIKingkong=function(t){function e(){var e=t.call(this)||this;return e.level=0,e._nextRandomJumpTime=3,e._nextJumpTime=0,e._nextShootTime=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"kingkong",{set:function(t){this._kingkong=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curItems",{set:function(t){this._curItems=t},enumerable:!0,configurable:!0}),e.prototype.start=function(){this._kingkong&&this._curItems&&(this._running=!0)},e.prototype.over=function(){this._running=!1},e.prototype.advanceTime=function(t){this._running&&(this._kingkong.hasBoom&&(this._nextShootTime-=t,this._nextShootTime<0&&(this.kingkongCanShoot()&&this.dispatchEvent(new egret.Event(Kingkong.EVENT_SHOOT)),this.resetNextShootTime())),this._kingkong.jumpEnable()&&(this.kingkongCanJump(t)?this.dispatchEvent(new egret.Event(Kingkong.EVENT_JUMP)):(this._nextRandomJumpTime-=t,this._nextRandomJumpTime<0&&(this._nextRandomJumpTime=Math.random()*e.RANDOM_JUMP_TIME,this.randomJump()&&this.dispatchEvent(new egret.Event(Kingkong.EVENT_JUMP))))))},e.prototype.resetNextShootTime=function(){switch(this.level){case e.AI_LEVEL_0:this._nextShootTime=1*Math.random()+1;break;case e.AI_LEVEL_1:this._nextShootTime=.5*Math.random()+.5;break;case e.AI_LEVEL_2:this._nextShootTime=.5*Math.random()+.2;break;case e.AI_LEVEL_3:this._nextShootTime=.2*Math.random();break;default:this._nextShootTime=1}},e.prototype.kingkongCanShoot=function(){var t=Math.random();switch(this.level){case e.AI_LEVEL_0:if(.2>t)return!0;break;case e.AI_LEVEL_1:if(.4>t)return!0;break;case e.AI_LEVEL_2:if(.8>t)return!0;break;case e.AI_LEVEL_3:if(1.2>t)return!0;break;default:return!0}return!1},e.prototype.kingkongCanJump=function(t){if(this._curItems&&this._curItems.length>0){var s=this._curItems[0].y-this._kingkong.y;if(s>e.MIN_JUMP_DIS&&s<e.MAX_JUMP_DIS&&(this._nextJumpTime-=t,this._nextJumpTime<0)){var i=Math.random();switch(this.level){case e.AI_LEVEL_0:if(this._nextJumpTime=.1*Math.random()+.3,.2>i)return!0;break;case e.AI_LEVEL_1:if(this._nextJumpTime=.1*Math.random()+.2,.5>i)return!0;break;case e.AI_LEVEL_2:if(this._nextJumpTime=.1*Math.random()+.1,.8>i&&this._curItems[0].type==KingkongItem.TYPE_FIRE_BOOM)return!0;break;case e.AI_LEVEL_3:if(1.2>i&&this._curItems[0].type==KingkongItem.TYPE_FIRE_BOOM)return!0;break;default:return!0}}}return!1},e.prototype.randomJump=function(){var t=Math.random();switch(this.level){case e.AI_LEVEL_0:if(t>.2)return!1;break;case e.AI_LEVEL_1:if(.4>t)return!1;break;case e.AI_LEVEL_2:if(.8>t)return!1;break;case e.AI_LEVEL_3:if(1.2>t)return!1;break;default:return!1}return!0},e.AI_LEVEL_0=0,e.AI_LEVEL_1=1,e.AI_LEVEL_2=2,e.AI_LEVEL_3=3,e.MAX_JUMP_DIS=520,e.MIN_JUMP_DIS=450,e.RANDOM_JUMP_TIME=3,e}(egret.EventDispatcher);__reflect(AIKingkong.prototype,"AIKingkong");var Building=function(t){function e(){var e=t.call(this)||this;e._offset=1195;var s="ground";return e.dbBuilding=AssetManager.getDBArmature(s),e._bone=e.dbBuilding.getBone("bone"),e.addChild(e.dbBuilding),e.stop(),e.reset(),e}return __extends(e,t),e.prototype.reset=function(){this._curD=this._bone.globalTransformMatrix.ty,this._lastD=this._curD,this.tickDistance=0,this.curDistance=0},e.prototype.advanceTime=function(t){for(this._curD=this._bone.globalTransformMatrix.ty,this.tickDistance=this._curD-this._lastD;this.tickDistance<0;)this.tickDistance+=this._offset;this._lastD=this._curD,this.curDistance+=this.tickDistance},e.prototype.runNormal=function(){var t=egret.Tween.get(this.dbBuilding);t.to({timeScale:e.NORMAL_SPEED},500)},e.prototype.runFast=function(){var t=egret.Tween.get(this.dbBuilding);t.to({timeScale:e.FAST_SPEED},500)},e.prototype.runSlow=function(){this.dbBuilding.timeScale=0},e.prototype.run=function(){this.dbBuilding.play("run"),this.runSlow(),this.runNormal(),this.reset()},e.prototype.stop=function(){this.dbBuilding.stop()},e.NORMAL_SPEED=2,e.FAST_SPEED=3,e}(egret.Sprite);__reflect(Building.prototype,"Building");var Kingkong=function(t){function e(e){void 0===e&&(e=!1);var s=t.call(this)||this,i=e?"kingkong":"kingkongBlue";s.dbKingkong=AssetManager.getDBArmature(i),s.dbKingkong.scaleX=s.dbKingkong.scaleY=1.5,s._dust=AssetManager.getDBArmature("dust"),s._dust&&(s._dust.timeScale=1.5),s._bananaPeel=AssetManager.getDBArmature("bananaPeel"),s._bananaPeel.timeScale=1.5,s._bananaPeel.gotoAndStop("run"),s.addChild(s.dbKingkong);var n=s.dbKingkong.getSlot("boom");return n&&(s.boomArmature=n.childArmature),s.dbKingkong.replaceSlot("dust",s._dust),s.dbKingkong.replaceSlot("bananaPeel",s._bananaPeel),s}return __extends(e,t),e.prototype.onAir=function(){return this._status==e.STATUS_JUMP&&this._jumpState&&this._jumpState.currentTime>.17&&this._jumpState.currentTime<1.5?!0:!1},e.prototype.run=function(){this.invincible=!1,this._status=e.STATUS_RUN,this.dbKingkong.timeScale=e.NORMAL_SPEED,this._fast?(this._speedTw=egret.Tween.get(this.dbKingkong),this._speedTw.to({timeScale:e.FAST_SPEED},500)):this._slow?this.dbKingkong.timeScale=e.SLOW_SPEED:this.dbKingkong.timeScale=e.NORMAL_SPEED,this.dbKingkong.play("run",0)},e.prototype.playHit=function(){this._speedTw&&egret.Tween.removeTweens(this.dbKingkong),this.invincible=!0,this._fast=!1,this._status=e.STATUS_HIT,this.dbKingkong.timeScale=e.NORMAL_SPEED,this.dbKingkong.play("boom",1),this.dbKingkong.addDisplayEvent(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onBoomComplete,this)},e.prototype.onBoomComplete=function(t){this.dispatchEvent(new egret.Event(e.EVENT_RECOVER)),this.run(),this.dbKingkong.removeDisplayEvent(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onBoomComplete,this)},e.prototype.jumpEnable=function(){return this._status==e.STATUS_RUN},e.prototype.jump=function(){this._speedTw&&egret.Tween.removeTweens(this.dbKingkong),this.invincible=!1,this._status=e.STATUS_JUMP,this.dbKingkong.timeScale=e.NORMAL_SPEED,this._jumpState=this.dbKingkong.play("jump",1),this.dbKingkong.addDisplayEvent(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onJumpComplete,this);var t=Math.floor(7*Math.random())+1;this._dust.play("boom"+t,1)},e.prototype.runFast=function(){this._fast=!0,this._slow=!1,this._bananaPeel&&this._bananaPeel.play("run",1),this._status==e.STATUS_RUN&&(this._speedTw=egret.Tween.get(this.dbKingkong),this._speedTw.to({timeScale:e.FAST_SPEED},500))},e.prototype.runSlow=function(){this._slow=!0,this._fast=!1,this._status==e.STATUS_RUN&&(this.dbKingkong.timeScale=e.SLOW_SPEED)},e.prototype.runNormal=function(){this._fast=!1,this._status==e.STATUS_RUN&&(this._speedTw=egret.Tween.get(this.dbKingkong),this._speedTw.to({timeScale:e.NORMAL_SPEED},500),this.dbKingkong.timeScale=e.NORMAL_SPEED)},e.prototype.onJumpComplete=function(t){this._fast?this.dbKingkong.timeScale=e.FAST_SPEED:this._slow?this.dbKingkong.timeScale=e.SLOW_SPEED:this.dbKingkong.timeScale=e.NORMAL_SPEED,this.run(),this.dbKingkong.removeDisplayEvent(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onJumpComplete,this)},e.prototype.stand=function(){this.invincible=!0,this._status=e.STATUS_STAND,this.dbKingkong.gotoAndStop("stand")},e.prototype.getBoom=function(t){if(this.hasBoom=t,this.boomArmature){var e=this.hasBoom?"boom1":"boom0";this.boomArmature.animation.gotoAndStop(e)}},e.prototype.reset=function(){this._fast=!1,this._slow=!1,this.invincible=!1},e.EVENT_RECOVER="EVENT_RECOVER",e.EVENT_SHOOT="EVENT_SHOOT",e.EVENT_JUMP="EVENT_JUMP",e.EVENT_WIN="EVENT_WIN",e.EVENT_GAME_START="EVENT_GAME_START",e.EVENT_GAME_OVER="EVENT_GAME_OVER",e.STATUS_RUN=0,e.STATUS_JUMP=1,e.STATUS_HIT=2,e.STATUS_STAND=3,e.STATUS_OVER=4,e.ARM_LENGTH=84,e.LEG_LENGTH=60,e.LENGTH=e.ARM_LENGTH+e.LEG_LENGTH,e.NORMAL_SPEED=2,e.FAST_SPEED=3,e.SLOW_SPEED=1,e}(egret.Sprite);__reflect(Kingkong.prototype,"Kingkong");var KingkongItem=function(t){function e(){var e=t.call(this)||this,s="kingkongItem";return e._item=AssetManager.getQuickDBArmature(s),e._item.scaleX=e._item.scaleY=1.2,e.addChild(e._item),e}return __extends(e,t),e.prototype.reDraw=function(){var t=16711680;switch(this._item.stop(),this._type){case e.TYPE_BANANA:t=16776960,this._item.gotoAndStop("banana");break;case e.TYPE_BOOM:t=0,this._item.gotoAndStop("boom");break;case e.TYPE_FIRE_BOOM:t=16711680,this._item.play("fireBoom");break;case e.TYPE_KEY:t=16711680,this._item.gotoAndStop("key");break;case e.TYPE_WIN:t=16711680,this._item.gotoAndStop("qi");break;default:t=16777215,this._item.stop()}},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.reDraw()},enumerable:!0,configurable:!0}),e.TYPE_BANANA=0,e.TYPE_BOOM=1,e.TYPE_FIRE_BOOM=2,e.TYPE_KEY=3,e.TYPE_WIN=4,e.SIZE=75,e.HALF_SIZE=e.SIZE/2,e}(egret.Sprite);__reflect(KingkongItem.prototype,"KingkongItem");var ScoreData=function(){function t(){this._curBestHit=0,this._curGoodHit=0,this._curMissHit=0,this._curComboo=0,this.maxBestHit=0,this.maxGoodHit=0,this.maxMissHit=0,this.maxComboo=0}return Object.defineProperty(t.prototype,"curBestHit",{get:function(){return this._curBestHit},set:function(t){this._curBestHit=t,this.maxBestHit<this._curBestHit&&(this.maxBestHit=this._curBestHit),this.curComboo++,console.log("cur best:",this._curBestHit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curGoodHit",{get:function(){return this._curGoodHit},set:function(t){this._curGoodHit=t,this.maxGoodHit<this._curGoodHit&&(this.maxGoodHit=this._curGoodHit),this.curComboo++,console.log("cur good:",this._curGoodHit)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curMissHit",{get:function(){return this._curMissHit},set:function(t){this._curMissHit=t,this.maxMissHit<this._curMissHit&&(this.maxMissHit=this._curMissHit),this._curComboo=0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curComboo",{get:function(){return this._curComboo},set:function(t){this._curComboo=t,this.maxComboo<this._curComboo&&(this.maxComboo=this._curComboo),console.log("cur comboo:",this._curComboo)},enumerable:!0,configurable:!0}),t}();__reflect(ScoreData.prototype,"ScoreData");var mvs;!function(t){var e=function(){function e(){this._engine=null,this._response=null,this._engine=new MatchvsEngine}return Object.defineProperty(e,"getInstance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(e,s,i){this._response=t.MsResponse.getInstance.getResponse();var n=this._engine.init(t.MsResponse.getInstance.getResponse(),e,s,i);return console.log("))))))))))))))))))"+n),0!==n?(console.info("[MsEngine init failed] resCode:",n),n):(console.info("[MsEngine init seccess] resCode:",n),n)},e.prototype.setRegisterHost=function(t){var e=this._engine.setRegisterHost(t);return console.log(e+"||||||||||||||||||||||||||||||"),e},e.prototype.premiseInit=function(e,s){this._response=t.MsResponse.getInstance.getResponse();var i=this._engine.premiseInit(t.MsResponse.getInstance.getResponse(),e,s);return 0!==i?(console.info("[MsEngine premiseInit failed] resCode:",i),i):(console.info("[MsEngine premiseInit seccess] resCode:",i),i)},e.prototype.login=function(t,e,s,i,n){var o=this._engine.login(t,e,s,1,i,n,"eglejjddg",0);return console.info("[MsEngine login] resCode:",o),o},e.prototype.registerUser=function(){var t=this._engine.registerUser();return console.log("**************************"+t),0!==t?(console.error("[MsEngine registerUser failed] resCode:",t),t):(console.info("[MsEngine registerUser seccess] resCode:",t),t)},e.prototype.joinRandomRoom=function(t,e){var s=this._engine.joinRandomRoom(t,e);return console.info("[MsEngine joinRandomRoom ] resCode:",s),s},e.prototype.joinRoomWithProperties=function(t,e){var s=this._engine.joinRoomWithProperties(t,e);return console.info("[MsEngine joinRandomRoom ] resCode:",s),s},e.prototype.joinRoom=function(t,e){var s=this._engine.joinRoom(t,e);return s},e.prototype.createRoom=function(t,e){var s=this._engine.createRoom(t,e);return console.info("[MsEngine createRoom ] resCode:",s,JSON.stringify(t),e),s},e.prototype.joinOver=function(t){var e=this._engine.joinOver(t);return console.info("[MsEngine joinOver ] resCode:",e),e},e.prototype.joinOpen=function(t){var e=this._engine.joinOpen(t);return console.info("[MsEngine joinOpen ] resCode:",e),e},e.prototype.leaveRoom=function(t){var e=this._engine.leaveRoom(t);return console.info("[MsEngine leaveRoom ] resCode:",e),e},e.prototype.sendEvent=function(t){var e=this._engine.sendEvent(t);return e},e.prototype.sendEventEx=function(t,e,s,i){var n=this._engine.sendEventEx(t,e,s,i);return n},e.prototype.sendFrameEvent=function(t){var e=this._engine.sendFrameEvent(t);return console.info("[MsEngine sendFrameEvent ] resCode:",e),e},e.prototype.setFrameSync=function(t){var e=this._engine.setFrameSync(t);return console.info("[MsEngine setFrameSync ] resCode:",e),e},e.prototype.logOut=function(){var t=this._engine.logout("退出登录");return console.info("[MsEngine setFrameSync ] resCode:",t),t},e.prototype.kickPlayer=function(t,e){var s=this._engine.kickPlayer(t,e);return console.info("[MsEngine kickPlayer ] resCode:",s),s},e.prototype.getRoomDetail=function(t){var e=this._engine.getRoomDetail(t);return console.info("[MsEngine getRoomDetail ] resCode:",e),e},e.prototype.getRoomList=function(t){var e=this._engine.getRoomList(t);return console.info("[MsEngine getRoomList ] resCode:",e),e},e.prototype.getRoomListEx=function(t){var e=this._engine.getRoomListEx(t);return console.info("[MsEngine getRoomListEx ] resCode:",e),e},e.prototype.setRoomProperty=function(t,e){var s=this._engine.setRoomProperty(t,e);return console.info("[MsEngine setRoomProperty ] resCode:",s),s},e.prototype.reconnect=function(){var t=this._engine.reconnect();return console.info("[MsEngine reconnect ]",t),t},e._instance=null,e}();t.MsEngine=e,__reflect(e.prototype,"mvs.MsEngine")}(mvs||(mvs={}));var mvs;!function(t){var e=function(){function t(){}return t.EVENT_INIT_RSP="MATCHVS_INIT_EVENT",t.EVENT_REGISTERUSER_RSP="MATCHVS_REGISTERUSER_EVENT",t.EVENT_LOGIN_RSP="MATCHVS_LOGIN_EVENT",t.EVENT_JOINROOM_RSP="MATCHVS_JOINROOM_EVENT",t.EVENT_JOINROOM_NTFY="MATCHVS_JOINROOM_NOTIFY_EVENT",t.EVENT_CREATEROOM_RSP="MATCHVS_CREATEROOM_RSP_EVENT",t.EVENT_SENDEVENT_RSP="MATCHVS_SENDEVENT_RSP_EVENT",t.EVENT_SENDEVENT_NTFY="MATCHVS_SENDEVENT_NOTIFY_EVENT",t.EVENT_SENDEVENT_CHUANG="MATCHVS_SENDEVENT_RSP_EVENT_chuang",t.EVENT_GAMESERVER_NTFY="MATCHVS_GAMESERVER_NOTIFY_EVENT",t.EVENT_LEAVEROOM_RSP="MATCHVS_LEAVEROOM_RSP_EVENT",t.EVENT_LEAVEROOM_NTFY="MATCHVS_LEAVEROOM_NTFY_EVENT",t.EVENT_JOINOVER_RSP="MATCHVS_JOINOVER_RSP_EVENT",t.EVENT_JOINOVER_NTFY="MATCHVS_LEAVEROOM_EVENT",t.EVENT_JOINOPEN_RSP="MATCHVS_JOINOPEN_RSP_EVENT",t.EVENT_JOINOPEN_NTFY="MATCHVS_JOINOPEN_NTFY_EVENT",t.EVENT_NETWORKSTATE_NTFY="MATCHVS_NETWORKSTATE_NTFY",t.EVENT_SENDFRAME_RSP="MATCHVS_SENDFRAME_RSP_EVENT",t.EVENT_SETFRAMESYNC_RSP="MATCHVS_SETFRAMESYNC_RSP_EVENT",t.EVENT_FRAMEUPDATE="MATCHVS_FRAMEUPDATE_EVENT",t.EVENT_ERROR_RSP="MATCHVS_ERROR_RSP_EVENT",t.EVENT_LOGOUT_RSP="MATCHVS_LOGOUT_RSP_EVENT",t.EVENT_SETROOMPROPERTY_RSP="MATCHVS_SETROOMPROPERTY_RSP_EVENT",t.EVENT_SETROOMPROPERTY_NTFY="MATCHVS_SETROOMPROPERTY_NTFY_EVENT",t.EVENT_KICKPLAYER_RSP="MATCHVS_KICKPLAYER_RSP_EVENT",t.EVENT_KICKPLAYER_NTFY="MATCHVS_KICKPLAYER_NTFY_EVENT",t.EVENT_GETROOMLIST_RSP="MATCHVS_GETROOMLIST_RSP_EVENT",t.EVENT_GETROOMLIST_EX_RSP="MATCHVS_GETROOMLIST_EX_RSP_EVENT",t.EVENT_GETROOMDETAIL_RSP="MATCHVS_GETROOMDETAIL_RSP_EVENT",t.EVENT_RECONNECT_RSP="MATCHVS_RECONNECT_RSP_EVENT",t}();t.MsEvent=e,__reflect(e.prototype,"mvs.MsEvent")}(mvs||(mvs={}));var mvs;!function(t){var e=function(e){function s(){var t=e.call(this)||this;return t.reframe=[],t.startTime=0,t.endTime=0,t.frist=0,t.re100=0,t.re70=0,t.re200=0,t.re60=0,t.re40=0,t._response=null,t.registResponseCall(),t}return __extends(s,e),Object.defineProperty(s,"getInstance",{get:function(){return null==s._instance&&(s._instance=new s),s._instance},enumerable:!0,configurable:!0}),s.release=function(){s._instance._response=null,s._instance=null},s.prototype.getResponse=function(){return null==this._response&&this.registResponseCall(),this._response},s.prototype.registResponseCall=function(){this._response=new MatchvsResponse,this._response.initResponse=this.initResponse.bind(this),this._response.registerUserResponse=this.registerUserResponse.bind(this),this._response.loginResponse=this.loginResponse.bind(this),this._response.joinRoomResponse=this.joinRoomResponse.bind(this),this._response.joinRoomNotify=this.joinRoomNotify.bind(this),this._response.createRoomResponse=this.createRoomResponse.bind(this),this._response.sendEventResponse=this.sendEventResponse.bind(this),this._response.sendEventNotify=this.sendEventNotify.bind(this),this._response.gameServerNotify=this.gameServerNotify.bind(this),this._response.joinOverResponse=this.joinOverResponse.bind(this),this._response.joinOverNotify=this.joinOverNotify.bind(this),this._response.leaveRoomResponse=this.leaveRoomResponse.bind(this),this._response.leaveRoomNotify=this.leaveRoomNotify.bind(this),this._response.networkStateNotify=this.networkStateNotify.bind(this),this._response.setFrameSyncResponse=this.setFrameSyncResponse.bind(this),this._response.frameUpdate=this.frameUpdate.bind(this),this._response.errorResponse=this.errorResponse.bind(this),this._response.logoutResponse=this.logOutResponse.bind(this),this._response.joinOpenResponse=this.joinOpenResponse.bind(this),this._response.joinOpenNotify=this.joinOpenNotify.bind(this),this._response.kickPlayerNotify=this.kickPlayerNotify.bind(this),this._response.kickPlayerResponse=this.kickPlayerResponse.bind(this),this._response.setRoomPropertyNotify=this.setRoomPropertyNotify.bind(this),this._response.setRoomPropertyResponse=this.setRoomPropertyResponse.bind(this),this._response.getRoomDetailResponse=this.getRoomDetailResponse.bind(this),this._response.getRoomListExResponse=this.getRoomListExResponse.bind(this),this._response.getRoomListResponse=this.getRoomListResponse.bind(this),this._response.reconnectResponse=this.reconnectResponse.bind(this)},s.prototype.initResponse=function(e){console.info("initResponse status：",e),this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_INIT_RSP,!1,!1,{status:e}))},s.prototype.registerUserResponse=function(e){console.info("registerUserResponse userInfo ",JSON.stringify(e)),this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_REGISTERUSER_RSP,!1,!1,e))},s.prototype.loginResponse=function(e){console.info("[loginResponse] "+JSON.stringify(e)),this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_LOGIN_RSP,!1,!1,e))},s.prototype.joinRoomResponse=function(e,s,i){if(200==e){var n={status:e,userList:s,roomInfo:i};return void this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINROOM_RSP,!1,!1,n))}409==e&&GameSceneView._gameScene.lobby(),console.error("[joinRoomResponse error:]",e)},s.prototype.joinRoomNotify=function(e){console.info("[joinRoomNotify] "+e.userProfile);var s={userId:e.userId,userProfile:e.userProfile};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINROOM_NTFY,!1,!1,s))},s.prototype.createRoomResponse=function(e){console.info("[sendEventResponse]"+JSON.stringify(e));var s={status:e.status,roomID:e.roomID,owner:e.owner};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_CREATEROOM_RSP,!1,!1,s))},s.prototype.sendEventResponse=function(e){var s={status:e.status,sequence:e.sequence};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_SENDEVENT_RSP,!1,!1,s))},s.prototype.sendEventNotify=function(e){var s={srcUserId:e.srcUserId,cpProto:e.cpProto};console.log("+++++++++++++++++++++++++发送消息派发+++++++++++++++++++++++++++++++++"),this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_SENDEVENT_NTFY,!1,!1,s))},s.prototype.gameServerNotify=function(e){console.info("[gameServerNotify] ");var s={srcUserId:e.srcUserId,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_GAMESERVER_NTFY,!1,!1,s))},s.prototype.joinOverResponse=function(e){console.info("[joinOverResponse] "+JSON.stringify(e));var s={status:e.status,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINOVER_RSP,!1,!1,s))},s.prototype.joinOverNotify=function(e){console.info("[joinOverNotify] ");var s={roomID:e.roomID,userID:e.srcUserID,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINOVER_NTFY,!1,!1,s))},s.prototype.leaveRoomResponse=function(e){console.info("[leaveRoomResponse] status: "+e.status);var s={roomID:e.roomID,status:e.status,userId:e.userId,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_LEAVEROOM_RSP,!1,!1,s))},s.prototype.leaveRoomNotify=function(e){console.info("[leaveRoomNotify] "+e.userId);var s={roomID:e.roomID,userId:e.userId,owner:e.owner,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_LEAVEROOM_NTFY,!1,!1,s))},s.prototype.networkStateNotify=function(e){console.info("[networkStateNotify] state: "+e.state);var s={roomID:e.roomID,userID:e.userID,owner:e.owner,state:e.state};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_NETWORKSTATE_NTFY,!1,!1,s))},s.prototype.setFrameSyncResponse=function(e){var s={mStatus:e.mStatus};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_SETFRAMESYNC_RSP,!1,!1,s))},s.prototype.frameUpdate=function(e){var s={frameIndex:e.frameIndex,frameItems:e.frameItems,frameWaitCount:e.frameWaitCount};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_FRAMEUPDATE,!1,!1,s))},s.prototype.errorResponse=function(e,s){console.info("[setFrameSyncResponse] errCode:"+e+" errMsg:"+s);var i={errCode:e,errMsg:s};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_ERROR_RSP,!1,!1,i))},s.prototype.logOutResponse=function(e){console.info("[logOutResponse] status:",e);var s={status:e};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_LOGOUT_RSP,!1,!1,s))},s.prototype.joinOpenResponse=function(e){console.info("[joinOpenResponse] info:",e.status);var s={status:e.status,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINOPEN_RSP,!1,!1,s))},s.prototype.joinOpenNotify=function(e){console.info("[joinOpenResponse] info:");var s={roomID:e.roomID,userID:e.userID,cpProto:e.cpProto};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_JOINOPEN_NTFY,!1,!1,s))},s.prototype.kickPlayerNotify=function(e){console.info("[kickPlayerNotify] info:");var s={cpProto:e.cpProto,owner:e.owner,srcUserId:e.srcUserId,userID:e.userID};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_KICKPLAYER_NTFY,!1,!1,s))},s.prototype.kickPlayerResponse=function(e){console.info("[kickPlayerResponse] info:"+e.status);var s={owner:e.owner,userID:e.userID,status:e.status};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_KICKPLAYER_RSP,!1,!1,s))},s.prototype.setRoomPropertyNotify=function(e){console.info("[setRoomPropertyNotify] info:");var s={roomID:e.roomID,userID:e.userID,roomProperty:e.roomProperty};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_SETROOMPROPERTY_NTFY,!1,!1,s))},s.prototype.setRoomPropertyResponse=function(e){console.info("[setRoomPropertyResponse] info:",e.status);var s={roomID:e.roomID,userID:e.userID,roomProperty:e.roomProperty,status:e.status};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_SETROOMPROPERTY_RSP,!1,!1,s))},s.prototype.getRoomDetailResponse=function(e){console.info("[getRoomDetailResponse] info:",e.status);var s={canWatch:e.canWatch,createFlag:e.createFlag,maxPlayer:e.maxPlayer,mode:e.mode,owner:e.owner,roomProperty:e.roomProperty,state:e.state,status:e.status,userInfos:e.userInfos};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_GETROOMDETAIL_RSP,!1,!1,s))},s.prototype.getRoomListExResponse=function(e){console.info("[getRoomListExResponse] info:",e.status);var s={roomAttrs:e.roomAttrs,status:e.status,total:e.total};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_GETROOMLIST_EX_RSP,!1,!1,s))},s.prototype.getRoomListResponse=function(e,s){console.info("[getRoomListResponse] info:",e);var i={status:e,roomInfos:s};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_GETROOMLIST_RSP,!1,!1,i))},s.prototype.reconnectResponse=function(e,s,i){console.info("[reconnectResponse] info:",e);var n={status:e,roomUserInfoList:s,roomInfo:i};this.dispatchEvent(new egret.Event(t.MsEvent.EVENT_RECONNECT_RSP,!1,!1,n))},s.prototype.frameUpdatequality=function(){var t=(new Date).valueOf();if(0==this.startTime?(this.startTime=t,this.frist=t):this.endTime=t,this.endTime-this.startTime>=5e5){for(var e=0,s=0;s<this.reframe.length;s++)e+=this.reframe[s];console.log("收到总次数：",this.reframe.length),console.log("发送间隔时间：",40),console.log("设置的帧率：",GameData.frameRate),console.log("总耗时：",this.endTime-this.startTime),console.log("预计收到间隔时间：",1e3/GameData.frameRate),console.log("平均收到间隔时间：",e/this.reframe.length),console.log("正常次数：",this.re60),console.log("小于 40 次数：",this.re40),console.log("60 ~ 100 次数：",this.re70),console.log("100 ~ 200 次数：",this.re100),console.log("大于 200 次数：",this.re200)}else{var i=t-this.frist;console.log("收到帧间隔时间：",i),0!==this.frist&&this.reframe.push(i),i>=40&&60>=i?this.re60++:40>i?this.re40++:i>60&&100>i?this.re70++:i>100&&200>i?this.re100++:i>200&&this.re200++}this.frist=t},s._instance=null,s}(egret.EventDispatcher);t.MsResponse=e,__reflect(e.prototype,"mvs.MsResponse")}(mvs||(mvs={}));var EventMessage=function(){function t(){}return t.GameLeave="GameLeave",t.GameGiveUp="GameGiveUp",t.gameCloseGiveUp="gameCloseGiveUp",t.GameExpress="GameExpress",t.GameSendExpress="GameSendExpress",t.ReddotChange="reddotChange",t.ChangeAvatar="changeAvatar",t.WechatAppShow="WechatAppShow",t.WechatShareSuccess="WechatShareSuccess",t.ChatListChange="ChatListChange",t.gameResultLeave="gameResultLeave",t.OpenChatRoomView="OpenChatRoomView",t.OpenHomePageView="OpenHomePageView",t.gameCloseExpress="gameCloseExpress",t.GameGetSkinView="GameGetSkinView",t.MoneyChange="MoneyChange",t.ResumeDanmu="ResumeDanmu",t.BarrageBtnPos="BarrageBtnPos",t.GameSureSelect="GameSureSelect",t.HomePageViewData="HomePageViewData",t.leaderboardSetScore="leaderboardSetScore",t.pauseMessage="pauseMessage",t.SendGameResultC2S="SendGameResultC2S",t.SendGameEventC2S="SendGameEventC2S",t.ReceiveGameEventS2C="ReceiveGameEventS2C",t.ReceiveGameResultS2C="ReceiveGameResultS2C",t.AddErrQuestionC2S="AddErrQuestionC2S",t.GetQuestionsC2S="GetQuestionsC2S",t.GetDataC2S="GetDataC2S",t
}();__reflect(EventMessage.prototype,"EventMessage");var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var s=0,i=this.data.length;i>s;s++){var n=[],o=this.data.charCodeAt(s);o>65536?(n[0]=240|(1835008&o)>>>18,n[1]=128|(258048&o)>>>12,n[2]=128|(4032&o)>>>6,n[3]=128|63&o):o>2048?(n[0]=224|(61440&o)>>>12,n[1]=128|(4032&o)>>>6,n[2]=128|63&o):o>128?(n[0]=192|(1984&o)>>>6,n[1]=128|63&o):n[0]=o,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,s=this.parsedData.length;s>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var s=0;e>s;s++)this.putBit(1==(t>>>e-s-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(s,i,n,o,r){void 0===i&&(i=0),void 0===n&&(n=200),void 0===o&&(o=200),void 0===r&&(r=2);var a={width:n,height:o,correctLevel:t.QRErrorCorrectLevel.H,color:i},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(s,a.correctLevel),a.correctLevel);return h.addData(s),h.make(),e.draw(h,a)},e.draw=function(t,e){for(var s=new egret.Sprite,e=e,i=t.getModuleCount(),n=Math.floor(e.width/i),o=Math.floor(e.height/i),r=0;i>r;r++)for(var a=0;i>a;a++){var h=t.isDark(r,a);h&&(s.graphics.beginFill(e.color),s.graphics.drawRect(a*n,r*o,n,o),s.graphics.endFill())}return s},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var s=new t.QR8bitByte(e);this.dataList.push(s),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,s){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[i][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,s),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,s)},e.prototype.setupPositionProbePattern=function(t,e){for(var s=-1;7>=s;s++)if(!(-1>=t+s||this.moduleCount<=t+s))for(var i=-1;7>=i;i++)-1>=e+i||this.moduleCount<=e+i||(s>=0&&6>=s&&(0==i||6==i)||i>=0&&6>=i&&(0==s||6==s)||s>=2&&4>=s&&i>=2&&4>=i?this.modules[t+s][e+i]=!0:this.modules[t+s][e+i]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,s=0,i=0;8>i;i++){this.makeImpl(!0,i);var n=t.QRUtil.getLostPoint(this);(0==i||e>n)&&(e=n,s=i)}return s},e.prototype.createMovieClip=function(t,e,s){var i=t.createEmptyMovieClip(e,s),n=1;this.make();for(var o=0;o<this.modules.length;o++)for(var r=o*n,a=0;a<this.modules[o].length;a++){var h=a*n,c=this.modules[o][a];c&&(i.beginFill(0,100),i.moveTo(h,r),i.lineTo(h+n,r),i.lineTo(h+n,r+n),i.lineTo(h,r+n),i.endFill())}return i},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),s=0;s<e.length;s++)for(var i=0;i<e.length;i++){var n=e[s],o=e[i];if(null==this.modules[n][o])for(var r=-2;2>=r;r++)for(var a=-2;2>=a;a++)-2==r||2==r||-2==a||2==a||0==r&&0==a?this.modules[n+r][o+a]=!0:this.modules[n+r][o+a]=!1}},e.prototype.setupTypeNumber=function(e){for(var s=t.QRUtil.getBCHTypeNumber(this.typeNumber),i=0;18>i;i++){var n=!e&&1==(s>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=n}for(var i=0;18>i;i++){var n=!e&&1==(s>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=n}},e.prototype.setupTypeInfo=function(e,s){for(var i=this.errorCorrectLevel<<3|s,n=t.QRUtil.getBCHTypeInfo(i),o=0;15>o;o++){var r=!e&&1==(n>>o&1);6>o?this.modules[o][8]=r:8>o?this.modules[o+1][8]=r:this.modules[this.moduleCount-15+o][8]=r}for(var o=0;15>o;o++){var r=!e&&1==(n>>o&1);8>o?this.modules[8][this.moduleCount-o-1]=r:9>o?this.modules[8][15-o-1+1]=r:this.modules[8][15-o-1]=r}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,s){for(var i=-1,n=this.moduleCount-1,o=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var h=0;2>h;h++)if(null==this.modules[n][a-h]){var c=!1;r<e.length&&(c=1==(e[r]>>>o&1));var p=t.QRUtil.getMask(s,n,a-h);p&&(c=!c),this.modules[n][a-h]=c,o--,-1==o&&(r++,o=7)}if(n+=i,0>n||this.moduleCount<=n){n-=i,i=-i;break}}},e.createData=function(s,i,n){for(var o=t.QRRSBlock.getRSBlocks(s,i),r=new t.QRBitBuffer,a=0;a<n.length;a++){var h=n[a];r.put(h.mode,4),r.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,s)),h.write(r)}for(var c=0,a=0;a<o.length;a++)c+=o[a].dataCount;if(r.getLengthInBits()>8*c)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*c+")");for(r.getLengthInBits()+4<=8*c&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*c)&&(r.put(e.PAD0,8),!(r.getLengthInBits()>=8*c));)r.put(e.PAD1,8);return e.createBytes(r,o)},e.createBytes=function(e,s){for(var i=0,n=0,o=0,r=new Array(s.length),a=new Array(s.length),h=0;h<s.length;h++){var c=s[h].dataCount,p=s[h].totalCount-c;n=Math.max(n,c),o=Math.max(o,p),r[h]=new Array(c);for(var l=0;l<r[h].length;l++)r[h][l]=255&e.buffer[l+i];i+=c;var u=t.QRUtil.getErrorCorrectPolynomial(p),m=new t.QRPolynomial(r[h],u.getLength()-1),g=m.mod(u);a[h]=new Array(u.getLength()-1);for(var l=0;l<a[h].length;l++){var _=l+g.getLength()-a[h].length;a[h][l]=_>=0?g.get(_):0}}for(var d=0,l=0;l<s.length;l++)d+=s[l].totalCount;for(var v=new Array(d),f=0,l=0;n>l;l++)for(var h=0;h<s.length;h++)l<r[h].length&&(v[f++]=r[h][l]);for(var l=0;o>l;l++)for(var h=0;h<s.length;h++)l<a[h].length&&(v[f++]=a[h][l]);return v},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,s){function i(i){e.call(s,i,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?i(n):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var qr;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var s=0;s<t.length&&0==t[s];)s++;this.num=new Array(t.length-s+e);for(var i=0;i<t.length-s;i++)this.num[i]=t[i+s]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(s){for(var i=new Array(this.getLength()+s.getLength()-1),n=0;n<this.getLength();n++)for(var o=0;o<s.getLength();o++)i[n+o]^=t.QRMath.gexp(t.QRMath.glog(this.get(n))+t.QRMath.glog(s.get(o)));return new e(i,0)},e.prototype.mod=function(s){if(this.getLength()-s.getLength()<0)return this;for(var i=t.QRMath.glog(this.get(0))-t.QRMath.glog(s.get(0)),n=new Array(this.getLength()),o=0;o<this.getLength();o++)n[o]=this.get(o);for(var o=0;o<s.getLength();o++)n[o]^=t.QRMath.gexp(t.QRMath.glog(s.get(o))+i);return new e(n,0).mod(s)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,s){var i=e.getRsBlockTable(t,s);if(void 0==i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+s);for(var n=i.length/3,o=[],r=0;n>r;r++)for(var a=i[3*r+0],h=i[3*r+1],c=i[3*r+2],p=0;a>p;p++)o.push(new e(h,c));return o},e.getRsBlockTable=function(s,i){switch(i){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(s-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(s-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(s-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(s-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var s=t<<10;e.getBCHDigit(s)-e.getBCHDigit(e.G15)>=0;)s^=e.G15<<e.getBCHDigit(s)-e.getBCHDigit(e.G15);return(t<<10|s)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var s=t<<12;e.getBCHDigit(s)-e.getBCHDigit(e.G18)>=0;)s^=e.G18<<e.getBCHDigit(s)-e.getBCHDigit(e.G18);return t<<12|s},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,s,i){switch(e){case t.QRMaskPattern.PATTERN000:return(s+i)%2==0;case t.QRMaskPattern.PATTERN001:return s%2==0;case t.QRMaskPattern.PATTERN010:return i%3==0;case t.QRMaskPattern.PATTERN011:return(s+i)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2==0;case t.QRMaskPattern.PATTERN101:return s*i%2+s*i%3==0;case t.QRMaskPattern.PATTERN110:return(s*i%2+s*i%3)%2==0;case t.QRMaskPattern.PATTERN111:return(s*i%3+(s+i)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var s=new t.QRPolynomial([1],0),i=0;e>i;i++)s=s.multiply(new t.QRPolynomial([1,t.QRMath.gexp(i)],0));return s},e.getLengthInBits=function(e,s){if(s>=1&&10>s)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>s)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>s))throw new Error("type:"+s);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),s=0,i=0;e>i;i++)for(var n=0;e>n;n++){for(var o=0,r=t.isDark(i,n),a=-1;1>=a;a++)if(!(0>i+a||i+a>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=a||0!=h)&&r==t.isDark(i+a,n+h)&&o++;o>5&&(s+=3+o-5)}for(var i=0;e-1>i;i++)for(var n=0;e-1>n;n++){var c=0;t.isDark(i,n)&&c++,t.isDark(i+1,n)&&c++,t.isDark(i,n+1)&&c++,t.isDark(i+1,n+1)&&c++,(0==c||4==c)&&(s+=3)}for(var i=0;e>i;i++)for(var n=0;e-6>n;n++)t.isDark(i,n)&&!t.isDark(i,n+1)&&t.isDark(i,n+2)&&t.isDark(i,n+3)&&t.isDark(i,n+4)&&!t.isDark(i,n+5)&&t.isDark(i,n+6)&&(s+=40);for(var n=0;e>n;n++)for(var i=0;e-6>i;i++)t.isDark(i,n)&&!t.isDark(i+1,n)&&t.isDark(i+2,n)&&t.isDark(i+3,n)&&t.isDark(i+4,n)&&!t.isDark(i+5,n)&&t.isDark(i+6,n)&&(s+=40);for(var p=0,n=0;e>n;n++)for(var i=0;e>i;i++)t.isDark(i,n)&&p++;var l=Math.abs(100*p/e/e-50)/5;return s+=10*l},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(s,i){for(var n=1,o=e._getUTF8Length(s),r=0,a=e.QRCodeLimitLength.length;a>=r;r++){var h=0;switch(i){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[r][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[r][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[r][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[r][3]}if(h>=o)break;n++}if(n>e.QRCodeLimitLength.length)throw new Error("Too long data");return n},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));var RoleAvatar=function(){function t(t,e,s){if(void 0===s&&(s="dbxiaoren00"),this._armature=AssetManager.getDBArmature(s),null!=this._armature&&(this._headContainer=new egret.Sprite,this._head=new RoleHeadImage(e),this._head.x=.5*-this._head.width,this._head.y=.5*-this._head.height,this._headContainer.addChild(this._head),this._armature.replaceSlot("tou",this._headContainer),1!=t)){(null==t||void 0==t)&&(t=2);var i=this.getDbRes(t),n=this.getAvatarRes(t),o=function(){if(this._armature){var t=AssetManager.dbFactory.getArmatureData(i);if(t){var e=t.defaultSkin;this._armature.replaceSkin(e),this._armature.replaceSlot("tou",this._headContainer)}}}.bind(this);RES.getRes(n[0])?o():(App.ResourceUtils.createGroup(i,n),App.ResourceUtils.loadGroup(i,function(){AssetManager.loadDBAnimation([i]),o()},function(){},this))}}return Object.defineProperty(t.prototype,"avatarConfig",{get:function(){return RES.getRes("avatar_json")},enumerable:!0,configurable:!0}),t.prototype.getDbRes=function(t){var e=RES.getRes("avatar_json");return e.base[t].res},t.prototype.getAvatarRes=function(t){var e=this.getDbRes(t);return[e+"_ske_json",e+"_tex_json",e+"_tex_png"]},Object.defineProperty(t.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._armature.dispose(),this._armature=null,this._head.dispose(),this._head=null},t}();__reflect(RoleAvatar.prototype,"RoleAvatar");var RoleHeadImage=function(t){function e(e,s,i,n){void 0===s&&(s="tou_png"),void 0===i&&(i=96),void 0===n&&(n=96);var o=t.call(this)||this;return o.userBase64=!1,o.imgUrl=e,o.maskRes=s,o.bitmap=new egret.Bitmap,o.bitmap.width=i,o.bitmap.height=n,o.bitmap.texture=RES.getRes("tou_png"),o.addChild(o.bitmap),o.imgUrl&&o.imgUrl.length?(o.LoadeAvatar(o.imgUrl,o),o):o}return __extends(e,t),e.prototype.setBitmap=function(t){this.bitmap&&t&&(this.bitmap.texture=t,this.maskRes&&(this.maskBitmap=App.DisplayUtils.createBitmap(this.maskRes),this.maskBitmap.width=this.bitmap.width,this.maskBitmap.height=this.bitmap.height,this.addChild(this.maskBitmap),this.bitmap.mask=this.maskBitmap,this.cacheAsBitmap=!0))},e.prototype.LoadeAvatar=function(t,e){var s=new egret.ImageLoader;s.crossOrigin="anonymous",s.load(t),s.once(egret.Event.COMPLETE,function(t){if(t.currentTarget.data){var s=new egret.Texture;s.bitmapData=t.currentTarget.data;var i=new egret.Bitmap(s);e.addChild(i),i.width=96,i.height=96,i.name="touxiang"}},this),this.maskRes&&(this.maskBitmap=App.DisplayUtils.createBitmap(this.maskRes),this.maskBitmap.width=this.bitmap.width,this.maskBitmap.height=this.bitmap.height,this.addChild(this.maskBitmap),this.bitmap.mask=this.maskBitmap,this.cacheAsBitmap=!0)},e.prototype.dispose=function(){this.removeChildren(),this.bitmap.texture=null,this.bitmap=null,this.maskBitmap&&(this.maskBitmap.texture=null,this.maskBitmap=null),this.userBase64&&Base64BitmapDataPool.reduceUseNum(this.imgUrl),this.cacheAsBitmap=!1},e}(egret.Sprite);__reflect(RoleHeadImage.prototype,"RoleHeadImage");var ErrorNote=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),"btn_return"==e?(this.btn_return=s,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"lab_content"==e||"btn_reconnect"==e&&(this.btn_reconnect=s,this.btn_reconnect.visible=!1,this.btn_reconnect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonReconnRoom,this))},e.prototype.childrenCreated=function(){for(t.prototype.childrenCreated.call(this),this.height=this.stage.stageHeight,this.lab_userID.text="用户ID："+GameData.gameUser.id;GameData.intervalList.length>0;)clearTimeout(GameData.intervalList.pop())},e.prototype.SetErrorMsg=function(t){this.errMsg=t},e.prototype.showReconnect=function(){this.btn_reconnect.visible=!0},e.prototype.mbuttonReconnRoom=function(t){GameSceneView._gameScene.reconnectView()},e.prototype.mbuttonExitRoom=function(t){GameSceneView._gameScene.login()},e}(eui.Component);__reflect(ErrorNote.prototype,"ErrorNote",["eui.UIComponent","egret.DisplayObject"]);var GameResult=function(t){function e(){var e=t.call(this)||this;return e._userList=[],e}return __extends(e,t),e.prototype.getChilds=function(t,e){"lab_userID1"==t?this.lab_userID1=e:"lab_userID2"==t?this.lab_userID2=e:"lab_userID3"==t?this.lab_userID3=e:"lab_score1"==t?this.lab_score1=e:"lab_score2"==t?this.lab_score2=e:"lab_score3"==t?this.lab_score3=e:"btn_leave"==t?(this.btn_leave=e,this.btn_leave.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"lab_roomID"==t&&(this.lab_roomID=e)},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),this.getChilds(e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.showResutl()},e.prototype.setResult=function(t,e){this.roomID=e;for(var s=0;s<t.length;s++){var i=new GameUser;i.avatar=t[s].avatar,i.id=t[s].id,i.isOwner=t[s].isOwner,i.name=t[s].name,i.tableID=t[s].tableID,i.pValue=t[s].pValue,this._userList.push(i)}},e.prototype.showResutl=function(){this.lab_roomID.text="房间号："+this.roomID;for(var t=!1,e=0;e<this._userList.length;e++)this._userList[e].isOwner?(this.lab_userID1.text=this._userList[e].id,this.lab_score1.text=this._userList[e].pValue):t?(this.lab_userID3.text=this._userList[e].id,this.lab_score3.text=this._userList[e].pValue):(this.lab_userID2.text=this._userList[e].id,this.lab_score2.text=this._userList[e].pValue,t=!0)},e.prototype.mbuttonExitRoom=function(t){console.log("onButtonLeaveRoom"),mvs.MsEngine.getInstance.leaveRoom("游戏玩完一次离开"),GameSceneView._gameScene.lobby(),GameData.isRoomOwner=!1,GameData.syncFrame=!1},e}(eui.Component);__reflect(GameResult.prototype,"GameResult",["eui.UIComponent","egret.DisplayObject"]);var MatchProperty=function(t){function e(){var e=t.call(this)||this;return e._tagsType={match:"tagsA"},e}return __extends(e,t),e.prototype.getChild=function(t,e){var s=this;"rad_A"==t?(this.rad_A=e,this.rad_A.addEventListener(egret.Event.CHANGE,this.radioChangeHandler,this)):"rad_B"==t?(this.rad_B=e,this.rad_B.addEventListener(egret.Event.CHANGE,this.radioChangeHandler,this)):"btn_start"==t?(this.btn_start=e,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mButtonMatchTouch,this)):"lab_userID"==t?(this.lab_userID=e,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name):"img_header"==t?(this.img_header=e,this.img_header.source=GameData.gameUser.avatar):"btn_return"==t?(this.btn_return=e,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"rect_proA"==t?(this.rect_proA=e,this.rect_proA.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){s.rad_A.selected=!0,s.changeInfo(0)},this)):"rect_proB"==t&&(this.rect_proB=e,this.rect_proB.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){s.rad_B.selected=!0,s.changeInfo(1)},this))},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),this.getChild(e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.mbuttonExitRoom=function(t){GameSceneView._gameScene.lobby()},e.prototype.changeInfo=function(t){0==t?(this.rect_proA.fillColor=3490372,this.rect_proA.strokeWeight=2,this.rect_proB.fillColor=5592405,this.rect_proB.strokeWeight=0,this.lab_A.textColor=49632,this.lab_B.textColor=13619151,this._tagsType={match:"tagsA"}):(this.rect_proB.fillColor=3490372,this.rect_proB.strokeWeight=2,this.rect_proA.fillColor=5592405,this.rect_proA.strokeWeight=0,this.lab_B.textColor=49632,this.lab_A.textColor=13619151,this._tagsType={match:"tagsB"}),console.log("tags ="+this._tagsType.match)},e.prototype.radioChangeHandler=function(t){this.changeInfo(t.target.value)},e.prototype.mButtonMatchTouch=function(t){GameData.matchType=GameData.tagsMatch,GameData.syncFrame=!1},e}(eui.Component);__reflect(MatchProperty.prototype,"MatchProperty",["eui.UIComponent","egret.DisplayObject"]);var MatchRoomID=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getChild=function(t,e){var s=this;"lab_userID"==t?(this.lab_userID=e,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name):"img_header"==t?(this.img_header=e,this.img_header.source=GameData.gameUser.avatar):"lab_note"==t?(this.lab_note=e,this.lab_note.visible=!1):"btn_return"==t?(this.btn_return=e,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"btn_start"==t?(this.btn_start=e,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)):"rect_roomID"==t?this.rect_roomID=e:"edt_roomID"==t&&(this.edt_roomID=e,this.edt_roomID.addEventListener(eui.UIEvent.CHANGE,function(t){s.roomIDIsOK()},this))},e.prototype.roomIDIsOK=function(){var t=this.edt_roomID.text;return""==t?void this.showNote("",!1):void(/^[0-9]+$/.test(t)?this.showNote("",!1):this.showNote("请求输入有效的房间号",!0))},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),this.getChild(e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.showNote=function(t,e){this.lab_note.visible=e,this.lab_note.text=t,e?(this.rect_roomID.strokeWeight=2,this.rect_roomID.strokeColor=16275544,this.rect_roomID.fillColor=16770533):(this.rect_roomID.strokeWeight=0,this.rect_roomID.strokeColor=16777215,this.rect_roomID.fillColor=16777215)},e.prototype.mbuttonExitRoom=function(t){GameSceneView._gameScene.lobby()},e.prototype.mbuttonEnterRoom=function(t){var e=this.edt_roomID.text;if(!/^[0-9]+$/.test(e)||""==e)return void this.showNote("无效的房间号",!0);var s={name:GameData.gameUser.name,avatar:GameData.gameUser.avatar},i=(JSON.stringify(s),new MsRoomFilter(GameData.maxPlayerNum,0,0,""));mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMLIST_RSP,this.getRoomListResponse,this),mvs.MsEngine.getInstance.getRoomList(i)},e.prototype.getRoomListResponse=function(t){var e=t.data.status,s=t.data.roomInfos;if(200!==e)return void this.showNote("房间查询错误"+e,!0);for(var i=this.edt_roomID.text,n=!1,o=0;o<s.length;o++)s[o].roomID==i.trim()&&(n=!0);return 0==n?void this.showNote("没有查找到此房间，请重新输入",!0):void mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMLIST_RSP,this.getRoomListResponse,this)},e}(eui.Component);__reflect(MatchRoomID.prototype,"MatchRoomID",["eui.UIComponent","egret.DisplayObject"]);var MatchUI=function(t){function e(){var e=t.call(this)||this;return e.joinFlag=1,e._isInRoom=!1,e.isOwner=!1,e.canStartGame=!1,e._playerList=[],e._roomID="",e.default_name="待加入",e.default_rect_color=5592405,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.addMsResponseListen(),GameData.roomPropertyValue=GameData.roomPropertyType.mapA},e.prototype.getChilds=function(t,e){var s=this;switch(t){case"lab_roomID":this.lab_roomID=e;break;case"group_map":this.group_map=e,this.group_map.visible=!1;break;case"lab_userID":this.lab_userID=e,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name;break;case"lab_lobby":this.lab_lobby=e;break;case"lab_matchmode":this.lab_matchmode=e;break;case"lab_player1":this.lab_player1=e;break;case"lab_player2":this.lab_player2=e;break;case"lab_player3":this.lab_player3=e;break;case"lab_userID1":this.lab_userID1=e;break;case"lab_userID2":this.lab_userID2=e;break;case"lab_userID3":this.lab_userID3=e;break;case"rect_player1":this.rect_player1=e;break;case"rect_player2":this.rect_player2=e;break;case"rect_player3":this.rect_player3=e;break;case"img_owner":this.img_owner=e,this.img_owner.visible=!1;break;case"btn_start":this.btn_start=e,this.btn_start.enabled=!1,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonStartGameBtn,this);break;case"btn_return":this.btn_return=e,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonLeaveRoom,this);break;case"rad_mapA":this.rad_mapA=e,this.rad_mapA.enabled=!1,this.rad_mapA.addEventListener(egret.TouchEvent.TOUCH_TAP,this.radioChangeHandler,this);break;case"rad_mapB":this.rad_mapB=e,this.rad_mapB.enabled=!1,this.rad_mapB.addEventListener(egret.TouchEvent.TOUCH_TAP,this.radioChangeHandler,this);break;case"btn_kick2":this.btn_kick2=e,this.btn_kick2.visible=!1,this.btn_kick2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnKickPlayerClick,this);break;case"btn_kick3":this.btn_kick3=e,this.btn_kick3.visible=!1,this.btn_kick3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnKickPlayerClick,this);break;case"check_closeRoom":this.check_closeRoom=e,this.check_closeRoom.addEventListener(egret.Event.CHANGE,function(){s.check_closeRoom.label=s.check_closeRoom.selected?"允许加入":"禁止加入",s.check_closeRoom.selected?mvs.MsEngine.getInstance.joinOpen("x"):mvs.MsEngine.getInstance.joinOver("x")},this)}},e.prototype.partAdded=function(e,s){this.getChilds(e,s),t.prototype.partAdded.call(this,e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.joinRoom(this.joinFlag,this.joinInfo)},e.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_RSP,this.setRoomPropertyResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_NTFY,this.setRoomPropertynotify,this)
},e.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_RSP,this.setRoomPropertyResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SETROOMPROPERTY_NTFY,this.setRoomPropertynotify,this)},e.prototype.setJoinParame=function(t,e){this.joinFlag=t,this.joinInfo=e},e.prototype.joinRoom=function(t,e){this.joinFlag=t,1==t?(this.lab_matchmode.text="（随机匹配）",this.joinRandRoom()):2==t?this.createRoom():3==t?(this.joinWithRoomID(e),this.lab_matchmode.text=""):4==t&&(GameData.syncFrame?(this.lab_matchmode.text="（帧同步匹配）",e={match:"frameSync"}):this.lab_matchmode.text="（自定义属性匹配）",this.joinRoomWithPro(e))},e.prototype.joinRandRoom=function(){var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRandomRoom(GameData.maxPlayerNum,t)},e.prototype.createRoom=function(){var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.createRoom(GameData.createRoomInfo,t)},e.prototype.joinWithRoomID=function(t){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRoom(t,e)},e.prototype.joinRoomWithPro=function(t){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar}),s=new MsMatchInfo(GameData.maxPlayerNum,0,0,t);mvs.MsEngine.getInstance.joinRoomWithProperties(s,e)},e.prototype.addPlayerList=function(t,e,s,i,n){void 0===n&&(n=!1);var o=new GameUser;return o.id=t,o.name=e,o.avatar=s,o.tableID=i,o.isOwner=n,this._playerList.push(o),this.showPlayer(o),o},e.prototype.delPlayerList=function(t){for(var e=new GameUser,s=0;s<this._playerList.length;s++)this._playerList[s].id==t&&(e.id=this._playerList[s].id,e.avatar=this._playerList[s].avatar,e.name=this._playerList[s].name,e.tableID=this._playerList[s].tableID,this._playerList.splice(s,1),this.wipePlayer(e))},e.prototype.showPlayer=function(t){var s=t.tableID;this.joinFlag==e.JOINFLAG.CREATEROOM||this.joinFlag==e.JOINFLAG.WITHROOMID?(this.group_map.visible=!0,this.rad_mapA.enabled=this.isOwner,this.rad_mapB.enabled=this.isOwner,console.log("mapValue:",this.rad_mapA.value),console.log("mapValue:",this.rad_mapB.value),this.btn_start.visible=this.isOwner,this.img_owner.visible=this.isOwner,(2==s||3==s)&&(this["btn_kick"+s].visible=this.isOwner)):(this.btn_start.visible=!1,this.group_map.visible=!1),this.check_closeRoom.visible=!this.canStartGame,this.check_closeRoom.enabled=this.isOwner,this["lab_player"+s].text=s.toString(),this["lab_player"+s].textColor=16777215,t.id==GameData.gameUser.id&&(this["lab_player"+s].text="我"),1==s?(this.rect_player1.fillColor=9164768,this.lab_userID1.text=t.name):2==s?(this.rect_player2.fillColor=9889973,this.lab_userID2.text=t.name):3==s&&(this.rect_player3.fillColor=15257232,this.lab_userID3.text=t.name)},e.prototype.wipePlayer=function(t){var e=t.tableID;1==e?(this.lab_userID1.text=this.default_name,this.rect_player1.fillColor=this.default_rect_color,this.lab_player1.text="1",this.lab_player1.textColor=7697781,this.lab_userID2.text=this.default_name,this.rect_player2.fillColor=this.default_rect_color,this.lab_player2.text="2",this.lab_player2.textColor=7697781,this.lab_userID3.text=this.default_name,this.rect_player3.fillColor=this.default_rect_color,this.lab_player3.text="3",this.lab_player3.textColor=7697781,this.btn_kick2.visible=!1,this.btn_kick3.visible=!1):2==e?(this.lab_userID2.text=this.default_name,this.rect_player2.fillColor=this.default_rect_color,this.lab_player2.text="2",this.lab_player2.textColor=7697781,this.lab_userID3.text=this.default_name,this.rect_player3.fillColor=this.default_rect_color,this.lab_player3.text="3",this.lab_player3.textColor=7697781,this.btn_kick2.visible=!1,this.btn_kick3.visible=!1):3==e&&(this.lab_userID3.text=this.default_name,this.rect_player3.fillColor=this.default_rect_color,this.lab_player3.text="3",this.lab_player3.textColor=7697781,this.btn_kick3.visible=!1),this.img_owner.visible=!1},e.prototype.wipePlayerLocation=function(t,e){this.isOwner=e==GameData.gameUser.id,this.delPlayerList(t);for(var s=0;s<this._playerList.length;s++)this._playerList[s].isOwner=e==this._playerList[s].id,this._playerList[s].tableID=s+1,this.showPlayer(this._playerList[s])},e.prototype.radioChangeHandler=function(t){0==t.target.value?(GameData.roomPropertyValue=GameData.roomPropertyType.mapA,mvs.MsEngine.getInstance.setRoomProperty(this._roomID,GameData.roomPropertyType.mapA)):(GameData.roomPropertyValue=GameData.roomPropertyType.mapB,mvs.MsEngine.getInstance.setRoomProperty(this._roomID,GameData.roomPropertyType.mapB)),console.log("日志选择：",GameData.roomPropertyValue)},e.prototype.mbuttonStartGameBtn=function(t){this._playerList.length>=GameData.maxPlayerNum?(GameData.playerUserIds=this._playerList,mvs.MsEngine.getInstance.joinOver("joinOver")):console.log("人不够，或者还有人没有准备！")},e.prototype.mbuttonLeaveRoom=function(t){this._isInRoom?mvs.MsEngine.getInstance.leaveRoom("累了困了离开一下"):(this.release(),GameSceneView._gameScene.lobby())},e.prototype.btnKickPlayerClick=function(t){var e=0;"btn_kick2"==t.target.name?e=2:"btn_kick3"==t.target.name&&(e=3);var s=this.getUserForTableID(e);return null==s?void console.info("用户不存在"):void mvs.MsEngine.getInstance.kickPlayer(s.id,"我们不能一起好好的玩游戏")},e.prototype.getUserForTableID=function(t){var e=null;return this._playerList.forEach(function(s){s.tableID==t&&(e=s)}),e},e.prototype.leaveRoomNotify=function(t){var e=t.data;console.info("玩家离开",e);var s=e.userId;e.owner==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1,this.delPlayerList(s),this.canStartGame=!1;for(var i=0;i<this._playerList.length;i++)e.owner==this._playerList[i].id?this._playerList[i].isOwner=!0:this._playerList[i].isOwner=!1,this._playerList[i].tableID=i+1,this.showPlayer(this._playerList[i])},e.prototype.leaveRoomResponse=function(t){var e=t.data;200!==e.status?console.log("退出房间失败！status="+e.status):(this.release(),GameSceneView._gameScene.lobby())},e.prototype.createRoomResponse=function(t){var e=t.data;if(200==e.status){var s=1;e.owner==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1,this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,s,this.isOwner),this.lab_roomID.text="房间号:"+e.roomID,this._roomID=e.roomID,GameData.roomID=e.roomID,this._isInRoom=!0}else console.info("加入房间失败",e)},e.prototype.joinRoomResponse=function(t){var e=t.data;if(200==e.status){this.lab_roomID.text="房间号:"+e.roomInfo.roomID,this._roomID=e.roomInfo.roomID,GameData.roomID=e.roomInfo.roomID,this._isInRoom=!0,GameData.gameUser.isOwner=!1,e.roomInfo.ownerId==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1,e.roomInfo.roomProperty===GameData.roomPropertyType.mapB?(GameData.roomPropertyValue=GameData.roomPropertyType.mapB,this.rad_mapB.selected=!0):(GameData.roomPropertyValue=GameData.roomPropertyType.mapA,this.rad_mapA.selected=!0);var s=1;this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,s,this.isOwner);for(var i=e.userList,n=0;n<i.length;n++)s++,this.otherJoinShowInfo(i[n].userId,s,i[n].userProfile,e.roomInfo.ownerId==i[n].userId);this.checkStart()}else console.info("加入房间失败",e)},e.prototype.checkStart=function(){console.info("房间人数："+this._playerList.length),this._playerList.length==GameData.maxPlayerNum?(console.info("可以开始游戏"),this.canStartGame=!0,this.check_closeRoom.visible=!1,this.joinFlag==e.JOINFLAG.CREATEROOM||this.joinFlag==e.JOINFLAG.WITHROOMID?(this.btn_start.visible=this.isOwner,this.btn_start.enabled=this.isOwner):(this.isOwner&&mvs.MsEngine.getInstance.joinOver("人满开始游戏"),this.btn_start.visible=!1,this.btn_start.enabled=!1)):(this.canStartGame=!1,this.btn_start.enabled=!1,this.check_closeRoom.visible=!0)},e.prototype.otherJoinShowInfo=function(t,e,s,i){if(void 0===i&&(i=!1),s&&""!==s){var n="",o="",r=JSON.parse(s);r.name&&(n=r.name),r.avatar&&(o=r.avatar),this.addPlayerList(t,n,o,e,i)}},e.prototype.joinRoomNotify=function(t){var e=t.data,s=(e.userId,this._playerList.length+1);this.otherJoinShowInfo(e.userId,s,e.userProfile,e.userId==e.owner),this.checkStart()},e.prototype.notifyGameStart=function(){GameData.isRoomOwner=!0;var t=[];this._playerList.forEach(function(e){t.push({id:e.id,name:e.name,avatar:e.avatar})});var e={action:GameData.gameStartEvent,userIds:t},s=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(e));return 0!==s.result?console.log("发送游戏开始通知失败，错误码"+s.result):(GameData.events[s.sequence]=e,void console.log("发起游戏开始的通知，等待回复"))},e.prototype.sendEventResponse=function(t){var e=t.data;if(200!==e.status)return console.log("事件发送失败,status:"+status);var s=GameData.events[e.sequence];s&&s.action===GameData.gameStartEvent&&(delete GameData.events[e.sequence],this.release(),GameSceneView._gameScene.play())},e.prototype.sendEventNotify=function(t){var e=t.data;e&&e.cpProto&&e.cpProto.indexOf(GameData.gameStartEvent)>=0&&(GameData.playerUserIds=this._playerList,this.release(),GameSceneView._gameScene.play())},e.prototype.joinOverResponse=function(t){var e=t.data;if(200===e.status){if(console.log("关闭房间成功"),this.canStartGame)return this.notifyGameStart(),void(GameData.playerUserIds=this._playerList)}else console.log("关闭房间失败，回调通知错误码：",e.status);Toast.show(" 设置不允许房间加人 "+(200==e.status?"success":"fail")),this.check_closeRoom.selected=200==e.status?!1:this.check_closeRoom.selected},e.prototype.joinOverNotify=function(t){var e=t.data;console.log("userID:"+e.userID+" 关闭房间："+e.roomID+" cpProto:"+e.cpProto),Toast.show(e.userID+" 设置了不允许房间加人"),this.check_closeRoom.selected=!1,this.check_closeRoom.label="禁止加入"},e.prototype.joinOpenResponse=function(t){var e=t.data;Toast.show(" 设置允许房间加人 "+(200==e.status?"success":"fail")),this.check_closeRoom.selected=200==e.status?!0:this.check_closeRoom.selected},e.prototype.joinOpenNotify=function(t){var e=t.data;Toast.show(e.userID+" 设置了允许房间加人"),this.check_closeRoom.selected=!0,this.check_closeRoom.label="允许加入"},e.prototype.cancelStart=function(t,e){this.btn_start.enabled=!1,this.btn_start.visible=this.isOwner,this.canStartGame=!1,this.check_closeRoom.visible=!0},e.prototype.kickPlayerResponse=function(t){var e=t.data;this.cancelStart(e.userID,this._roomID),this.wipePlayerLocation(e.userID,e.owner)},e.prototype.kickPlayerNotify=function(t){var e=t.data;console.info("玩家离开",e),e.userID==GameData.gameUser.id?(this.release(),GameSceneView._gameScene.lobby()):(this.cancelStart(e.userID,this._roomID),this.wipePlayerLocation(e.userID,e.owner))},e.prototype.networkStateNotify=function(t){var e=t.data,s=e.userID;this.cancelStart(s,e.roomID),(e.state=1)?(console.info("玩家断开:"+s),mvs.MsEngine.getInstance.kickPlayer(s,"玩家断线踢掉")):2==e.state?console.info("玩家正在从新连接..."+s):(console.info("玩家离开"+s),this.wipePlayerLocation(e.userID,e.owner))},e.prototype.setRoomPropertynotify=function(t){var e=t.data;console.log("roomProperty = "+e.roomProperty),e.roomProperty===GameData.roomPropertyType.mapB?(GameData.roomPropertyValue=GameData.roomPropertyType.mapB,this.rad_mapB.selected=!0):(GameData.roomPropertyValue=GameData.roomPropertyType.mapA,this.rad_mapA.selected=!0)},e.prototype.setRoomPropertyResponse=function(t){console.log("roomProperty = "+t.data.roomProperty)},e.JOINFLAG={RANDROOM:1,CREATEROOM:2,WITHROOMID:3,WITHPROPERTY:4},e}(eui.Component);__reflect(MatchUI.prototype,"MatchUI",["eui.UIComponent","egret.DisplayObject"]);var PremiseLoginUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),this.getControl(e,s)},e.prototype.getControl=function(t,e){"txt_endport"===t?(this.txt_endport=e,this.txt_endport.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[A-Za-z0-9\/\/.:]+$/.test(e.text)||(e.text="")},this)):"txt_gameID"===t?(this.txt_gameID=e,this.txt_gameID.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[0-9]+$/.test(e.text)||(e.text="")},this)):"txt_appKey"===t?(this.txt_appKey=e,this.txt_appKey.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[A-Za-z0-9]+$/.test(e.text)||(e.text="")},this)):"txt_secretKey"===t?(this.txt_secretKey=e,this.txt_secretKey.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[A-Za-z0-9]+$/.test(e.text)||(e.text="")},this)):"txt_userID"===t?(this.txt_userID=e,this.txt_userID.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[0-9]+$/.test(e.text)||(e.text="")},this)):"txt_token"===t?(this.txt_token=e,this.txt_token.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;/^[A-Za-z0-9]+$/.test(e.text)||(e.text="")},this)):"btn_login"===t?(this.btn_login=e,this.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.premiseInit,this)):"btn_return"===t&&(this.btn_return=e,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnReturn,this))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addMsResponseListen(),this.setDefaultValue()},e.prototype.setDefaultValue=function(){this.txt_token.text="OEWIURIOJNUOGIUDSF809LJOKETGT89H",this.txt_secretKey.text="appsecret01",this.txt_userID.text="123456",this.txt_appKey.text="appkey01",this.txt_gameID.text="1",this.txt_endport.text="mt21gateway.matchvs.com"},e.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_INIT_RSP,this.initResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this)},e.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_INIT_RSP,this.initResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this)},e.prototype.premiseInit=function(t){var e=this.txt_endport.text,s=Number(this.txt_gameID.text);mvs.MsEngine.getInstance.premiseInit(e,s)},e.prototype.initResponse=function(t){var e=Number(this.txt_userID.text),s=this.txt_token.text,i=Number(this.txt_gameID.text),n=this.txt_appKey.text,o=this.txt_secretKey.text;GameData.gameUser.id=e,GameData.gameUser.token=s,mvs.MsEngine.getInstance.login(e,s,i,n,o)},e.prototype.loginResponse=function(t){var e=t.data;console.log("loginResponse, status="+e.status),200!=e.status?console.log("登陆失败"):(this.release(),console.log("登陆成功 roomID="+e.roomID),"0"!==e.roomID?(GameData.roomID=e.roomID,GameSceneView._gameScene.reconnectView()):GameSceneView._gameScene.lobby())},e.prototype.btnReturn=function(t){this.release(),GameSceneView._gameScene.login()},e}(eui.Component);__reflect(PremiseLoginUI.prototype,"PremiseLoginUI",["eui.UIComponent","egret.DisplayObject"]);var ReconnectUI=function(t){function e(){var e=t.call(this)||this;return e._reconnctTimes=1,e._totalTimes=5,e.addMsResponseListen(),e}return __extends(e,t),e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),"btn_return"==e&&(this.btn_return=s,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._timer=new egret.Timer(1e3,5),this._timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this._timer.start()},e.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_RECONNECT_RSP,this.reconnectResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this)},e.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_RECONNECT_RSP,this.reconnectResponse,this)},e.prototype.mbuttonExitRoom=function(t){GameSceneView._gameScene.login()},e.prototype.timerFunc=function(t){var e=mvs.MsEngine.getInstance.reconnect();this._reconnctTimes++,this._reconnctTimes>this._totalTimes&&(this._timer.stop(),0===e?(mvs.MsEngine.getInstance.leaveRoom(""),GameSceneView._gameScene.lobby()):(mvs.MsEngine.getInstance.leaveRoom(""),GameSceneView._gameScene.login()),this.release())},e.prototype.reconnectResponse=function(t){console.log("重新连接成功");var e=t.data,s=e.roomUserInfoList,i=e.roomInfo;this._timer.stop(),e.status&&200===e.status?(console.log("重连成功status:"+e.status+" 重连次数："+this._reconnctTimes),GameData.playerUserIds=[],GameData.playerUserIds.push(GameData.gameUser),s.forEach(function(t){if(console.log("用户ID："+t.userID),GameData.gameUser.id!==t.userID){var e={name:"",avatar:""};""!==t.userProfile&&(e=JSON.parse(t.userProfile));var s=new GameUser;s.avatar=e.avatar,s.name=e.name,s.id=t.userID,s.isOwner=t.userID==i.ownerId,GameData.playerUserIds.push(s)}}),GameData.roomPropertyValue=i.roomProperty,GameData.roomID=i.roomID,GameData.isRoomOwner=!1,GameData.playerUserIds.length===GameData.maxPlayerNum&&2===i.state?this.sendReadyEvent():(console.log("还没有开始游戏或者游戏结束, 退出到大厅"),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),this.release(),GameSceneView._gameScene.lobby())):(console.log("重连失败"+this._reconnctTimes),this.release(),GameSceneView._gameScene.lobby())},e.prototype.sendEventResponse=function(t){var e=t.data;if(200===e.status){var s=GameData.events[e.sequence];s&&s.action===GameData.reconnectReadyEvent&&(delete GameData.events[e.sequence],this.release(),GameSceneView._gameScene.play())}else this.release(),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),GameSceneView._gameScene.lobby()},e.prototype.errorResponse=function(t){this._timer.stop()},e.prototype.mbuttonCancleBtn=function(t){this._timer.stop(),this.release(),mvs.MsEngine.getInstance.leaveRoom("")},e.prototype.leaveRoomResponse=function(t){console.log("取消重新连接，离开房间:"+t.status)},e.prototype.sendReadyEvent=function(){var t={action:GameData.reconnectReadyEvent,userID:GameData.gameUser.id},e=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(t));return e&&0===e.result?(GameData.events[e.sequence]=t,void console.log("重连发送信息成功")):(console.log("重连发送信息失败"),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),GameSceneView._gameScene.lobby(),void this.release())},e}(eui.Component);__reflect(ReconnectUI.prototype,"ReconnectUI",["eui.UIComponent","egret.DisplayObject"]);var RoomItem=function(t){function e(e){var s=t.call(this)||this;return s._parent=null,s.isme=!1,s._parent=e,s.skinName="RoomItemSkin",s}return __extends(e,t),e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s)},e.prototype.showInfo=function(t,e,s,i,n){this.lab_roomID.text="房间号："+t;var o=1==e?"待加入":"已关闭";this.lab_state.text="房间状态："+o;var r=n===GameData.roomPropertyType.mapA?"彩图":"灰图";this.lab_map.text="地图："+r,this.lab_roomNum.text="房间人数："+s+"/"+i,mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this._parent=this.data._parent,this.layContents(this.data._roomID,this.data._state,this.data._num,this.data._max,this.data._map),this.showInfo(this._roomID,this._state,this._num,this._max,this._map)},e.prototype.layContents=function(t,e,s,i,n){this._roomID=t,this._state=e,this._num=s,this._max=i,this._map=n},e.prototype.getRoomDetail=function(t){mvs.MsEngine.getInstance.getRoomDetail(t)},e.prototype.getRoomDetailResponse=function(t){var e=t.data;return 200!==e.status?void console.log("getRoomDetailResponse error status:"+e.status):void(1===e.state?(console.log("检查房间状态为：开放状态可以进入"),this.Release(),this.isme):console.log("检查房间状态为：关闭状态不可以进入，请刷新房间列表"))},e.prototype.mbuttonEnterRoom=function(t){console.log("点击按钮加入房间号：",this._roomID),this.isme=!0,this.getRoomDetail(this._roomID)},e.prototype.removeEventListe=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this),this.btn_enter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)},e.prototype.Release=function(){this._parent.Release(),this.removeEventListe()},e}(eui.ItemRenderer);__reflect(RoomItem.prototype,"RoomItem");var RoomListUI=function(t){function e(){var e=t.call(this)||this;return e.roomItemA=new eui.ArrayCollection([]),e._roomListSprite=null,e}return __extends(e,t),e.prototype.getChild=function(t,e){"lab_userID"==t?(this.lab_userID=e,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name):"img_header"==t?(this.img_header=e,this.img_header.source=GameData.gameUser.avatar):"btn_return"==t?(this.btn_return=e,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"data_roomList"==t?this.data_roomList=e:"lab_getInfo"==t&&(this.lab_getInfo=e)},e.prototype.partAdded=function(e,s){t.prototype.partAdded.call(this,e,s),this.getChild(e,s)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._roomListSprite=new egret.Sprite,this.addChild(this._roomListSprite),this.getRoomListEx(),this._timer=new egret.Timer(2e3,0),this._timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMLIST_EX_RSP,this.getRoomListExResponse,this),this._timer.start()},e.prototype.mbuttonExitRoom=function(t){this._timer.stop(),GameSceneView._gameScene.lobby()},e.prototype.timerFunc=function(t){this.getRoomListEx()},e.prototype.getRoomListEx=function(){var t=new MsRoomFilterEx(GameData.createRoomInfo.maxPlayer,GameData.createRoomInfo.mode,GameData.createRoomInfo.canWatch,"",0,1,1,0,0,3);mvs.MsEngine.getInstance.getRoomListEx(t)},e.prototype.getRoomListExResponse=function(t){var e=t.data;if(200!=e.status)return void(this.lab_getInfo.text="获取失败!");if(0==e.roomAttrs.length)return this.lab_getInfo.text="当前没有房间",void(this.data_roomList.dataProvider=new eui.ArrayCollection([]));this.lab_getInfo.text="",this.roomItemA.removeAll();for(var s=0;s<e.roomAttrs.length;s++){console.log("房间数据量：",e.roomAttrs.length);var i={_parent:this,_roomID:e.roomAttrs[s].roomID,_num:e.roomAttrs[s].gamePlayer,_state:e.roomAttrs[s].state,_map:e.roomAttrs[s].roomProperty,_max:e.roomAttrs[s].maxPlayer};this.roomItemA.addItem(i)}this.data_roomList.dataProvider=this.roomItemA,this.data_roomList.itemRenderer=RoomItem},e.prototype.Release=function(){this._timer.stop(),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMLIST_EX_RSP,this.getRoomListExResponse,this)},e}(eui.Component);__reflect(RoomListUI.prototype,"RoomListUI",["eui.UIComponent","egret.DisplayObject"]);var Loading=function(t){function e(e,s){var i=t.call(this)||this;return i.logoUrl="resource/assets/loading_logo.png",i.isShow=!1,i.createView(e,s),i}return __extends(e,t),e.prototype.createView=function(t,e){this.w=t,this.h=e,this.textField=new egret.TextField,this.textField.y=this.h/2,this.textField.textColor=13421772,this.textField.size=46,this.textField.width=this.w,this.textField.height=100,this.textField.fontFamily="Black",this.textField.textAlign="center",this.textField.text="登录中…",this.textField_power=new egret.TextField,this.textField_power.text=".",this.textField_power.textColor=13421772,this.textField_power.size=80,this.textField_power.fontFamily="White",this.textField_power.textAlign="center",this.textField_power.x=.5*this.w,this.textField_power.y=.8*this.h,egret.Tween.get(this.textField_power,{loop:!0}).to({rotation:360},800,egret.Ease.cubicIn).play();var s=new egret.Shape;s.width=this.w,s.height=this.h,s.x=(this.w-s.width)/2,s.y=(this.h-s.height)/2,s.graphics.beginFill(3355443,.8),s.graphics.drawRect(0,0,this.w,this.h),s.graphics.endFill(),this.addChild(s),this.addChild(this.textField),this.addChild(this.textField_power),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("touch loading")},this)},e.prototype.setProgress=function(t,e){var s=Math.floor(t/e*100);this.textField.text="加载中…"+s+"%"},e.create=function(t){var s=new e(t.width,t.height);return s.context=t,s},e.prototype.show=function(){return this.isShow?void console.log("[INFO]  loading hande be show"):(this.isShow=!0,void this.context.addChild(this))},e.prototype.close=function(){return this.isShow?(this.isShow=!1,void this.context.removeChild(this)):void console.log("[INFO] loading is not  showoing")},e.prototype.reconnect=function(){var t=new eui.Button;t.x=this.stage.stageWidth/2,t.y=this.stage.stageHeight/3*2,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSceneView._gameScene.login()},this)},e}(egret.Sprite);__reflect(Loading.prototype,"Loading");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.mute=function(){this._currSoundChannel&&(this._currSoundChannel.volume=0)},e.prototype.restoreVolume=function(){this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t,e){if(void 0===e&&(e=0),this._currBg!=t){this.stop(),this._currBg=t,this._currPlayTime=e;var s=this.getSound(t);s&&this.playSound(s)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(this._currPlayTime,0),this._currSoundChannel.volume=this._volume},e.prototype.getPlayTime=function(){return this._currSoundChannel?this._currSoundChannel.position:0},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e._cacheSoundChannel=[],e._playingEffects={},e}return __extends(e,t),e.prototype.play=function(t,e,s){if(void 0===e&&(e=!1),void 0===s&&(s=1),this._playTime=s,e||!this._playingEffects[t]){var i=this.getSound(t);i&&this.playSound(t,i)}},e.prototype.getSoundChannel=function(t){var e=null;return this._cacheSoundChannel.length?(e=this._cacheSoundChannel.pop(),e.isStopped=!1,e.$url=t.url,e.$loops=this._playTime,e.$audioBuffer=t.audioBuffer,e.$startTime=0,e.$play()):e=t.play(0,this._playTime),e},e.prototype.playSound=function(t,e){var s=this.getSoundChannel(e);s.once(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),s.volume=this._volume,s.soundName=t,this._playingEffects[t]=s},e.prototype.onSoundComplete=function(t){var e=t.currentTarget,s=e.soundName;delete this._playingEffects[s]},e.prototype.stopSound=function(t){var e=this._playingEffects[t];e&&(e.stop(),delete this._playingEffects[t])},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(t,RES.getRes(t))},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.7,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.prototype.playEffect=function(t,e,s){void 0===e&&(e=!1),void 0===s&&(s=1),this.effectOn&&this.effect.play(t,e,s)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.pauseBg=function(){this.bgOn&&(this.bgPlayTime=this.bg.getPlayTime(),this.bg.stop())},e.prototype.replayBg=function(){this.bgOn&&this.bg.play(this.currBg,this.bgPlayTime)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.muteBg=function(){this.bg.mute()},e.prototype.restoreVolumeBg=function(){this.bg.restoreVolume()},e.prototype.stopEffect=function(t){this.effect.stopSound(t)},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn!=t&&(this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg())},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},Object.defineProperty(e.prototype,"bgIsOn",{get:function(){return this.bgOn},enumerable:!0,configurable:!0}),e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.loadBG=AssetManager.getBitmap("loadBG_jpg",!1,!1),(App.GameHeight>this.loadBG.height||App.GameHeight<this.loadBG.height)&&(this.loadBG.height=App.GameHeight,this.loadBG.anchorOffsetY=this.loadBG.height/2,this.loadBG.y=App.GameHeight/2),this.addChild(this.loadBG),this.numText=new egret.BitmapText;var t=RES.getRes("num_fnt");this.numText.font=t,this.numText.text="0%",this.numText.x=this.loadBG.width/2-this.numText.width/2,this.numText.y=this.loadBG.height/2+200,this.addChild(this.numText),this.loadDb=this.createLoadingDB(),this.loadDb.x=this.loadBG.width/2,this.loadDb.y=this.loadBG.height/2,this.addChild(this.loadDb)},e.prototype.createLoadingDB=function(){var t,e=RES.getRes("loading_ske_json"),s=RES.getRes("loading_tex_json"),i=RES.getRes("loading_tex_png");return e&&s&&i&&(AssetManager.loadDBAnimation(["loading"]),t=AssetManager.getDBArmature("loading"),t.scaleX=t.scaleY=2,t.play("newAnimation",0)),t},e.prototype.onProgress=function(t,e){this.numText.text=Math.ceil(t/e*100).toString()+"%","100%"==this.numText.text&&this.loadDb.dispose()},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var StateEvent=function(t){function e(e,s,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var r=t.call(this,e,n,o)||this;return r.data=s,r.paramData=i,r}return __extends(e,t),e.NEXT="NEXT",e.LAST="LAST",e.POPUP="POPUP",e.POPUPCLOSE="POPUPCLOSE",e
}(egret.Event);__reflect(StateEvent.prototype,"StateEvent");var AssetManager=function(){function t(){}return t.clearCacheList=function(t){for(var e=this.cacheDbs[t]||[];e.length;){var s=e[0];s.dispose()}delete this.cacheDbs[t]},t.removeCacheArmature=function(t){var e=t.armatureName,s=this.cacheDbs[e];if(s){var i=s.indexOf(t);-1!=i&&s.splice(i,1)}this.printCacheListCount()},t.addCacheArmature=function(t){var e=t.armatureName;this.cacheDbs[e]||(this.cacheDbs[e]=[]),this.cacheDbs[e].push(t),this.printCacheListCount()},t.printCacheListCount=function(){return},t.getBitmap=function(t,e,s){void 0===e&&(e=!0),void 0===s&&(s=!0);var i=new egret.Bitmap,n=RES.getRes(t);return i.texture=n,e&&(i.anchorOffsetX=i.width>>1),s&&(i.anchorOffsetY=i.height>>1),i},t.getSound=function(t){return RES.getRes(t)},t.loadDBAnimation=function(e){var s,i,n;for(s=0,i=e.length;i>s;s++){n=e[s];var o=RES.getRes(n+"_ske_json"),r=RES.getRes(n+"_tex_json"),a=RES.getRes(n+"_tex_png");o&&r&&a&&(t.dbFactory.parseDragonBonesData(o),t.dbFactory.parseTextureAtlasData(r,a))}},t.removeDBAnimation=function(e){var s,i,n;for(s=0,i=e.length;i>s;s++){n=e[s];var o=RES.getRes(n+"_ske_json");if(o){var r=o.name,a=t.dbFactory.getDragonBonesData(r);t.dbFactory.removeDragonBonesData(r),t.dbFactory.removeTextureAtlasData(r);for(var h in a.armatures)this.clearCacheList(h)}}},t.getDBArmature=function(e){var s=t.dbFactory.buildArmature(e);if(!s)return console.log("++++++++++++null"),null;var i=new DBArmature(s);return this.addCacheArmature(i),i},t.getQuickDBArmature=function(e){var s=t.dbFactory.buildArmature(e);if(!s)return null;s.cacheFrameRate=30;var i=new DBArmature(s);return this.addCacheArmature(i),i},t.changeTexture=function(t,e){var s=t.width,i=t.height;t.texture=RES.getRes(e),t.width=s,t.height=i},t.setText=function(t,e){t.text=e,t.anchorOffsetX=t.width>>1,t.anchorOffsetY=t.height>>1},t.dbFactory=new dragonBones.EgretFactory,t.cacheDbs={},t}();__reflect(AssetManager.prototype,"AssetManager");var Base64BitmapDataPool=function(){function t(){}return t.getData=function(t,e){var s=this,i=this.pools[t];if(i)i.useNum+=1,e(i.data);else{if(this.waitLoading[t])return void this.waitLoading[t].push(e);this.waitLoading[t]=[],this.waitLoading[t].push(e),ProxyHttp.wxImgToBase64(t,function(e){var i=e.r.data.split(",");egret.BitmapData.create("base64",i[1],function(e){var i=new egret.Texture;i._setBitmapData(e);var n={data:i,useNum:0};s.pools[t]=n;var o=s.waitLoading[t];o.forEach(function(t){n.useNum+=1,t(n.data)}),s.waitLoading[t]=null,delete s.waitLoading[t]})})}},t.reduceUseNum=function(t){var e=this.pools[t];e&&(e.useNum-=1)},t.pools={},t.waitLoading={},t}();__reflect(Base64BitmapDataPool.prototype,"Base64BitmapDataPool");var DataCenter=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SendExpressTime=0,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.initConfig=function(t){this.gameConfigs=t.games},e.prototype.getGameConfig=function(t){var e,s;for(e=0,s=this.gameConfigs.length;s>e;e++)if(this.gameConfigs[e].gameId==t)return this.gameConfigs[e];return null},e}(egret.EventDispatcher);__reflect(DataCenter.prototype,"DataCenter");var DisplayUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createBitmap=function(t){var e=new egret.Bitmap,s=RES.getRes(t);return e.texture=s,e},e.prototype.createEuiImage=function(t){var e=new eui.Image,s=RES.getRes(t);return e.source=s,e},e.prototype.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e.prototype.quickAddChild=function(t,e){return"true"===egret.getOption("egretnative")?void t.addChild(e):void(e.$parent!=t&&(t.$children.push(e),e.$parent=t,e instanceof DBArmature&&e.$addToClock()))},e.prototype.quickRemoveChild=function(t){if("true"===egret.getOption("egretnative"))return void this.removeFromParent(t);var e=t.$parent;if(e){var s=e.$children.indexOf(t);e.$children.splice(s,1),t.$parent=null,t instanceof DBArmature&&t.$removeFromClock()}},e}(BaseClass);__reflect(DisplayUtils.prototype,"DisplayUtils");var GameReady=function(t){function e(e,s,i){void 0===s&&(s="ready_png"),void 0===i&&(i="go_png");var n=t.call(this)||this;return n._callback=e,n.imgReady=AssetManager.getBitmap(s),n.imgGo=AssetManager.getBitmap(i),n.addChild(n.imgReady),n.addChild(n.imgGo),n}return __extends(e,t),e.prototype.hide=function(){this.imgReady.alpha=0,this.imgGo.alpha=0},e.prototype.play=function(){var t=this;this.hide(),App.SoundManager.playEffect("readyGo_mp3"),this.imgReady.alpha=1,this.stepReady=setTimeout(function(){t.hide(),t.imgGo.alpha=1,t.stepGo=setTimeout(function(){t.hide(),t._callback(),clearTimeout(t.stepGo),t.stepGo=void 0},1e3),clearTimeout(t.stepReady),t.stepReady=void 0},1e3)},e.prototype.dispose=function(){this.stepReady&&(clearTimeout(this.stepReady),this.stepReady=void 0),this.stepGo&&(clearTimeout(this.stepGo),this.stepGo=void 0),this._callback=void 0,this.imgGo=void 0,this.imgReady=void 0},e}(egret.DisplayObjectContainer);__reflect(GameReady.prototype,"GameReady");var MD5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,s){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),s)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var s=this.rstr2binl(t);s.length>16&&(s=this.binl_md5(s,8*t.length));for(var i=Array(16),n=Array(16),o=0;16>o;o++)i[o]=909522486^s[o],n[o]=1549556828^s[o];var r=this.binl_md5(i.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(n.concat(r),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var s,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",o=0;o<t.length;o++)s=t.charCodeAt(o),n+=i.charAt(s>>>4&15)+i.charAt(15&s);return n},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",n=t.length,o=0;n>o;o+=3)for(var r=t.charCodeAt(o)<<16|(n>o+1?t.charCodeAt(o+1)<<8:0)|(n>o+2?t.charCodeAt(o+2):0),a=0;4>a;a++)i+=8*o+6*a>8*t.length?this.b64pad:s.charAt(r>>>6*(3-a)&63);return i},t.prototype.rstr2any=function(t,e){var s,i,n,o,r,a=e.length,h=Array(Math.ceil(t.length/2));for(s=0;s<h.length;s++)h[s]=t.charCodeAt(2*s)<<8|t.charCodeAt(2*s+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),p=Array(c);for(i=0;c>i;i++){for(r=Array(),o=0,s=0;s<h.length;s++)o=(o<<16)+h[s],n=Math.floor(o/a),o-=n*a,(r.length>0||n>0)&&(r[r.length]=n);p[i]=o,h=r}var l="";for(s=p.length-1;s>=0;s--)l+=e.charAt(p[s]);return l},t.prototype.str2rstr_utf8=function(t){for(var e,s,i="",n=-1;++n<t.length;)e=t.charCodeAt(n),s=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&s>=56320&&57343>=s&&(e=65536+((1023&e)<<10)+(1023&s),n++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i},t.prototype.str2rstr_utf16le=function(t){for(var e="",s=0;s<t.length;s++)e+=String.fromCharCode(255&t.charCodeAt(s),t.charCodeAt(s)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",s=0;s<t.length;s++)e+=String.fromCharCode(t.charCodeAt(s)>>>8&255,255&t.charCodeAt(s));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),s=0;s<e.length;s++)e[s]=0;for(var s=0;s<8*t.length;s+=8)e[s>>5]|=(255&t.charCodeAt(s/8))<<s%32;return e},t.prototype.binl2rstr=function(t){for(var e="",s=0;s<32*t.length;s+=8)e+=String.fromCharCode(t[s>>5]>>>s%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var s=1732584193,i=-271733879,n=-1732584194,o=271733878,r=0;r<t.length;r+=16){var a=s,h=i,c=n,p=o;s=this.md5_ff(s,i,n,o,t[r+0],7,-680876936),o=this.md5_ff(o,s,i,n,t[r+1],12,-389564586),n=this.md5_ff(n,o,s,i,t[r+2],17,606105819),i=this.md5_ff(i,n,o,s,t[r+3],22,-1044525330),s=this.md5_ff(s,i,n,o,t[r+4],7,-176418897),o=this.md5_ff(o,s,i,n,t[r+5],12,1200080426),n=this.md5_ff(n,o,s,i,t[r+6],17,-1473231341),i=this.md5_ff(i,n,o,s,t[r+7],22,-45705983),s=this.md5_ff(s,i,n,o,t[r+8],7,1770035416),o=this.md5_ff(o,s,i,n,t[r+9],12,-1958414417),n=this.md5_ff(n,o,s,i,t[r+10],17,-42063),i=this.md5_ff(i,n,o,s,t[r+11],22,-1990404162),s=this.md5_ff(s,i,n,o,t[r+12],7,1804603682),o=this.md5_ff(o,s,i,n,t[r+13],12,-40341101),n=this.md5_ff(n,o,s,i,t[r+14],17,-1502002290),i=this.md5_ff(i,n,o,s,t[r+15],22,1236535329),s=this.md5_gg(s,i,n,o,t[r+1],5,-165796510),o=this.md5_gg(o,s,i,n,t[r+6],9,-1069501632),n=this.md5_gg(n,o,s,i,t[r+11],14,643717713),i=this.md5_gg(i,n,o,s,t[r+0],20,-373897302),s=this.md5_gg(s,i,n,o,t[r+5],5,-701558691),o=this.md5_gg(o,s,i,n,t[r+10],9,38016083),n=this.md5_gg(n,o,s,i,t[r+15],14,-660478335),i=this.md5_gg(i,n,o,s,t[r+4],20,-405537848),s=this.md5_gg(s,i,n,o,t[r+9],5,568446438),o=this.md5_gg(o,s,i,n,t[r+14],9,-1019803690),n=this.md5_gg(n,o,s,i,t[r+3],14,-187363961),i=this.md5_gg(i,n,o,s,t[r+8],20,1163531501),s=this.md5_gg(s,i,n,o,t[r+13],5,-1444681467),o=this.md5_gg(o,s,i,n,t[r+2],9,-51403784),n=this.md5_gg(n,o,s,i,t[r+7],14,1735328473),i=this.md5_gg(i,n,o,s,t[r+12],20,-1926607734),s=this.md5_hh(s,i,n,o,t[r+5],4,-378558),o=this.md5_hh(o,s,i,n,t[r+8],11,-2022574463),n=this.md5_hh(n,o,s,i,t[r+11],16,1839030562),i=this.md5_hh(i,n,o,s,t[r+14],23,-35309556),s=this.md5_hh(s,i,n,o,t[r+1],4,-1530992060),o=this.md5_hh(o,s,i,n,t[r+4],11,1272893353),n=this.md5_hh(n,o,s,i,t[r+7],16,-155497632),i=this.md5_hh(i,n,o,s,t[r+10],23,-1094730640),s=this.md5_hh(s,i,n,o,t[r+13],4,681279174),o=this.md5_hh(o,s,i,n,t[r+0],11,-358537222),n=this.md5_hh(n,o,s,i,t[r+3],16,-722521979),i=this.md5_hh(i,n,o,s,t[r+6],23,76029189),s=this.md5_hh(s,i,n,o,t[r+9],4,-640364487),o=this.md5_hh(o,s,i,n,t[r+12],11,-421815835),n=this.md5_hh(n,o,s,i,t[r+15],16,530742520),i=this.md5_hh(i,n,o,s,t[r+2],23,-995338651),s=this.md5_ii(s,i,n,o,t[r+0],6,-198630844),o=this.md5_ii(o,s,i,n,t[r+7],10,1126891415),n=this.md5_ii(n,o,s,i,t[r+14],15,-1416354905),i=this.md5_ii(i,n,o,s,t[r+5],21,-57434055),s=this.md5_ii(s,i,n,o,t[r+12],6,1700485571),o=this.md5_ii(o,s,i,n,t[r+3],10,-1894986606),n=this.md5_ii(n,o,s,i,t[r+10],15,-1051523),i=this.md5_ii(i,n,o,s,t[r+1],21,-2054922799),s=this.md5_ii(s,i,n,o,t[r+8],6,1873313359),o=this.md5_ii(o,s,i,n,t[r+15],10,-30611744),n=this.md5_ii(n,o,s,i,t[r+6],15,-1560198380),i=this.md5_ii(i,n,o,s,t[r+13],21,1309151649),s=this.md5_ii(s,i,n,o,t[r+4],6,-145523070),o=this.md5_ii(o,s,i,n,t[r+11],10,-1120210379),n=this.md5_ii(n,o,s,i,t[r+2],15,718787259),i=this.md5_ii(i,n,o,s,t[r+9],21,-343485551),s=this.safe_add(s,a),i=this.safe_add(i,h),n=this.safe_add(n,c),o=this.safe_add(o,p)}return[s,i,n,o]},t.prototype.md5_cmn=function(t,e,s,i,n,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(i,o)),n),s)},t.prototype.md5_ff=function(t,e,s,i,n,o,r){return this.md5_cmn(e&s|~e&i,t,e,n,o,r)},t.prototype.md5_gg=function(t,e,s,i,n,o,r){return this.md5_cmn(e&i|s&~i,t,e,n,o,r)},t.prototype.md5_hh=function(t,e,s,i,n,o,r){return this.md5_cmn(e^s^i,t,e,n,o,r)},t.prototype.md5_ii=function(t,e,s,i,n,o,r){return this.md5_cmn(s^(e|~i),t,e,n,o,r)},t.prototype.safe_add=function(t,e){var s=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(s>>16);return i<<16|65535&s},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(MD5.prototype,"MD5");var MessageCenter=function(){function t(t){this.dict=null,this.type=0,this.type=t,this.dict={},this.eVec=new Array,this.lastRunTime=0,0==this.type&&egret.startTick(this.run,this)}return t.getInstance=function(){return t._instance?t._instance:t._instance=new t(1)},t.prototype.addListener=function(t,e,s){var i=this.dict[t];null==i&&(i=new Array,this.dict[t]=i);var n=0,o=i.length;for(n;o>n;n++)if(i[n][0]==e&&i[n][1]==s)return;i.push([e,s])},t.prototype.removeListener=function(t,e,s){var i=this.dict[t];if(null!=i){var n=0,o=i.length;for(n;o>n;n++)if(i[n][0]==e&&i[n][1]==s){i.splice(n,1);break}0==i.length&&(this.dict[t]=null,delete this.dict[t])}},t.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),s=0,i=e.length;i>s;s++){for(var n=e[s],o=this.dict[n],r=0;r<o.length;r++)o[r][1]==t&&(o.splice(r,1),r--);0==o.length&&(this.dict[n]=null,delete this.dict[n])}},t.prototype.dispatch=function(t){for(var e=[],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(console.log(this.dict[t]),null==this.dict[t])return void console.log("++++++++++++++++++message type null+++++++++++++++");var i=new MessageVo;i.type=t,i.param=e,0==this.type?(this.eVec.push(i),console.log("++++++ type = 0 +++++++")):1==this.type?(this.dealMsg(i),console.log("++++++ type = 1 +++++++")):(console.log("++++++ type = else +++++++"),console.log("MessageCenter未实现的类型"))},t.prototype.run=function(t){var e=egret.getTimer(),s=e-this.lastRunTime>100;if(this.lastRunTime=e,s)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-e>5)););return!0},t.prototype.dealMsg=function(t){for(var e=this.dict[t.type],s=0,i=e.length,n=null;i>s;)n=e[s],n[0].apply(n[1],t.param),e.length!=i&&(i=e.length,s--),s++;t.dispose(),t=null},t._instance=null,t}();__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){this.type=null,this.param=null}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e,s){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t._content[s]||(t._content[s]=[]);var o=t._content[s];if(o.length)return o.pop();var r,a=i.length;return 0==a?r=new e:1==a?r=new e(i[0]):2==a?r=new e(i[0],i[1]):3==a?r=new e(i[0],i[1],i[2]):4==a?r=new e(i[0],i[1],i[2],i[3]):5==a&&(r=new e(i[0],i[1],i[2],i[3],i[4])),r.ObjectPoolKey=s,r},t.popWithExtraKey=function(e,s){t._content[e]||(t._content[e]=[]);var i,n=t._content[e];if(n.length)for(var o=0;o<n.length;o++)if(n[o].extraKey==s){i=n[o],n.splice(o,1);break}if(!i){var r=e;i=new r(s),i.extraKey=s,i.ObjectPoolKey=e}return i},t.push=function(e){if(null==e)return!1;var s=e.ObjectPoolKey;return t._content[s]?(t._content[s].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,s){void 0===s&&(s=null);for(var i=t._content[e];i&&i.length;){var n=i.pop();s&&n[s](),n=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,s){var i=t._content[e];if(null!=i){var n=0,o=i.length;for(n;o>n;n++)i[n][s]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var ProxyHttp=function(){function t(){}return t.wxImgToBase64=function(t,e){},t}();__reflect(ProxyHttp.prototype,"ProxyHttp");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,s,i,n){void 0===n&&(n=null),this._groups[t]=[e,s,i,n],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,s,i,n,o){void 0===o&&(o=null),RES.createGroup(t,e,!0),this.loadGroup(t,s,i,n,o)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var s="pilferer_"+t;e||(e=[t]),RES.createGroup(s,e,!0),RES.loadGroup(s,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var s=this._groups[e][0],i=this._groups[e][2];null!=s&&s.apply(i,[e]),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var s=this._groups[e][1],i=this._groups[e][2];null!=s&&s.call(i,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){var e=t.groupName;if(this._groups[e]){var s=this._groups[e][2],i=this._groups[e][3];null!=i&&i.apply(s,[e])}},e.prototype.createGroup=function(t,e){RES.createGroup(t,e,!0)},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var RoomVO=function(){function t(t,e,s,i){this.id=t,this.gameId=e,this.player=s,this._isAi=i}return Object.defineProperty(t.prototype,"IsAI",{get:function(){return this._isAi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selfIsMaster",{get:function(){if(this._isAi)return!0;var t=App.CurrChatId.split("_");return t[0]==DataCenter.instance.user.id.toString()},enumerable:!0,configurable:!0}),t}();__reflect(RoomVO.prototype,"RoomVO");var StageUtils=function(t){function e(){var s=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,s.getStage().addChild(e._uiStage)),s}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.startFullscreenAdaptation=function(t,e,s){this.designWidth=t,this.designHeight=e,this.resizeCallback=s,this.stageOnResize()},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight,s=window.innerWidth,i=window.innerHeight,n=s/i,o=t/e,r=n/o;if(n>o){var a=r,h=r;t=Math.floor(t*a),e=Math.floor(e*h)}this.getStage().setContentSize(t,e),this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var TimerManager=function(t){function e(){var e=t.call(this)||this;return e._handlers=new Array,e._delHandlers=new Array,e._currTime=egret.getTimer(),e._currFrame=0,e._count=0,e._timeScale=1,egret.Ticker.getInstance().register(e.onEnterFrame,e),e}return __extends(e,t),e.prototype.setTimeScale=function(t){this._timeScale=t},e.prototype.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer();for(var t=0;t<this._count;t++){var e=this._handlers[t],s=e.userFrame?this._currFrame:this._currTime;s>=e.exeTime&&(e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}},e.prototype.create=function(t,e,s,i,n,o,r){if(!(0>e||0>s||null==i)){this.remove(i,n);var a=ObjectPool.pop(TimerHandler,"TimerHandler");a.userFrame=t,a.repeat=0==s,a.repeatCount=s,a.delay=e,a.method=i,a.methodObj=n,a.complateMethod=o,a.complateMethodObj=r,a.exeTime=e+(t?this._currFrame:this._currTime),a.dealTime=this._currTime,this._handlers.push(a),this._count++}},e.prototype.doTimer=function(t,e,s,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.create(!1,t,e,s,i,n,o)},e.prototype.doFrame=function(t,e,s,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.create(!0,t,e,s,i,n,o)},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.remove=function(t,e){for(var s=0;s<this._count;s++){var i=this._handlers[s];if(i.method==t&&i.methodObj==e){this._handlers.splice(s,1),ObjectPool.push(i),this._count--;break}}},e.prototype.removeAll=function(t){for(var e=0;e<this._count;e++){var s=this._handlers[e];s.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(s),this._count--,e--)}},e.prototype.isExists=function(t,e){for(var s=0;s<this._count;s++){var i=this._handlers[s];if(i.method==t&&i.methodObj==e)return!0}return!1},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var Toast=function(t){function e(s,i,n){var o=t.call(this)||this;console.log("Toast:",s);var r=new egret.Bitmap(e._txtrToastBg);o.x=.5*i,o.y=.85*n,o.addChild(r),r.$anchorOffsetX=r.width/2;var a=new egret.TextField;return a.multiline=!0,a.size=30,a.bold=!0,a.textColor=16777215,a.stroke=6,a.strokeColor=0,a.text=s,a.fontFamily="微软雅黑",a.textAlign=egret.HorizontalAlign.CENTER,a.width=1*i,a.x=r.x,a.y=r.y+a.size/10,a.anchorOffsetX=a.width/2,o.addChild(a),r.height=12+a.height,o.alpha=0,egret.Tween.get(o).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){o.parent&&o.parent.removeChild(o)}),o}return __extends(e,t),e.init=function(t,e){console.log("Toast.init",e),this._cont=t,this._txtrToastBg=e},e.initRes=function(t,e){console.log("Toast.init",e),this._cont=t;var s=new egret.ImageLoader;s.addEventListener(egret.Event.COMPLETE,function(t){var e=t.target,s=e.data,i=new egret.Texture;i.bitmapData=s,this._txtrToastBg=i},this),s.load(e)},e.show=function(t){if(this._cont){var s=new e(t,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(s)}},e}(egret.DisplayObjectContainer);__reflect(Toast.prototype,"Toast");var User=function(t){function e(e){var s=t.call(this)||this;return s.name="",s.sex=0,s.imgUrl="",s.country="",s.province="",s.city="",s.money=0,s.exp=0,s.guide=0,s.constellatory=0,s.barrage_num=0,s.status=0,s.roomId=-1,s.gameId=-1,s.id=e,s}return __extends(e,t),e.EVENT_LOAD_COMPLETE="EVENT_LOAD_COMPLETE",e.STATUS_IDLE=0,e.STATUS_ROOM=1,e.STATUS_MATCHING=2,e.STATUS_GAME_LOADING=3,e.STATUS_GAMING=4,e.STATUS_GAME_RESULT=5,e}(egret.EventDispatcher);__reflect(User.prototype,"User");